%!PS-Adobe-2.0
%%Creator: dvipsk 5.58f Copyright 1986, 1994 Radical Eye Software
%%Title: lis.dvi
%%Pages: 8
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%DocumentFonts: Times-Roman Times-Bold Symbol Courier Times-Italic
%%DocumentPaperSizes: Letter
%%EndComments
%DVIPSCommandLine: dvips lis.dvi -o lis.ps
%DVIPSParameters: dpi=600, comments removed
%DVIPSSource:  TeX output 1998.06.22:1741
%%BeginProcSet: tex.pro
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N
/X{S N}B /TR{translate}N /isls false N /vsize 11 72 mul N /hsize 8.5 72
mul N /landplus90{false}def /@rigin{isls{[0 landplus90{1 -1}{-1 1}
ifelse 0 0 0]concat}if 72 Resolution div 72 VResolution div neg scale
isls{landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div
hsize mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul
TR[matrix currentmatrix{dup dup round sub abs 0.00001 lt{round}if}
forall round exch round exch]setmatrix}N /@landscape{/isls true N}B
/@manualfeed{statusdict /manualfeed true put}B /@copies{/#copies X}B
/FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N /IE 0 N /ctr 0 N /df-tail{
/nn 8 dict N nn begin /FontType 3 N /FontMatrix fntrx N /FontBBox FBB N
string /base X array /BitMaps X /BuildChar{CharBuilder}N /Encoding IE N
end dup{/foo setfont}2 array copy cvx N load 0 nn put /ctr 0 N[}B /df{
/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0 0 sf neg 0 0]
N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data dup
length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{
128 ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub
get 127 sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data
dup type /stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N
/rc 0 N /gp 0 N /cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup
/base get 2 index get S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx
0 ch-xoff ch-yoff ch-height sub ch-xoff ch-width add ch-yoff
setcachedevice ch-width ch-height true[1 0 0 -1 -.1 ch-xoff sub ch-yoff
.1 sub]{ch-image}imagemask restore}B /D{/cc X dup type /stringtype ne{]}
if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1 ne{dup dup
length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}B /I{
cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul
add .99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI restore userdict
/eop-hook known{eop-hook}if showpage}N /@start{userdict /start-hook
known{start-hook}if pop /VResolution X /Resolution X 1000 div /DVImag X
/IE 256 array N 0 1 255{IE S 1 string dup 0 3 index put cvn put}for
65781.76 div /vsize X 65781.76 div /hsize X}N /p{show}N /RMat[1 0 0 -1 0
0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley X /rulex X V}B /V
{}B /RV statusdict begin /product where{pop product dup length 7 ge{0 7
getinterval dup(Display)eq exch 0 4 getinterval(NeXT)eq or}{pop false}
ifelse}{false}ifelse end{{gsave TR -.1 .1 TR 1 1 scale rulex ruley false
RMat{BDot}imagemask grestore}}{{gsave TR -.1 .1 TR rulex ruley scale 1 1
false RMat{BDot}imagemask grestore}}ifelse B /QV{gsave newpath transform
round exch round exch itransform moveto rulex 0 rlineto 0 ruley neg
rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta 0 N /tail
{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}
B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{
4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{
p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p
a}B /bos{/SS save N}B /eos{SS restore}B end
%%EndProcSet
%%BeginFont: Times-Roman
% @@psencodingfile@{
%   author = "S. Rahtz, P. MacKay, Alan Jeffrey, B. Horn, K. Berry",
%   version = "0.6",
%   date = "22 June 1996",
%   filename = "8r.enc",
%   email = "kb@@mail.tug.org",
%   address = "135 Center Hill Rd. // Plymouth, MA 02360",
%   codetable = "ISO/ASCII",
%   checksum = "119     662    4424",
%   docstring = "Encoding for TrueType or Type 1 fonts to be used with TeX."
% @}
% 
% Idea is to have all the characters normally included in Type 1 fonts
% available for typesetting. This is effectively the characters in Adobe
% Standard Encoding + ISO Latin 1 + extra characters from Lucida.
% 
% Character code assignments were made as follows:
% 
% (1) the Windows ANSI characters are almost all in their Windows ANSI
% positions, because some Windows users cannot easily reencode the
% fonts, and it makes no difference on other systems. The only Windows
% ANSI characters not available are those that make no sense for
% typesetting -- rubout (127 decimal), nobreakspace (160), softhyphen
% (173). quotesingle and grave are moved just because it's such an
% irritation not having them in TeX positions.
% 
% (2) Remaining characters are assigned arbitrarily to the lower part
% of the range, avoiding 0, 10 and 13 in case we meet dumb software.
% 
% (3) Y&Y Lucida Bright includes some extra text characters; in the
% hopes that other PostScript fonts, perhaps created for public
% consumption, will include them, they are included starting at 0x12.
% 
% (4) Remaining positions left undefined are for use in (hopefully)
% upward-compatible revisions, if someday more characters are generally
% available.
% 
% (5) hyphen appears twice for compatibility with both ASCII and Windows.
% 
/TeXBase1Encoding [
% 0x00 (encoded characters from Adobe Standard not in Windows 3.1)
  /.notdef /dotaccent /fi /fl
  /fraction /hungarumlaut /Lslash /lslash
  /ogonek /ring /.notdef
  /breve /minus /.notdef 
% These are the only two remaining unencoded characters, so may as
% well include them.
  /Zcaron /zcaron 
% 0x10
 /caron /dotlessi 
% (unusual TeX characters available in, e.g., Lucida Bright)
 /dotlessj /ff /ffi /ffl 
 /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef
 % very contentious; it's so painful not having quoteleft and quoteright
 % at 96 and 145 that we move the things normally found there down to here.
 /grave /quotesingle 
% 0x20 (ASCII begins)
 /space /exclam /quotedbl /numbersign
 /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus /comma /hyphen /period /slash
% 0x30
 /zero /one /two /three /four /five /six /seven
 /eight /nine /colon /semicolon /less /equal /greater /question
% 0x40
 /at /A /B /C /D /E /F /G /H /I /J /K /L /M /N /O
% 0x50
 /P /Q /R /S /T /U /V /W
 /X /Y /Z /bracketleft /backslash /bracketright /asciicircum /underscore
% 0x60
 /quoteleft /a /b /c /d /e /f /g /h /i /j /k /l /m /n /o
% 0x70
 /p /q /r /s /t /u /v /w
 /x /y /z /braceleft /bar /braceright /asciitilde
 /.notdef % rubout; ASCII ends
% 0x80
 /.notdef /.notdef /quotesinglbase /florin
 /quotedblbase /ellipsis /dagger /daggerdbl
 /circumflex /perthousand /Scaron /guilsinglleft
 /OE /.notdef /.notdef /.notdef
% 0x90
 /.notdef /.notdef /.notdef /quotedblleft
 /quotedblright /bullet /endash /emdash
 /tilde /trademark /scaron /guilsinglright
 /oe /.notdef /.notdef /Ydieresis
% 0xA0
 /.notdef % nobreakspace
 /exclamdown /cent /sterling
 /currency /yen /brokenbar /section
 /dieresis /copyright /ordfeminine /guillemotleft
 /logicalnot
 /hyphen % Y&Y (also at 45); Windows' softhyphen
 /registered
 /macron
% 0xD0
 /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered
 /cedilla /onesuperior /ordmasculine /guillemotright
 /onequarter /onehalf /threequarters /questiondown
% 0xC0
 /Agrave /Aacute /Acircumflex /Atilde /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis
 /Igrave /Iacute /Icircumflex /Idieresis
% 0xD0
 /Eth /Ntilde /Ograve /Oacute
 /Ocircumflex /Otilde /Odieresis /multiply
 /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls
% 0xE0
 /agrave /aacute /acircumflex /atilde
 /adieresis /aring /ae /ccedilla
 /egrave /eacute /ecircumflex /edieresis
 /igrave /iacute /icircumflex /idieresis
% 0xF0
 /eth /ntilde /ograve /oacute
 /ocircumflex /otilde /odieresis /divide
 /oslash /ugrave /uacute /ucircumflex
 /udieresis /yacute /thorn /ydieresis
] def
%%EndFont
%%BeginProcSet: texps.pro
TeXDict begin /rf{findfont dup length 1 add dict begin{1 index /FID ne 2
index /UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]/Metrics
exch def dict begin Encoding{exch dup type /integertype ne{pop pop 1 sub
dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get div def}
ifelse}forall Metrics /Metrics currentdict end def[2 index currentdict
end definefont 3 -1 roll makefont /setfont load]cvx def}def
/ObliqueSlant{dup sin S cos div neg}B /SlantFont{4 index mul add}def
/ExtendFont{3 -1 roll mul exch}def /ReEncodeFont{/Encoding exch def}def
end
%%EndProcSet
%%BeginProcSet: special.pro
TeXDict begin /SDict 200 dict N SDict begin /@SpecialDefaults{/hs 612 N
/vs 792 N /ho 0 N /vo 0 N /hsc 1 N /vsc 1 N /ang 0 N /CLIP 0 N /rwiSeen
false N /rhiSeen false N /letter{}N /note{}N /a4{}N /legal{}N}B
/@scaleunit 100 N /@hscale{@scaleunit div /hsc X}B /@vscale{@scaleunit
div /vsc X}B /@hsize{/hs X /CLIP 1 N}B /@vsize{/vs X /CLIP 1 N}B /@clip{
/CLIP 2 N}B /@hoffset{/ho X}B /@voffset{/vo X}B /@angle{/ang X}B /@rwi{
10 div /rwi X /rwiSeen true N}B /@rhi{10 div /rhi X /rhiSeen true N}B
/@llx{/llx X}B /@lly{/lly X}B /@urx{/urx X}B /@ury{/ury X}B /magscale
true def end /@MacSetUp{userdict /md known{userdict /md get type
/dicttype eq{userdict begin md length 10 add md maxlength ge{/md md dup
length 20 add dict copy def}if end md begin /letter{}N /note{}N /legal{}
N /od{txpose 1 0 mtx defaultmatrix dtransform S atan/pa X newpath
clippath mark{transform{itransform moveto}}{transform{itransform lineto}
}{6 -2 roll transform 6 -2 roll transform 6 -2 roll transform{
itransform 6 2 roll itransform 6 2 roll itransform 6 2 roll curveto}}{{
closepath}}pathforall newpath counttomark array astore /gc xdf pop ct 39
0 put 10 fz 0 fs 2 F/|______Courier fnt invertflag{PaintBlack}if}N
/txpose{pxs pys scale ppr aload pop por{noflips{pop S neg S TR pop 1 -1
scale}if xflip yflip and{pop S neg S TR 180 rotate 1 -1 scale ppr 3 get
ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg TR}if xflip yflip
not and{pop S neg S TR pop 180 rotate ppr 3 get ppr 1 get neg sub neg 0
TR}if yflip xflip not and{ppr 1 get neg ppr 0 get neg TR}if}{noflips{TR
pop pop 270 rotate 1 -1 scale}if xflip yflip and{TR pop pop 90 rotate 1
-1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg
TR}if xflip yflip not and{TR pop pop 90 rotate ppr 3 get ppr 1 get neg
sub neg 0 TR}if yflip xflip not and{TR pop pop 270 rotate ppr 2 get ppr
0 get neg sub neg 0 S TR}if}ifelse scaleby96{ppr aload pop 4 -1 roll add
2 div 3 1 roll add 2 div 2 copy TR .96 dup scale neg S neg S TR}if}N /cp
{pop pop showpage pm restore}N end}if}if}N /normalscale{Resolution 72
div VResolution 72 div neg scale magscale{DVImag dup scale}if 0 setgray}
N /psfts{S 65781.76 div N}N /startTexFig{/psf$SavedState save N userdict
maxlength dict begin /magscale true def normalscale currentpoint TR
/psf$ury psfts /psf$urx psfts /psf$lly psfts /psf$llx psfts /psf$y psfts
/psf$x psfts currentpoint /psf$cy X /psf$cx X /psf$sx psf$x psf$urx
psf$llx sub div N /psf$sy psf$y psf$ury psf$lly sub div N psf$sx psf$sy
scale psf$cx psf$sx div psf$llx sub psf$cy psf$sy div psf$ury sub TR
/showpage{}N /erasepage{}N /copypage{}N /p 3 def @MacSetUp}N /doclip{
psf$llx psf$lly psf$urx psf$ury currentpoint 6 2 roll newpath 4 copy 4 2
roll moveto 6 -1 roll S lineto S lineto S lineto closepath clip newpath
moveto}N /endTexFig{end psf$SavedState restore}N /@beginspecial{SDict
begin /SpecialSave save N gsave normalscale currentpoint TR
@SpecialDefaults count /ocount X /dcount countdictstack N}N /@setspecial
{CLIP 1 eq{newpath 0 0 moveto hs 0 rlineto 0 vs rlineto hs neg 0 rlineto
closepath clip}if ho vo TR hsc vsc scale ang rotate rwiSeen{rwi urx llx
sub div rhiSeen{rhi ury lly sub div}{dup}ifelse scale llx neg lly neg TR
}{rhiSeen{rhi ury lly sub div dup scale llx neg lly neg TR}if}ifelse
CLIP 2 eq{newpath llx lly moveto urx lly lineto urx ury lineto llx ury
lineto closepath clip}if /showpage{}N /erasepage{}N /copypage{}N newpath
}N /@endspecial{count ocount sub{pop}repeat countdictstack dcount sub{
end}repeat grestore SpecialSave restore end}N /@defspecial{SDict begin}
N /@fedspecial{end}B /li{lineto}B /rl{rlineto}B /rc{rcurveto}B /np{
/SaveX currentpoint /SaveY X N 1 setlinecap newpath}N /st{stroke SaveX
SaveY moveto}N /fil{fill SaveX SaveY moveto}N /ellipse{/endangle X
/startangle X /yrad X /xrad X /savematrix matrix currentmatrix N TR xrad
yrad scale 0 0 1 startangle endangle arc savematrix setmatrix}N end
%%EndProcSet
TeXDict begin 40258431 52099146 1000 600 600 (lis.dvi)
@start /Fa 134[33 33 50 1[37 21 29 29 1[37 37 37 54 21
33 1[21 37 37 21 33 37 33 37 37 8[46 1[46 54 42 37 46
1[46 1[50 62 42 1[33 25 1[54 1[46 1[50 46 46 7[37 4[37
2[37 37 1[19 25 5[25 58 38[{ TeXBase1Encoding ReEncodeFont }47
75.000000 /Times-Italic rf /Fb 105[37 28[37 37 54 37
37 21 29 25 1[37 37 37 58 21 2[21 37 37 25 33 37 33 37
33 3[25 1[25 2[54 71 1[54 46 42 50 1[42 54 54 66 46 54
29 25 54 54 1[46 54 50 1[54 1[33 4[21 37 37 37 37 37
37 37 37 37 37 21 19 25 19 2[25 25 1[58 38[{
 TeXBase1Encoding ReEncodeFont }64 75.000000 /Times-Roman
rf /Fc 137[33 12[18 105[{ .167 SlantFont TeXBase1Encoding ReEncodeFont }
2 66.666667 /Times-Roman rf /Fd 134[50 1[72 50 55 33
39 44 1[55 50 55 1[28 2[28 55 50 33 44 55 44 55 50 12[66
55 72 4[94 66 6[66 72 1[66 72 19[33 41[55 3[{
 TeXBase1Encoding ReEncodeFont }31 100.000003 /Times-Bold
rf /Fe 197[34 12[34 3[34 41[{
 .85 ExtendFont TeXBase1Encoding ReEncodeFont }3 66.666667
/Courier rf /Ff 256[{}0 66.666667 /Symbol rf /Fg 107[29
29 25[33 33 48 33 33 18 26 22 1[33 33 33 52 18 2[18 33
1[22 29 33 29 33 29 10[48 2[37 6[41 3[48 1[37 1[48 21[17
22 17 41[37 2[{ TeXBase1Encoding ReEncodeFont }33 66.666667
/Times-Roman rf /Fh 204[25 25 25 49[{ TeXBase1Encoding ReEncodeFont }3
50.000001 /Times-Roman rf /Fi 204[31 31 31 49[{
 TeXBase1Encoding ReEncodeFont }3 61.666618 /Times-Roman
rf /Fj 2 37 df<000FE000007FFC0000FFFE0003FFFF8007FFFFC00FFFFFE01FFFFFF0
3FFFFFF83FFFFFF87FFFFFFC7FFFFFFC7FFFFFFCFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFE
FFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFE7FFFFFFC7FFFFFFC7FFFFFFC3FFFFFF83FFFFFF8
1FFFFFF00FFFFFE007FFFFC003FFFF8000FFFE00007FFC00000FE0001F207BA42A>15
D<0000780000001E00000000780000001E00000000780000001E00000000780000001E00
000000F80000001F00000000F00000000F00000000F00000000F00000001F00000000F80
000001E00000000780000003E000000007C0000007C000000003E0000007C000000003E0
00000F8000000001F000001F0000000000F800003F0000000000FC00007E00000000007E
0000FC00000000003F0001F800000000001F8003F000000000000FC00FE0000000000007
F03FFFFFFFFFFFFFFFFCFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF3FFFFFFFFFFFFFFF
FC0FE0000000000007F003F000000000000FC001F800000000001F8000FC00000000003F
00007E00000000007E00003F0000000000FC00001F0000000000F800000F8000000001F0
000007C000000003E0000007C000000003E0000003E000000007C0000001E00000000780
000001F00000000F80000000F00000000F00000000F00000000F00000000F80000001F00
000000780000001E00000000780000001E00000000780000001E00000000780000001E00
00482C7BAA53>36 D E /Fk 135[37 2[42 23 32 32 1[42 42
42 60 23 37 1[23 42 42 1[37 42 37 42 42 12[46 42 51 4[69
7[51 3[51 65[{ TeXBase1Encoding ReEncodeFont }25 83.333337
/Times-Italic rf /Fl 135[42 42 42 42 42 42 42 1[42 42
42 42 42 2[42 1[42 1[42 42 42 1[42 43[42 2[42 3[42 46[{
 .85 ExtendFont TeXBase1Encoding ReEncodeFont }21 83.333337
/Courier rf /Fm 256[{}0 83.333337 /Symbol rf /Fn 107[37
37 24[37 42 42 60 42 42 23 32 28 42 42 42 42 65 23 42
23 23 42 42 28 37 42 37 42 37 3[28 1[28 1[60 60 78 60
60 51 46 55 60 46 60 60 74 51 2[28 60 60 46 51 60 55
55 60 5[23 23 42 42 42 42 42 42 42 42 42 42 23 21 28
21 2[28 28 28 65 4[28 29[46 46 2[{ TeXBase1Encoding ReEncodeFont }76
83.333337 /Times-Roman rf /Fo 135[60 86 1[66 40 47 53
1[66 60 66 100 33 66 40 33 66 60 40 53 66 53 1[60 9[120
2[80 66 86 1[73 2[113 80 2[47 2[73 80 1[86 1[86 1[60
15[33 47[{ TeXBase1Encoding ReEncodeFont }35 119.999948
/Times-Bold rf /Fp 134[42 42 60 42 42 23 32 28 1[42 42
42 65 23 42 23 23 42 42 28 37 42 37 42 37 8[60 1[60 60
51 46 55 3[60 74 51 2[28 3[51 60 1[55 60 18[21 1[21 44[{
 .167 SlantFont TeXBase1Encoding ReEncodeFont }40 83.333337
/Times-Roman rf /Fq 137[50 50 28 39 33 2[50 50 78 28
2[28 50 2[44 50 44 1[44 9[94 12[39 2[72 55 1[72 1[66
8[50 50 5[50 50 2[25 1[25 44[{ TeXBase1Encoding ReEncodeFont }27
100.000003 /Times-Roman rf /Fr 135[72 2[72 6[72 4[40
20[88 80 96 4[128 88 6[88 3[104 6[40 58[{
 TeXBase1Encoding ReEncodeFont }12 143.999997 /Times-Roman
rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
%%PaperSize: Letter

%%EndSetup
%%Page: 1 1
1 0 bop 1211 880 a Fr(LiS:)35 b(Linux)f(STREAMS)567 1121
y Fq(Francisco)25 b(J.)f(Ballesteros)212 b(Denis)25 b(Froschauer)213
b(Da)n(vid)24 b(Grothe)1531 1237 y(Graham)g(Wheeler)1594
1431 y(June)h(22,)f(1998)673 1732 y Fp(Not)g(all)h(netw)o(orking)e
(softw)o(are)h(is)h(based)f(on)g(BSD)i(sock)o(ets.)38
b(System)24 b(V)h(UNIX)648 1832 y(systems,)19 b(and)f(most)h
(commercial)e(netw)o(orking)f(code,)j(use)f(STREAMS.)h(The)g(LiS)648
1932 y(project)24 b(w)o(as)j(de)n(v)o(eloped)c(to)j(mak)o(e)g(STREAMS)g
(a)n(v)n(ailable)f(for)g(Linux,)h(with)g(the)648 2031
y(aim)c(of)g(making)e(Linux)h(the)h(best)h(UNIX)f(platform)e(for)i(de)n
(v)o(eloping,)d(deb)n(ugging,)648 2131 y(and)g(using)h(STREAMS)h(softw)
o(are.)440 2410 y Fo(Intr)n(oduction)440 2595 y Fn(The)e(input/output)e
(system)j(in)f(UNIX)h(is)g(f)o(ar)f(from)g(simple)g(and)g(in)m(v)n(olv)
o(es)f(man)o(y)g(dif)n(ferent)g(mod-)440 2695 y(ules:)37
b(Netw)o(orking)25 b(in)m(v)n(olv)o(es)f(dif)n(ferent)h(protocol)f
(stages)j(arranged)d(in)i(protocol)e(stacks;)30 b(T)-6
b(er)n(-)440 2795 y(minal)20 b(I/O)g(in)m(v)n(olv)o(es)f(dif)n(ferent)f
(\223line)i(disciplines\224)g(stack)o(ed)g(o)o(v)o(er)f(\(perhaps)f
(netw)o(ork\))h(de)n(vices.)440 2894 y(All)i(those)f(modules)f(perform)
f(some)i(processing)f(on)h(e)o(xisting)f(I/O)i(data)f(\003o)n(ws.)565
2994 y(In)28 b(Linux)g(and)g(most)h(BSD)g(systems,)j(I/O)d(modules)e
(li)n(v)o(e)i(inside)f(the)h(k)o(ernel)f(and)g(the)h(re-)440
3094 y(lations)f(between)f(them)g(are)g(more)g(or)h(less)g(hardwired)e
(into)i(the)f(code.)47 b(As)28 b(an)g(e)o(xample,)g(the)440
3193 y(TCP/IP)21 b(protocol)e(stack)i(is)h(a)f(carefully)e(programmed)e
(set)22 b(of)e(modules)f(with)i(strong)f(interrela-)440
3293 y(tions.)25 b(It)20 b(is)i(designed)c(to)j(w)o(ork)e(well)i(on)f
(typical)g(con\002gurations.)565 3392 y(STREAMS)j(is)h(a)g(\003e)o
(xible)e(input/output)f(system)i(which)f(w)o(as)i(initially)f(designed)
f(to)h(o)o(v)o(er)n(-)440 3492 y(come)d(the)g(in\003e)o(xibility)f(of)h
(pre)n(vious)f(UNIX)h(systems)h([5)o(].)k(It)20 b(is)i(an)e(alternati)n
(v)o(e)f(to)h(sock)o(ets)g(and)440 3592 y(is)j(used)g(in)f(most)h
(commercial)e(UNIX)h(v)o(ersions.)31 b(Some)22 b(sort)g(of)g(STREAMS)h
(is)h(needed)d(if)h(we)440 3691 y(e)n(v)o(er)h(w)o(ant)h(netw)o(orking)
e(softw)o(are)i(from)f(systems)i(such)e(lik)o(e)i(Solaris,)g(Unixw)o
(are,)f(etc.)36 b(to)25 b(run)440 3791 y(of)n(f-the-shelf)18
b(on)h(Linux)440 4070 y Fo(What)30 b(is)f(a)h(STREAM?)440
4256 y Fn(A)23 b(STREAM)f(\(see)g(\002gure)f(1\))h(is)h(in)f(essence)g
(a)h(dynamically)d(con\002gurable)f(stack)j(of)g(modules.)440
4355 y(Each)17 b(module)g(does)h(some)f(processing)g(on)g(a)i(data)e
(\003o)n(w)h(as)h(it)g(goes)e(from)g(the)h(de)n(vice)f(to)h(the)g(user)
440 4455 y(or)24 b(vice)n(v)o(ersa.)36 b(The)24 b(user)g(percei)n(v)o
(es)f(a)h(STREAM)h(as)g(a)g(\002le.)37 b(It)25 b(is)g(handled)e(with)h
(usual)g Fl(open)p Fn(,)440 4554 y Fl(read)p Fn(,)c Fl(write)p
Fn(,)g Fl(ioctl)p Fn(,)g(and)d Fl(close)j Fn(system)d(calls.)25
b(Data)18 b(written)f(by)g(the)h(user)f(is)i(packaged)c(into)440
4654 y Fk(messa)o(g)o(es)p Fn(,)i(which)f(are)g(sent)g(do)n(wnstream.)
22 b(Data)17 b(read)e(by)h(the)g(user)g(comes)g(from)f(messages)i(sent)
440 4754 y(upstream)i(by)h(an)g(underlying)e(de)n(vice)h(dri)n(v)o(er)
-5 b(.)565 4853 y(A)21 b(couple)f(of)h(additional)e(system)j(calls,)f
Fl(putpmsg)j Fn(and)d Fl(getpmsg)p Fn(,)j(allo)n(w)d(the)g(user)g(to)g
(send)440 4953 y(and)31 b(recei)n(v)o(e)f(STREAMS)i(messages)g
(directly)-5 b(.)57 b(There)30 b(is)j(yet)e(another)f(system)i(call,)i
Fl(poll)p Fn(,)440 5053 y(which)20 b(pro)o(vides)e(an)i(alternate)g
(interf)o(ace)f(for)h Fl(select)p Fn(.)565 5152 y(Therefore,)d(e)n(v)o
(ery)i(STREAM)i(is)g(made)e(of:)565 5313 y Fj(\017)41
b Fn(A)17 b(mandatory)e Fk(STREAM)i(head)p Fn(,)f(which)h(talks)g(to)h
(the)f(user)g(process)g(doing)f(I/O.)h(The)g(head)648
5413 y(\002lls)30 b(the)f(gap)g(between)f(user)i(system)f(calls)h(and)f
(the)g(message)h(\003o)n(w)-5 b(.)52 b(Thus,)31 b(a)f
Fl(write)1851 5662 y Fn(1)p eop
%%Page: 2 2
2 1 bop 648 531 a Fn(into)28 b(the)g(STREAM)g(is)i(handled)c(by)i(the)g
(head)g(by)g(sending)f(a)i(message)f(do)n(wnstream.)648
631 y(Con)m(v)o(ersely)-5 b(,)20 b(a)j(data)f(message)h(going)e
(upstream)g(is)j(used)e(by)g(the)g(head)g(to)h(service)f
Fl(read)648 731 y Fn(system)e(calls)h(on)f(the)g(STREAM.)565
895 y Fj(\017)41 b Fn(A)30 b(\(maybe)f(empty\))g(stack)h(of)g(STREAM)g
(modules.)54 b(The)o(y)29 b(typically)g(perform)f(some)648
994 y(computation)14 b(on)j(messages)g(passing)f(by)h(and)f(forw)o(ard)
g(them)g(either)h(upstream)f(or)g(do)n(wn-)648 1094 y(stream.)34
b(As)24 b(an)g(e)o(xample,)e(IP)i(on)f(X.25)g(encapsulation)e(\(IXE\))i
(could)f(be)i(implemented)648 1194 y(as)f(a)h(STREAMS)f(module:)29
b(IP)23 b(pack)o(ets)g(w)o(ould)f(be)h(\(de\)encapsulated)d(as)k(the)o
(y)e(pass)h(by)648 1293 y(the)i(IXE)g(module.)40 b(A)26
b(terminal)f(line)g(discipline)g(module)f(could)h(serv)o(e)g(as)h(an)f
(e)o(xample)648 1393 y(too:)f(typed)c(characters)f(can)h(be)g
Fk(cook)o(ed)h Fn(as)g(the)o(y)f(cross)g(the)g(line)h(discipline)e
(module.)565 1557 y Fj(\017)41 b Fn(A)22 b(mandatory)e(STREAM)j(dri)n
(v)o(er)m(,)d(which)i(interconnects)e(the)j(STREAM)f(to)g(the)h(de)n
(vice)648 1657 y(sitting)d(belo)n(w)g(it.)927 3340 y
@beginspecial 0 @llx 0 @lly 265 @urx 211 @ury 2267 @rwi
@setspecial
%%BeginDocument: fig/astr.eps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-45.0 229.0 translate 0.900 -0.900 scale
0.500 setlinewidth
% Polyline
n 111 19 m 104 19 104 42 7 arcto 4 {pop} repeat 104 49 182 49 7 arcto 4 {pop} repeat 189 49 189 26 7 arcto 4 {pop} repeat 189 19 111 19 7 arcto 4 {pop} repeat clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
112 38 m 
gs 1 -1 scale (user process ) col-1 show gr
% Polyline
n 189 114 m 189 79 l  104 79 l  104 114 l 
 clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
115 101 m 
gs 1 -1 scale (stream head) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
126 165 m 
gs 1 -1 scale (module ) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
121 178 m 
gs 1 -1 scale (\(optional\)) col-1 show gr
% Polyline
n 189 184 m 189 149 l  104 149 l  104 184 l 
 clp gs col-1 s gr
% Polyline
n 189 254 m 189 219 l  104 219 l  104 254 l 
 clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
114 241 m 
gs 1 -1 scale (device driver) col-1 show gr
n 207.171 237.886 m 199.000 239.000 l 205.685 234.172 l gs 2 setlinejoin col-1 s gr
	[4.000000] 0 setdash
% Polyline
n 199 239 m 224 229 l  219 244 l  239 234 l gs col-1 s gr
	[] 0 setdash
n 230.950 235.789 m 239.000 234.000 l 232.739 239.367 l gs 2 setlinejoin col-1 s gr
% Polyline
n 119 219 m 119 194 l gs col-1 s gr
n 117.000 202.000 m 119.000 194.000 l 121.000 202.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 119 149 m 119 124 l gs col-1 s gr
n 117.000 132.000 m 119.000 124.000 l 121.000 132.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 119 79 m 119 54 l gs col-1 s gr
n 117.000 62.000 m 119.000 54.000 l 121.000 62.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 159 49 m 159 74 l gs col-1 s gr
n 161.000 66.000 m 159.000 74.000 l 157.000 66.000 l gs 2 setlinejoin col-1 s gr
	[4.000000] 0 setdash
% Polyline
n 49 64 m 334 64 l  339 64 l gs col-1 s gr
	[] 0 setdash
% Polyline
n 159 114 m 159 139 l gs col-1 s gr
n 161.000 131.000 m 159.000 139.000 l 157.000 131.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 159 184 m 159 209 l gs col-1 s gr
n 161.000 201.000 m 159.000 209.000 l 157.000 201.000 l gs 2 setlinejoin col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
249 239 m 
gs 1 -1 scale (hardware interface) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
219 57 m 
gs 1 -1 scale (User) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
239 80 m 
gs 1 -1 scale (Kernel) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
179 139 m 
gs 1 -1 scale (down) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
84 139 m 
gs 1 -1 scale (up) col-1 show gr
$F2psEnd
%%EndDocument
 @endspecial 1246 3523 a(Figure)f(1:)26 b(Components)18
b(of)i(a)h(STREAM)565 3803 y(The)k(nice)h(property)d(of)j(STREAMS)g(is)
h(that)f(dif)n(ferent)e(modules)h(\(or)g(dri)n(v)o(ers\))f(can)i(be)f
(de-)440 3903 y(coupled)17 b(v)o(ery)g(easily)-5 b(.)24
b(Hence,)18 b(the)o(y)f(could)g(be)h(de)n(v)o(eloped)e(independently)f
(by)i(dif)n(ferent)g(people)440 4002 y(without)23 b(e)n(v)o(en)h(kno)n
(wing)e(the)i(actual)g(protocol)e(stack)j(where)e(the)o(y)h(will)h(be)f
(used.)36 b(In)24 b(addition,)440 4102 y(modules)c(can)g(be)h
(dynamically)e(\223pushed\224)g(onto)h(\(and)g(popped)f(of)n(f!\))26
b(the)21 b(STREAM,)g(which)f(is)440 4201 y(a)h(v)o(ery)e(con)m(v)o
(enient)e(feature.)565 4301 y(Finally)-5 b(,)15 b(special)h
Fk(multiple)n(xor)h Fn(dri)n(v)o(ers,)f(allo)n(w)f(se)n(v)o(eral)g
(STREAMS)h(to)g(be)g(multiple)o(x)o(ed)d(into)440 4401
y(another)24 b(one)h(\(or)g(ones\).)40 b(The)26 b Fl(ip)g
Fn(module)f(in)g(\002gure)g(2\))g(is)i(a)f(multiple)o(xor)-5
b(.)39 b(In)25 b(this)h(e)o(xample,)440 4500 y(it)g(multiple)o(x)o(es)d
(both)h(TCP)i(and)e(IP)i(messages)f(using)f(either)h(an)f(ethernet)g
(dri)n(v)o(er)g(or)g(an)h(IP-on-)440 4600 y(X.25)d(dri)n(v)o(er)-5
b(.)31 b(A)23 b(full)f(STREAMS)h(netw)o(ork)e(can)h(be)h(b)n(uilt)g
(\(see)f(\002gure)g(2\))g(and)g(man)o(y)g(dif)n(ferent)440
4700 y(protocol)c(stacks)j(can)f(be)g(setup)g(dynamically)e(for)i
(operation.)440 4979 y Fo(The)30 b(LiS)h(pr)n(oject)440
5164 y Fn(It)24 b(all)h(started)f(before)f(we)h(had)g(Linux,)g(when)f
(Dennis)h(M.)g(Ritchie)h(designed)e(Streams)h(for)f(9th)440
5264 y(edition)29 b(UNIX)g([5].)53 b(Since)29 b(then,)j(the)d(STREAMS)h
(concept)f(has)g(been)g(impro)o(v)o(ed)3000 5234 y Fi(1)3062
5264 y Fn(and)g(re-)p 440 5333 1146 4 v 531 5389 a Fh(1)560
5413 y Fg(Some)16 b(w)o(ould)i(say)g(\223messed-up\224)g
Fe(:-\))p Fg(.)1851 5662 y Fn(2)p eop
%%Page: 3 3
3 2 bop 927 2015 a @beginspecial 0 @llx 0 @lly 263 @urx
218 @ury 2267 @rwi @setspecial
%%BeginDocument: fig/strnet.eps
%Magnification: 1.00
/$F2psDict 200 dict def
$F2psDict begin
$F2psDict /mtrx matrix put
/col-1 {0 setgray} bind def
/col0 {0.000 0.000 0.000 srgb} bind def
/col1 {0.000 0.000 1.000 srgb} bind def
/col2 {0.000 1.000 0.000 srgb} bind def
/col3 {0.000 1.000 1.000 srgb} bind def
/col4 {1.000 0.000 0.000 srgb} bind def
/col5 {1.000 0.000 1.000 srgb} bind def
/col6 {1.000 1.000 0.000 srgb} bind def
/col7 {1.000 1.000 1.000 srgb} bind def
/col8 {0.000 0.000 0.560 srgb} bind def
/col9 {0.000 0.000 0.690 srgb} bind def
/col10 {0.000 0.000 0.820 srgb} bind def
/col11 {0.530 0.810 1.000 srgb} bind def
/col12 {0.000 0.560 0.000 srgb} bind def
/col13 {0.000 0.690 0.000 srgb} bind def
/col14 {0.000 0.820 0.000 srgb} bind def
/col15 {0.000 0.560 0.560 srgb} bind def
/col16 {0.000 0.690 0.690 srgb} bind def
/col17 {0.000 0.820 0.820 srgb} bind def
/col18 {0.560 0.000 0.000 srgb} bind def
/col19 {0.690 0.000 0.000 srgb} bind def
/col20 {0.820 0.000 0.000 srgb} bind def
/col21 {0.560 0.000 0.560 srgb} bind def
/col22 {0.690 0.000 0.690 srgb} bind def
/col23 {0.820 0.000 0.820 srgb} bind def
/col24 {0.500 0.190 0.000 srgb} bind def
/col25 {0.630 0.250 0.000 srgb} bind def
/col26 {0.750 0.380 0.000 srgb} bind def
/col27 {1.000 0.500 0.500 srgb} bind def
/col28 {1.000 0.630 0.630 srgb} bind def
/col29 {1.000 0.750 0.750 srgb} bind def
/col30 {1.000 0.880 0.880 srgb} bind def
/col31 {1.000 0.840 0.000 srgb} bind def

end
save
-17.0 262.0 translate
1 -1 scale

/cp {closepath} bind def
/ef {eofill} bind def
/gr {grestore} bind def
/gs {gsave} bind def
/sa {save} bind def
/rs {restore} bind def
/l {lineto} bind def
/m {moveto} bind def
/rm {rmoveto} bind def
/n {newpath} bind def
/s {stroke} bind def
/sh {show} bind def
/slc {setlinecap} bind def
/slj {setlinejoin} bind def
/slw {setlinewidth} bind def
/srgb {setrgbcolor} bind def
/rot {rotate} bind def
/sc {scale} bind def
/sd {setdash} bind def
/ff {findfont} bind def
/sf {setfont} bind def
/scf {scalefont} bind def
/sw {stringwidth} bind def
/tr {translate} bind def
/tnt {dup dup currentrgbcolor
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add srgb}
  bind def
/shd {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
  4 -2 roll mul srgb} bind def
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
10 setmiterlimit
n 0 792 m 0 0 l 612 0 l 612 792 l cp clip
 0.06000 0.06000 sc
7.500 slw
% Polyline
n 1125 2925 m 1125 2550 l 300 2550 l 300 2925 l cp gs col-1 s gr 
/Times-Roman ff 180.00 scf sf
465 2820 m
gs 1 -1 sc (sw. bg) col-1 sh gr
% Polyline
n 2775 3300 m 2775 2925 l 2250 2925 l 2250 3300 l cp gs col-1 s gr 
/Times-Roman ff 180.00 scf sf
2400 3180 m
gs 1 -1 sc (ixe) col-1 sh gr
% Polyline
n 1950 1800 m 1950 1425 l 1425 1425 l 1425 1800 l cp gs col-1 s gr 
/Times-Roman ff 180.00 scf sf
1560 1680 m
gs 1 -1 sc (tcp) col-1 sh gr
% Polyline
n 2700 1800 m 2700 1425 l 2175 1425 l 2175 1800 l cp gs col-1 s gr 
/Times-Roman ff 180.00 scf sf
2295 1695 m
gs 1 -1 sc (udp) col-1 sh gr
% Polyline
n 1050 1800 m 1050 1425 l 525 1425 l 525 1800 l cp gs col-1 s gr 
/Times-Roman ff 180.00 scf sf
675 1680 m
gs 1 -1 sc (ttp) col-1 sh gr
% Polyline
n 2325 2550 m 2325 2175 l 1800 2175 l 1800 2550 l cp gs col-1 s gr 
/Times-Roman ff 180.00 scf sf
1995 2445 m
gs 1 -1 sc (ip) col-1 sh gr
% Polyline
n 3600 2550 m 3600 2175 l 3075 2175 l 3075 2550 l cp gs col-1 s gr 
/Times-Roman ff 180.00 scf sf
3195 2430 m
gs 1 -1 sc (x25) col-1 sh gr
% Polyline
n 1875 3825 m 1875 3450 l 1350 3450 l 1350 3825 l cp gs col-1 s gr 
/Times-Roman ff 180.00 scf sf
1410 3705 m
gs 1 -1 sc (ether) col-1 sh gr
% Polyline
n 3600 3825 m 3600 3450 l 3075 3450 l 3075 3825 l cp gs col-1 s gr 
/Times-Roman ff 180.00 scf sf
3180 3720 m
gs 1 -1 sc (lapb) col-1 sh gr
% Polyline
 [66.7] 0 sd
n 300 975 m 4575 975 l 4650 975 l gs col-1 s gr  [] 0 sd
% Polyline
gs  clippath
788 1191 m 750 1325 l 713 1191 l 713 1365 l 788 1365 l  cp clip
n 750 750 m 750 1350 l gs col-1 s gr gr

% arrowhead
n 788 1191 m 750 1325 l 713 1191 l  col-1 s
% Polyline
gs  clippath
788 2316 m 750 2450 l 713 2316 l 713 2490 l 788 2490 l  cp clip
n 750 1950 m 750 2475 l gs col-1 s gr gr

% arrowhead
n 788 2316 m 750 2450 l 713 2316 l  col-1 s
% Polyline
gs  clippath
1688 1191 m 1650 1325 l 1613 1191 l 1613 1365 l 1688 1365 l  cp clip
n 1650 750 m 1650 1350 l gs col-1 s gr gr

% arrowhead
n 1688 1191 m 1650 1325 l 1613 1191 l  col-1 s
% Polyline
gs  clippath
2438 1191 m 2400 1325 l 2363 1191 l 2363 1365 l 2438 1365 l  cp clip
n 2400 750 m 2400 1350 l gs col-1 s gr gr

% arrowhead
n 2438 1191 m 2400 1325 l 2363 1191 l  col-1 s
% Polyline
gs  clippath
788 2241 m 750 2375 l 713 2241 l 713 2415 l 788 2415 l  cp clip
n 750 1875 m 750 2400 l gs col-1 s gr gr

% arrowhead
n 788 2241 m 750 2375 l 713 2241 l  col-1 s
% Polyline
gs  clippath
3338 3216 m 3300 3350 l 3263 3216 l 3263 3390 l 3338 3390 l  cp clip
n 3300 2550 m 3300 3375 l gs col-1 s gr gr

% arrowhead
n 3338 3216 m 3300 3350 l 3263 3216 l  col-1 s
% Polyline
 [66.7] 0 sd
gs  clippath
1688 4191 m 1650 4325 l 1613 4191 l 1613 4365 l 1688 4365 l  cp clip
1463 4059 m 1500 3924 l 1538 4059 l 1538 3885 l 1463 3885 l  cp clip
n 1500 3900 m 1500 4200 l 1650 4050 l 1650 4350 l gs col-1 s gr gr
 [] 0 sd
% arrowhead
n 1463 4059 m 1500 3924 l 1538 4059 l  col-1 s
% arrowhead
n 1688 4191 m 1650 4325 l 1613 4191 l  col-1 s
% Polyline
 [66.7] 0 sd
gs  clippath
3488 4116 m 3450 4250 l 3413 4116 l 3413 4290 l 3488 4290 l  cp clip
3263 3984 m 3300 3849 l 3338 3984 l 3338 3810 l 3263 3810 l  cp clip
n 3300 3825 m 3300 4125 l 3450 3975 l 3450 4275 l gs col-1 s gr gr
 [] 0 sd
% arrowhead
n 3263 3984 m 3300 3849 l 3338 3984 l  col-1 s
% arrowhead
n 3488 4116 m 3450 4250 l 3413 4116 l  col-1 s
% Polyline
 [15 50.0] 50.0 sd
n 1275 1200 m 2775 1200 l 2775 2625 l 1275 2625 l cp gs col-1 s gr  [] 0 sd
% Interp Spline
gs  clippath
1920 2014 m 1940 2152 l 1852 2044 l 1922 2204 l 1990 2174 l  cp clip
n 1650 1800 m
	1786.0 1923.3 1842.2 1979.5 1875 2025 curveto
	1892.3 2049.0 1911.0 2086.5 1950 2175 curveto
 gs col-1 s gr
 gr

% arrowhead
n 1920 2014 m 1940 2152 l 1852 2044 l  col-1 s
% Interp Spline
gs  clippath
2212 2056 m 2112 2153 l 2147 2018 l 2060 2169 l 2125 2207 l  cp clip
n 2475 1800 m
	2340.4 1878.3 2284.2 1915.8 2250 1950 curveto
	2215.8 1984.2 2178.3 2040.5 2100 2175 curveto
 gs col-1 s gr
 gr

% arrowhead
n 2212 2056 m 2112 2153 l 2147 2018 l  col-1 s
% Interp Spline
gs  clippath
1740 3287 m 1721 3425 l 1666 3297 l 1690 3470 l 1764 3460 l  cp clip
n 1950 2550 m
	1927.8 2767.7 1909.0 2861.4 1875 2925 curveto
	1849.8 2972.0 1746.9 3022.1 1725 3075 curveto
	1696.0 3145.1 1696.0 3238.8 1725 3450 curveto
 gs col-1 s gr
 gr

% arrowhead
n 1740 3287 m 1721 3425 l 1666 3297 l  col-1 s
% Interp Spline
gs  clippath
2491 2789 m 2408 2902 l 2421 2763 l 2360 2926 l 2430 2952 l  cp clip
n 2175 2550 m
	2144.1 2631.6 2144.1 2669.1 2175 2700 curveto
	2236.9 2761.9 2338.1 2638.1 2400 2700 curveto
	2446.4 2746.4 2446.4 2802.7 2400 2925 curveto
 gs col-1 s gr
 gr

% arrowhead
n 2491 2789 m 2408 2902 l 2421 2763 l  col-1 s
% Interp Spline
gs  clippath
3311 2036 m 3232 2151 l 3240 2012 l 3185 2177 l 3256 2201 l  cp clip
n 2550 3300 m
	2503.6 3422.3 2503.6 3478.6 2550 3525 curveto
	2632.5 3607.5 2767.6 3603.6 2850 3525 curveto
	3283.4 3111.8 2588.7 2360.2 2925 1950 curveto
	2990.9 1869.6 3142.5 1810.6 3225 1875 curveto
	3285.0 1921.9 3285.0 1996.9 3225 2175 curveto
 gs col-1 s gr
 gr

% arrowhead
n 3311 2036 m 3232 2151 l 3240 2012 l  col-1 s
% Interp Spline
gs  clippath
1516 3314 m 1433 3427 l 1446 3288 l 1385 3451 l 1455 3477 l  cp clip
n 750 2925 m
	688.1 3088.1 688.1 3163.1 750 3225 curveto
	935.6 3410.6 1239.4 3039.4 1425 3225 curveto
	1471.4 3271.4 1471.4 3327.7 1425 3450 curveto
 gs col-1 s gr
 gr

% arrowhead
n 1516 3314 m 1433 3427 l 1446 3288 l  col-1 s
/Times-Roman ff 180.00 scf sf
3300 870 m
gs 1 -1 sc (User) col-1 sh gr
/Times-Roman ff 180.00 scf sf
3600 1215 m
gs 1 -1 sc (Kernel) col-1 sh gr
$F2psEnd
rs
%%EndDocument
 @endspecial 1330 2197 a Fn(Figure)20 b(2:)25 b(A)c(STREAMS)g(netw)o
(ork)440 2547 y(vised)30 b(by)g(dif)n(ferent)e(Operating)h(Systems.)55
b(Dif)n(ferent)29 b(v)n(ariants)g(ranging)g(from)g(UNIX)h(SVr4)440
2647 y(STREAMS)21 b([1)o(])f(to)h(Plan)f(9)g(Streams)g([3])g(e)o(xist)g
(today)-5 b(.)565 2747 y(Unfortunately)g(,)14 b(SVr4)j(complicated)f
(the)h(neat)g(and)g(clean)g(design)g(of)g(9th)g(edition')-5
b(s)17 b(Streams)440 2846 y(mainly)27 b(to)g(add)g(ne)n(w)h(features)e
(\(such)h(as)h(atomic)f(gather/scatter)f(writes\).)47
b(Dif)n(ferent)26 b(de)n(vices)440 2946 y(such)20 b(as)h(pipes)f(and)g
(\002fos)g(were)g(also)g(reimplemented)e(using)i(STREAMS)h(\(see)f
(\002gure)f(3\).)927 4197 y @beginspecial 0 @llx 0 @lly
290 @urx 174 @ury 2267 @rwi @setspecial
%%BeginDocument: fig/strpipe.eps
%Magnification: 1.00
/$F2psDict 200 dict def
$F2psDict begin
$F2psDict /mtrx matrix put
/col-1 {0 setgray} bind def
/col0 {0.000 0.000 0.000 srgb} bind def
/col1 {0.000 0.000 1.000 srgb} bind def
/col2 {0.000 1.000 0.000 srgb} bind def
/col3 {0.000 1.000 1.000 srgb} bind def
/col4 {1.000 0.000 0.000 srgb} bind def
/col5 {1.000 0.000 1.000 srgb} bind def
/col6 {1.000 1.000 0.000 srgb} bind def
/col7 {1.000 1.000 1.000 srgb} bind def
/col8 {0.000 0.000 0.560 srgb} bind def
/col9 {0.000 0.000 0.690 srgb} bind def
/col10 {0.000 0.000 0.820 srgb} bind def
/col11 {0.530 0.810 1.000 srgb} bind def
/col12 {0.000 0.560 0.000 srgb} bind def
/col13 {0.000 0.690 0.000 srgb} bind def
/col14 {0.000 0.820 0.000 srgb} bind def
/col15 {0.000 0.560 0.560 srgb} bind def
/col16 {0.000 0.690 0.690 srgb} bind def
/col17 {0.000 0.820 0.820 srgb} bind def
/col18 {0.560 0.000 0.000 srgb} bind def
/col19 {0.690 0.000 0.000 srgb} bind def
/col20 {0.820 0.000 0.000 srgb} bind def
/col21 {0.560 0.000 0.560 srgb} bind def
/col22 {0.690 0.000 0.690 srgb} bind def
/col23 {0.820 0.000 0.820 srgb} bind def
/col24 {0.500 0.190 0.000 srgb} bind def
/col25 {0.630 0.250 0.000 srgb} bind def
/col26 {0.750 0.380 0.000 srgb} bind def
/col27 {1.000 0.500 0.500 srgb} bind def
/col28 {1.000 0.630 0.630 srgb} bind def
/col29 {1.000 0.750 0.750 srgb} bind def
/col30 {1.000 0.880 0.880 srgb} bind def
/col31 {1.000 0.840 0.000 srgb} bind def

end
save
-44.0 186.0 translate
1 -1 scale

/cp {closepath} bind def
/ef {eofill} bind def
/gr {grestore} bind def
/gs {gsave} bind def
/sa {save} bind def
/rs {restore} bind def
/l {lineto} bind def
/m {moveto} bind def
/rm {rmoveto} bind def
/n {newpath} bind def
/s {stroke} bind def
/sh {show} bind def
/slc {setlinecap} bind def
/slj {setlinejoin} bind def
/slw {setlinewidth} bind def
/srgb {setrgbcolor} bind def
/rot {rotate} bind def
/sc {scale} bind def
/sd {setdash} bind def
/ff {findfont} bind def
/sf {setfont} bind def
/scf {scalefont} bind def
/sw {stringwidth} bind def
/tr {translate} bind def
/tnt {dup dup currentrgbcolor
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add srgb}
  bind def
/shd {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
  4 -2 roll mul srgb} bind def
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
10 setmiterlimit
n 0 792 m 0 0 l 612 0 l 612 792 l cp clip
 0.06000 0.06000 sc
7.500 slw
% Polyline
n 3930 225 m 3825 225 3825 570 105 arcto 4 {pop} repeat
  3825 675 4995 675 105 arcto 4 {pop} repeat
  5100 675 5100 330 105 arcto 4 {pop} repeat
  5100 225 3930 225 105 arcto 4 {pop} repeat
 cp gs col-1 s gr 
/Times-Roman ff 180.00 scf sf
3945 510 m
gs 1 -1 sc (user process ) col-1 sh gr
% Polyline
n 1680 300 m 1575 300 1575 645 105 arcto 4 {pop} repeat
  1575 750 2745 750 105 arcto 4 {pop} repeat
  2850 750 2850 405 105 arcto 4 {pop} repeat
  2850 300 1680 300 105 arcto 4 {pop} repeat
 cp gs col-1 s gr 
/Times-Roman ff 180.00 scf sf
1695 585 m
gs 1 -1 sc (user process ) col-1 sh gr
% Polyline
n 2850 1725 m 2850 1200 l 1575 1200 l 1575 1725 l cp gs col-1 s gr 
/Times-Roman ff 180.00 scf sf
1740 1530 m
gs 1 -1 sc (stream head) col-1 sh gr
% Polyline
n 1575 2250 m 5175 2250 l 5175 3075 l 1575 3075 l cp gs col-1 s gr 
/Times-Roman ff 180.00 scf sf
2767 2732 m
gs 1 -1 sc (STREAMS pipe) col-1 sh gr
% Polyline
 [66.7] 0 sd
n 750 975 m 5550 975 l 5550 975 l gs col-1 s gr  [] 0 sd
% Polyline
gs  clippath
1763 2034 m 1800 1899 l 1838 2034 l 1838 1860 l 1763 1860 l  cp clip
n 1800 2250 m 1800 1875 l gs col-1 s gr gr

% arrowhead
n 1763 2034 m 1800 1899 l 1838 2034 l  col-1 s
% Polyline
gs  clippath
1763 984 m 1800 849 l 1838 984 l 1838 810 l 1763 810 l  cp clip
n 1800 1200 m 1800 825 l gs col-1 s gr gr

% arrowhead
n 1763 984 m 1800 849 l 1838 984 l  col-1 s
% Polyline
gs  clippath
2438 966 m 2400 1100 l 2363 966 l 2363 1140 l 2438 1140 l  cp clip
n 2400 750 m 2400 1125 l gs col-1 s gr gr

% arrowhead
n 2438 966 m 2400 1100 l 2363 966 l  col-1 s
% Polyline
gs  clippath
2438 1941 m 2400 2075 l 2363 1941 l 2363 2115 l 2438 2115 l  cp clip
n 2400 1725 m 2400 2100 l gs col-1 s gr gr

% arrowhead
n 2438 1941 m 2400 2075 l 2363 1941 l  col-1 s
% Polyline
gs  clippath
4013 909 m 4050 774 l 4088 909 l 4088 735 l 4013 735 l  cp clip
n 4050 1125 m 4050 750 l gs col-1 s gr gr

% arrowhead
n 4013 909 m 4050 774 l 4088 909 l  col-1 s
% Polyline
gs  clippath
4688 891 m 4650 1025 l 4613 891 l 4613 1065 l 4688 1065 l  cp clip
n 4650 675 m 4650 1050 l gs col-1 s gr gr

% arrowhead
n 4688 891 m 4650 1025 l 4613 891 l  col-1 s
% Polyline
gs  clippath
4688 1866 m 4650 2000 l 4613 1866 l 4613 2040 l 4688 2040 l  cp clip
n 4650 1650 m 4650 2025 l gs col-1 s gr gr

% arrowhead
n 4688 1866 m 4650 2000 l 4613 1866 l  col-1 s
% Polyline
gs  clippath
4013 2034 m 4050 1899 l 4088 2034 l 4088 1860 l 4013 1860 l  cp clip
n 4050 2250 m 4050 1875 l gs col-1 s gr gr

% arrowhead
n 4013 2034 m 4050 1899 l 4088 2034 l  col-1 s
% Polyline
n 5100 1650 m 5100 1125 l 3825 1125 l 3825 1650 l cp gs col-1 s gr 
% Polyline
 [66.7] 0 sd
gs  clippath
1818 2399 m 1808 2275 l 1875 2380 l 1824 2226 l 1767 2245 l  cp clip
n 4650 2250 m 4500 2925 l 2025 2925 l 1800 2250 l gs col-1 s gr gr
 [] 0 sd
% arrowhead
n 1818 2399 m 1808 2275 l 1875 2380 l  col-1 s
% Polyline
 [66.7] 0 sd
gs  clippath
3914 2314 m 4028 2266 l 3950 2362 l 4080 2265 l 4044 2217 l  cp clip
n 2400 2250 m 2775 2475 l 3750 2475 l 4050 2250 l gs col-1 s gr gr
 [] 0 sd
% arrowhead
n 3914 2314 m 4028 2266 l 3950 2362 l  col-1 s
/Times-Roman ff 180.00 scf sf
3150 1215 m
gs 1 -1 sc (Kernel) col-1 sh gr
/Times-Roman ff 180.00 scf sf
3150 870 m
gs 1 -1 sc (User) col-1 sh gr
/Times-Roman ff 180.00 scf sf
2700 2100 m
gs 1 -1 sc (down) col-1 sh gr
/Times-Roman ff 180.00 scf sf
1275 2100 m
gs 1 -1 sc (up) col-1 sh gr
/Times-Roman ff 180.00 scf sf
4950 2025 m
gs 1 -1 sc (down) col-1 sh gr
/Times-Roman ff 180.00 scf sf
3525 2025 m
gs 1 -1 sc (up) col-1 sh gr
/Times-Roman ff 180.00 scf sf
3990 1455 m
gs 1 -1 sc (stream head) col-1 sh gr
$F2psEnd
rs
%%EndDocument
 @endspecial 1286 4380 a(Figure)h(3:)25 b(A)c(STREAMS-based)e(pipe)565
4662 y(Despite)e(being)g(f)o(ar)g(more)f(comple)o(x)g(than)h(Ritchie')
-5 b(s)18 b(Streams,)g(SVr4)f(STREAMS)h(still)h(sim-)440
4762 y(plify)33 b(the)h(construction)f(of)g(netw)o(ork)g(softw)o(are.)
66 b(Indeed,)36 b(most)e(netw)o(orking)e(softw)o(are)h(for)440
4862 y(UNIX)f(System)f(V)h(machines)f(is)h(written)g(using)f(STREAMS)h
(\(including)d(the)j(sock)o(et)f(inter)n(-)440 4961 y(f)o(ace!\).)24
b(W)-7 b(e)22 b(w)o(anted)d(to)i(be)f(able)g(to)g(run)g(SVr4)g(dri)n(v)
o(er)e(softw)o(are)i(under)f(Linux.)565 5061 y(In)25
b(fe)n(w)g(w)o(ords,)h(before)e(LiS)h(w)o(as)i(de)n(v)o(eloped,)c
(Linux)i(w)o(as)h(not)f(compatible)e(with)j(already)440
5160 y(de)n(v)o(eloped)13 b(STREAMS)k(softw)o(are.)23
b(It)16 b(w)o(as)h(also)f(impossible)g(to)g(de)n(v)o(elop)e(STREAMS)i
(softw)o(are)440 5260 y(using)k(a)g(comfortable)e(Linux)h(box.)24
b(That')-5 b(s)21 b(why)e(we)h(started)h(LiS.)565 5383
y(After)29 b(some)h(of)g(us)g(independently)d(started)j(to)g(de)n(v)o
(elop)e(what)i(w)o(ould)f(become)g(LiS,)h(we)1851 5662
y(3)p eop
%%Page: 4 4
4 3 bop 440 531 a Fn(met)21 b(at)h Fl(c.o.l.a.)32 b Fn(and)21
b(decided)f(to)i(coordinate)d(ef)n(forts.)28 b(A)22 b(LiS)g(project)e
(LSM)i(w)o(as)g(posted)f(in)440 631 y(March)e(1995)g(and)h(the)g
(project)f(be)o(gun.)440 869 y Fd(T)-9 b(o)25 b(STREAM)h(or)f(not)g(to)
g(STREAM)440 1024 y Fn(There)i(are)g(se)n(v)o(eral)f(reasons)h(to)h
(use)f(STREAMS:)h(Standard)e(service)h(interf)o(aces)g(to)h(dif)n
(ferent)440 1124 y(layers)17 b(\(DLPI)f(for)h(the)f(data)h(link)g
(layer)m(,)f(NPI)h(for)g(the)g(netw)o(ork)e(layer)m(,)i(and)f(TPI)h
(for)f(the)h(transport)440 1224 y(layer\),)i(\003e)o(xibility)h(and,)f
(SVr4)h(compatibility)-5 b(.)565 1323 y(What)30 b(we)h(lik)o(e)g(about)
e(STREAMS)i(under)e(SVr4)i(is)g(that)g(we)g(can)f(write)g(de)n(vice)g
(dri)n(v)o(ers)440 1423 y(conforming)f(to)k(a)g(po)n(werful)e(b)n(ut)h
(not)h(byzantine)d(API)j(\(DLPI)f(or)h(TPI,)f(in)h(particular\),)g(and)
440 1522 y(ha)n(v)o(e)15 b(e)o(xisting)g(netw)o(ork)f(services)i
(\(DLPI\))f(or)g(e)o(xisting)g(\223applications\224)g(\(read)f
Fk(non)h(k)o(ernel)h(code)p Fn(\))440 1622 y(w)o(ork)k(with)g(the)g(de)
n(vice)f(with)i(no)f(additional)e(w)o(ork.)565 1722 y(Protocol)24
b(stages)i(\(or)f(modules\))f(can)i(be)f(dynamicly)f(added/remo)o(v)o
(ed.)37 b(Imagine)24 b(you)h(are)440 1821 y(deb)n(ugging)15
b(a)k(transport)d(layer)h(interf)o(ace)g(\(TLI\))g(for)g(X.25,)h(you)f
(can)g(push)h(and)f(pop)g(man)o(y)f(times)440 1921 y(an)31
b Fl(x25)p 681 1921 25 4 v 31 w(tli)i Fn(module.)56 b(Put)31
b(in)g(other)g(w)o(ords:)46 b(It')-5 b(s)32 b(an)f(open)f(frame)n(w)o
(ork.)55 b(Those)31 b(modules)440 2021 y(emplo)o(yed)17
b(can)i(of)g(course)g(be)g(shared)f(and)h(reused)f(at)i(dif)n(ferent)e
(places.)24 b(W)m(ith)c(sock)o(ets)f(you)f(just)440 2120
y(ha)n(v)o(e)i(what)g(the)g(k)o(ernel)f(has.)565 2220
y(The)k(bottom)g(line)h(here)f(is)i(that)f(standards)f(are)g(a)i(Good)d
(Thing.)35 b(In)24 b(the)f(era)h(of)g(distrib)n(uted)440
2319 y(systems)33 b(this)f(applies)g(equally)f(to)i(k)o(ernel-le)n(v)o
(el)d(netw)o(ork)h(and)g(communication)f(interf)o(aces.)440
2419 y(The)22 b(STREAMS)h(frame)n(w)o(ork,)d(APIs,)k(and)d(service)i
(interf)o(aces)e(were)i(designed)e(by)h(intelligent)440
2519 y(people)c(at)i(A)-9 b(T&T)18 b(Bell)i(Labs.)k(The)19
b(result)g(is)h(a)g(mechanism)e(which)g(is)i(clean,)f(comprehensible,)
440 2618 y(comprehensi)n(v)o(e,)e(and)i(ele)o(gant)g(to)i(boot)e(\(not)
h(too)f(bad)h(considering)e(its)j(OSI)g(in\003uences\).)565
2718 y(It)j(has)g(been)f(ar)o(gued)f(against)i(STREAMS)g(that)g(the)o
(y)f(are)h(too)g(complicated)e(and)i(too)g(slo)n(w)440
2818 y(when)17 b(compared)f(to)i(BSD)h(sock)o(ets.)24
b(A)18 b(related)g(ar)o(gument)d(is)k(that)f(TCP/IP)g(netw)o(orking)e
(is)j(done)440 2917 y(more)g(ef)n(\002ciently)h(with)g(BSD-style)h
(protocol)d(stacks.)565 3017 y(But,)29 b(consider)d(this,)j(Linux)d
(TCP/IP)h(netw)o(orking)e(code)i(can)g(be)g(used)g(as-it-is)g(with)h
(LiS.)440 3116 y(The)23 b(whole)g(purpose)f(of)h(LiS)h(is)g(simply)f
(to)g(ha)n(v)o(e)g(the)h(STREAMS)f(frame)n(w)o(ork)f(a)n(v)n(ailable,)h
(not)440 3216 y(to)d(replace)f(the)i(Linux)d(TCP/IP)j(protocol)d
(stack.)26 b(Existing)19 b(netw)o(ork)g(softw)o(are)g(is)i(percei)n(v)o
(ed)d(by)440 3316 y(STREAMS)h(users)g(as)g(the)g(dashed)f(box)f(in)i
(\002gure)f(2.)25 b(F)o(ak)o(e)18 b(modules)g(interf)o(acing)f(with)i
(e)o(xisting)440 3415 y(Linux)g(dri)n(v)o(ers)g(and)h(protocol)e
(stacks)j(is)g(all)g(we)f(need.)565 3515 y(W)m(ith)c(respect)f(to)i
(simplicity)-5 b(,)16 b(STREAMS)g(mak)o(e)g(certain)f(things)g(\(such)h
(as)h(\223deep\224)e(protocol)440 3615 y(stacks\))j(more)g(simple)g
(when)f(compared)f(to)j(sock)o(ets.)24 b(Sock)o(ets)18
b(were)g(designed)f(for)g(implement-)440 3714 y(ing)26
b(TCP/IP)i(type)e(netw)o(orking)e(and,)k(although)c(simple,)k(are)f
(not)f Fk(e)n(xtensible)p Fn(.)44 b(That)26 b(is)i(to)f(say)440
3814 y(that)20 b(you)e(can')o(t)h(easily)h(use)f(the)h(sock)o(ets)g
(mechanism)e(to)h(b)n(uild)h(deep)e(protocol)g(stacks)i(of)f(which)440
3913 y(sock)o(ets)f(has)h(no)e(b)n(uilt-in)h(kno)n(wledge.)k(Ev)o(ery)
16 b(time)j(the)f(internet)f(protocol)f(suite)j(needs)e(another)440
4013 y(layer)m(,)i(some)h(hack)g(is)h(lik)o(ely)f(to)g(be)g(made)g(to)g
(sock)o(ets.)565 4113 y(The)k(internet)g(protocol)e(suites)k(are)e
(deeper)g(than)g(the)g(k)o(ernel)g(implementors)f(lik)o(e)i(to)g(think)
440 4212 y(the)o(y)19 b(are.)24 b(Consider)19 b(TCP/IP)g(when)g(IP)h
(is)g(sent)f(using)g(X.25)f(pack)o(ets,)h(transmitted)g(with)g(LAPB)440
4312 y(frames)g(through)e(a)i(dri)n(v)o(er)-5 b(.)24
b(No)n(w)19 b(you)f(ha)n(v)o(e)g(a)i(TCP/IP)p Fj($)p
Fn(X.25)p Fj($)p Fn(LAPB)p Fj($)p Fn(Dri)n(v)o(er)d(stack.)25
b(Then)440 4412 y(add)k(another)g(protocol)f(o)o(v)o(er)g(TCP/IP)j
(\(say)-5 b(,)32 b(NFS\))e(and)f(interpose)g(frame)g(relay)-5
b(.)53 b(The)30 b(stack)440 4511 y(becomes:)g(NFS)p Fj($)p
Fn(TCP/IP)p Fj($)p Fn(X.25)p Fj($)p Fn(LAPB)p Fj($)p
Fn(F)-7 b(.R.)p Fj($)p Fn(Dri)n(v)o(er)i(.)32 b(Sock)o(ets)23
b(are)f(not)h(equipped)e(to)440 4611 y(b)n(uild)h(protocol)f(stacks)i
(such)f(as)h(these)g(that)g(were)f(not)g(designed)g(into)g(it)h(to)g
(be)o(gin)e(with.)32 b(It)23 b(can)440 4710 y(be)d(done,)f(b)n(ut)h(it)
h(is)g(much)f(easier)g(and)g(cleaner)f(with)h(STREAMS.)565
4810 y(Ho)n(we)n(v)o(er)m(,)15 b(it)k(is)f(true)f(that)h(SVr4)f
(STREAMS)h(\(hence,)f(LiS\))h(are)f(much)g(more)g(comple)o(x)e(than)440
4910 y(9th)23 b(edition)f(Streams.)34 b(But)24 b(their)f(comple)o(xity)
e(arises)j(from)e(SVr4)h(added)g(features,)g(Although)440
5009 y(such)h(comple)o(xity)e(is)k(hidden)d(from)g(the)h(STREAMS)h
(programmer)d(as)j(it)g(is)g(dealt)f(with)h(inside)440
5109 y(LiS.)1851 5662 y(4)p eop
%%Page: 5 5
5 4 bop 440 531 a Fd(Let)26 b(the)f(STREAM)i(\003o)o(w)e(fr)n(ee)440
687 y Fn(Most)j(UNIX)g(features)f(ha)n(v)o(e)g(been)g(a)n(v)n(ailable)h
(in)g(source)f(form)g(for)g(people)f(to)i(read)g(and)f(use.)440
787 y(STREAMS)c(w)o(as)h(a)f(notable)f(e)o(xception.)30
b(Therefore,)21 b(e)n(v)o(en)h(though)f(we)i(could)f(ha)n(v)o(e)g
(designed)440 886 y(LiS)e(to)g(support)e(just)i(the)g(STREAMS)g(interf)
o(ace,)e(we)i(also)g(tried)f(to)h(follo)n(w)f(its)i(design.)j(If)19
b(SVr4)440 986 y(STREAMS)24 b(code)g(had)f(been)g(a)n(v)n(ailable,)h
(the)g(project)f(could)g(ha)n(v)o(e)g(been)g(reduced)g(to)h(a)g(simple)
440 1086 y(port.)40 b(As)27 b(a)f(result,)g(the)g(design)f(guide)f(w)o
(as)i(a)g(mixture)f(of)g(a)h(couple)e(of)i(books)e(sho)n(wing)g(ho)n(w)
440 1185 y(STREAMS)d(w)o(ork)e([2)o(,)i(4)o(].)565 1285
y(A)-6 b(v)n(ailability)16 b(of)i(source)f(code)g(for)g(the)h(Linux)f
(k)o(ernel)f(w)o(as)j(crucial,)f(as)g(LiS)g(requires)f(\(small\))440
1384 y(changes)i(to)i(e)o(xisting)e(k)o(ernel)g(subsystems.)565
1484 y(Starting)g(from)g(scratch,)g(our)g(aim)h(w)o(as)h(to)f(mak)o(e)f
(LiS)h(portable)f(so)h(that)g(other)f(people)g(could)440
1584 y(a)n(v)n(oid)h(re)n(writing)f(it)i(for)f(running)e(on)i(dif)n
(ferent)f(systems.)26 b(By)21 b(replacing)e(a)i(single)f(\(small\))g
(mod-)440 1683 y(ule)i(the)g(whole)g(frame)n(w)o(ork)e(can)h(be)h
(ported)f(to)h(dif)n(ferent)f(operating)f(systems.)31
b(LiS)22 b(portability)440 1783 y(is)k(demonstrated)d(by)i(the)g(f)o
(act)h(that)f(Gcom)g(has)g(ported)f(it)i(to)f(QNX.)g(Ports)h(for)e(BSD)
j(UNIXes)440 1883 y(and)20 b(e)n(v)o(ent)f(NT)h(could)g(be)g(af)n
(forded)e(without)h(much)g(ef)n(fort)g(in)i(the)f(future.)440
2163 y Fo(LiS)30 b(featur)n(es)g(and)g(implementation)440
2348 y Fn(A)19 b(complete)e(STREAMS)h(description)f(w)o(ould)g(be)i
(too)e(lar)o(ge)h(for)f(this)i(article.)24 b(Some)18
b(suggested)440 2448 y(books)k(that)h(you)f(might)g(look)g(at)h(to)g
(learn)g(more)f(about)f(STREAMS)j(can)e(be)h(those)g(mentioned)440
2548 y(before)c([4)o(,)h(1].)25 b(In)20 b(fe)n(w)g(w)o(ords,)g(we)g
(could)g(say)g(that)g(LiS)h(features)e(include:)565 2714
y Fj(\017)41 b Fn(Support)18 b(for)i(typical)g(STREAMS)g(modules)f(and)
h(dri)n(v)o(ers,)565 2880 y Fj(\017)41 b Fn(Ability)20
b(to)g(use)g(binary-only)e(dri)n(v)o(ers,)g(and)565 3046
y Fj(\017)41 b Fn(con)m(v)o(enient)17 b(deb)n(ugging)h(f)o(acilities.)
440 3283 y Fd(T)-7 b(ypical)25 b(STREAMS)h(facilities)440
3439 y Fn(There)20 b(are)g(man)o(y)f(similarities)i(between)e(the)i
(implementation)d(of)i(LiS)h(and)e(SVr4)i(STREAMS.)440
3539 y(This)k(is)g(because)f(initial)h(project)e(members)h(follo)n(wed)
f(the)h(\223Magic)g(Garden\224)g([2)o(])g(as)i(a)f(design)440
3638 y(guideline.)36 b(Current)24 b(maintainers)f(were)h(also)h(hea)n
(vily)e(in\003uenced)g(by)h(SVr4)g(STREAMS)h(be-)440
3738 y(cause)e(the)o(y)f(ha)n(v)o(e)h(been)f(writing)g(STREAMS)i(dri)n
(v)o(ers)d(for)i(SVr4)f(since)i(1990.)31 b(So,)24 b(the)f(stream)440
3837 y(head)18 b(structure,)f(queue)g(structure,)h(message)g
(structure,)f(etc.)25 b(all)19 b(follo)n(w)f(the)g(SVr4)g(model.)23
b(Y)-9 b(ou)440 3937 y(can)18 b(enjo)o(y)f(reading)f(the)i(Magic)f
(Garden)g(chapter)g(on)g(STREAMS)h(while)g(bro)n(wsing)e(LiS)j(source)
440 4037 y(code)h(in)g(your)f(f)o(a)n(v)n(orite)h(\(read)f
Fp(Emacs)6 b Fn(\))20 b(editor)1813 4007 y Fi(2)1846
4037 y Fn(.)565 4136 y(But)i(dif)n(ferences)f(do)g(e)o(xist.)31
b(SVr4)22 b(disallo)n(ws)g(STREAMS)h(multiple)o(xors)d(to)i(use)h(the)f
(same)440 4236 y(dri)n(v)o(er)d(at)j(more)e(than)h(one)f(le)n(v)o(el)g
(of)h(the)g(stack.)27 b(F)o(or)21 b(e)o(xample,)f(if)h(we)g(had)g(a)g
(STREAMS)g(multi-)440 4336 y(ple)o(xor)d(dri)n(v)o(er)g(called)h
(\223DLPI\224)h(and)f(another)f(one)h(called)g(\223NPI\224)h(the)f
(SVr4)h(STREAMS)g(w)o(ould)440 4435 y(disallo)n(w)35
b(the)g(stack:)56 b(NPI\(SN)m(A\))p Fj($)p Fn(DLPI\(QLLC\))p
Fj($)p Fn(NPI\(X.25\))p Fj($)p Fn(DLPI\(LAPB\).)30 b(LiS)36
b(al-)440 4535 y(lo)n(ws)22 b(these)g(combinations)e(since)i(we)g
(could)f(not)h(see)g(an)o(y)f(harm)g(that)h(w)o(ould)f(come)g(from)g
(such)440 4634 y(con\002gurations.)565 4734 y(The)14
b(con\002guration)f(\002le)j(used)f(for)f(LiS)i(is)g(modelled)e(after)h
(the)g(SVr4)g Fl(sdevice)j Fn(and)d Fl(mdevice)440 4834
y Fn(\002les.)25 b(Ho)n(we)n(v)o(er)m(,)17 b(LiS)h(syntax)g(is)h(dif)n
(ferent)e(and)g(combines)g(into)h(a)h(single)f(\002le)h(the)f
(functions)f(that)440 4933 y(SVr4)30 b(used)h(tw)o(o)f(\002les)i(to)e
(specify)-5 b(.)55 b(The)30 b(LiS)h(b)n(uild)f(process)g(\(mak)o
(e\002les\))g(allo)n(w)h(indi)n(vidual)440 5033 y(dri)n(v)o(ers)20
b(to)g(ha)n(v)o(e)h(their)f(o)n(wn)g(con\002g)g(\002le.)27
b(The)o(y)20 b(all)h(get)g(combined)e(into)h(one)h(master)f(con\002g)g
(\002le)440 5133 y(which)g(is)h(then)f(used)f(to)i(con\002gure)d(LiS)j
(at)g(b)n(uild)e(time.)p 440 5204 1146 4 v 531 5259 a
Fh(2)560 5283 y Fg(Da)o(v)o(e)e(says)g Fc(vi)1851 5662
y Fn(5)p eop
%%Page: 6 6
6 5 bop 565 531 a Fn(In)28 b(SVr4)g(the)h(STREAMS)g(e)o(x)o(ecuti)n(v)o
(e)d(is)k(a)f(linkable)e(package)g(for)h(the)h(k)o(ernel.)49
b(It)29 b(is)g(not)440 631 y(hard)23 b(wired)h(into)f(the)h(k)o(ernel.)
36 b(W)m(ith)24 b(LiS,)g(the)g(STREAMS)h(e)o(x)o(ecuti)n(v)o(e)d(is)j
(actually)e(a)h(run)g(time)440 731 y(loadable)19 b(module)g(of)h(the)g
(k)o(ernel,)f(one)h(step)g(more)g(dynamic)e(than)i(SVr4)g(STREAMS.)565
830 y(A)15 b(quick)g(and)f(summary)g(o)o(v)o(ervie)n(w)f(of)i(the)g
(LiS)h(implementation)d(w)o(ould)h(re)n(v)o(eal)h(a)g(STREAM)440
930 y(as)20 b(a)g(full-duple)o(x)c(chain)j(of)g(modules)f(\(see)i
(\002gure)e(4\).)25 b(Each)18 b(one)h(consists)h(of)f(a)h(queue)e(pair)
m(,)g(one)440 1029 y(for)25 b(data)g(being)g(read)g(and)g(another)f
(one)g(for)h(data)h(being)e(written.)41 b(Each)25 b(module)f(has)h(se)n
(v)o(eral)440 1129 y(data)g(structures)f(pro)o(viding)e(those)i
(operations)f(\(i.e.)39 b(functions\))23 b(needed)g(as)j(well)f(as)g
(statistics)440 1229 y(and)20 b(other)f(data.)565 1328
y(Module)24 b(operations)h(are)g(pro)o(vided)f(by)h(the)h(programmer)d
(and)j(include)e(procedures)g(used)440 1428 y(to)e(process)g(upstream)f
(and)h(do)n(wnstream)e(messages.)31 b(Messages)23 b(can)f(be)g(queued)e
(for)i(deferred)440 1528 y(processing)g(as)i(LiS)g(guarantees)e(to)i
(call)f(service)h(procedures)d(when)i(queued)e(messages)j(could)440
1627 y(be)c(processed.)565 1727 y(Most)f(of)f(the)h(LiS)h
(implementation)d(deals)i(with)g(these)g(queues)f(and)h(also)g(with)g
(the)g(message)440 1826 y(data)26 b(structures)g(used)g(to)g(send)g
(data)g(through)e(the)j(STREAM.)f(Messages)h(carry)e(a)i(type)f(code)
440 1926 y(and)f(are)g(made)g(of)h(one)f(or)g(more)g(message)g(blocks.)
40 b(Only)25 b(pointers)g(to)h(messages)f(are)h(passed)440
2026 y(from)19 b(one)h(module)f(to)h(the)g(ne)o(xt,)f(so)i(there)f(is)h
(no)f(data)g(cop)o(y)f(o)o(v)o(erhead.)573 3654 y @beginspecial
0 @llx 0 @lly 387 @urx 225 @ury 3118 @rwi @setspecial
%%BeginDocument: fig/queues.eps
/$F2psDict 200 dict def 
$F2psDict begin
$F2psDict /mtrx matrix put
/l {lineto} bind def
/m {moveto} bind def
/s {stroke} bind def
/n {newpath} bind def
/gs {gsave} bind def
/gr {grestore} bind def
/clp {closepath} bind def
/graycol {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
4 -2 roll mul setrgbcolor} bind def
/col-1 {} def
/col0 {0 0 0 setrgbcolor} bind def
/col1 {0 0 1 setrgbcolor} bind def
/col2 {0 1 0 setrgbcolor} bind def
/col3 {0 1 1 setrgbcolor} bind def
/col4 {1 0 0 setrgbcolor} bind def
/col5 {1 0 1 setrgbcolor} bind def
/col6 {1 1 0 setrgbcolor} bind def
/col7 {1 1 1 setrgbcolor} bind def
	end
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
0 setlinecap 0 setlinejoin
-4.0 261.0 translate 0.900 -0.900 scale
0.500 setlinewidth
% Polyline
n 166 86 m 166 51 l  86 51 l  86 86 l 
 clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
97 74 m 
gs 1 -1 scale (RD\(queue\)) col-1 show gr
% Polyline
n 246 86 m 246 51 l  166 51 l  166 86 l 
 clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
176 74 m 
gs 1 -1 scale (WR\(queue\)) col-1 show gr
	1 setlinecap [1 3.000000] 3.000000 setdash
% Polyline
n 76 39 m 69 39 69 92 7 arcto 4 {pop} repeat 69 99 257 99 7 arcto 4 {pop} repeat 264 99 264 46 7 arcto 4 {pop} repeat 264 39 76 39 7 arcto 4 {pop} repeat clp gs col-1 s gr
	[] 0 setdash 0 setlinecap
% Polyline
n 166 276 m 166 241 l  86 241 l  86 276 l 
 clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
97 264 m 
gs 1 -1 scale (RD\(queue\)) col-1 show gr
% Polyline
n 246 276 m 246 241 l  166 241 l  166 276 l 
 clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
176 264 m 
gs 1 -1 scale (WR\(queue\)) col-1 show gr
	1 setlinecap [1 3.000000] 3.000000 setdash
% Polyline
n 76 229 m 69 229 69 282 7 arcto 4 {pop} repeat 69 289 257 289 7 arcto 4 {pop} repeat 264 289 264 236 7 arcto 4 {pop} repeat 264 229 76 229 7 arcto 4 {pop} repeat clp gs col-1 s gr
	[] 0 setdash 0 setlinecap
% Polyline
n 166 181 m 166 146 l  86 146 l  86 181 l 
 clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
97 169 m 
gs 1 -1 scale (RD\(queue\)) col-1 show gr
% Polyline
n 246 181 m 246 146 l  166 146 l  166 181 l 
 clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
176 169 m 
gs 1 -1 scale (WR\(queue\)) col-1 show gr
	1 setlinecap [1 3.000000] 3.000000 setdash
% Polyline
n 76 134 m 69 134 69 187 7 arcto 4 {pop} repeat 69 194 257 194 7 arcto 4 {pop} repeat 264 194 264 141 7 arcto 4 {pop} repeat 264 134 76 134 7 arcto 4 {pop} repeat clp gs col-1 s gr
	[] 0 setdash 0 setlinecap
% Polyline
n 344 89 m 344 59 l  304 59 l  304 89 l 
 clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
313 80 m 
gs 1 -1 scale (qinit) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
321 147 m 
gs 1 -1 scale (info) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
313 134 m 
gs 1 -1 scale (module) col-1 show gr
% Polyline
n 359 154 m 359 119 l  304 119 l  304 154 l 
 clp gs col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
396 148 m 
gs 1 -1 scale (stat) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
388 135 m 
gs 1 -1 scale (module) col-1 show gr
% Polyline
n 434 154 m 434 119 l  379 119 l  379 154 l 
 clp gs col-1 s gr
% Polyline
n 204 84 m 204 139 l gs col-1 s gr
n 206.000 131.000 m 204.000 139.000 l 202.000 131.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 204 179 m 204 234 l gs col-1 s gr
n 206.000 226.000 m 204.000 234.000 l 202.000 226.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 119 239 m 119 184 l gs col-1 s gr
n 117.000 192.000 m 119.000 184.000 l 121.000 192.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 119 144 m 119 89 l gs col-1 s gr
n 117.000 97.000 m 119.000 89.000 l 121.000 97.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 249 264 m 279 264 l gs col-1 s gr
n 271.000 262.000 m 279.000 264.000 l 271.000 266.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 249 169 m 279 169 l gs col-1 s gr
n 271.000 167.000 m 279.000 169.000 l 271.000 171.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 249 74 m 299 74 l gs col-1 s gr
n 291.000 72.000 m 299.000 74.000 l 291.000 76.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 319 89 m 319 119 l gs col-1 s gr
n 321.000 111.000 m 319.000 119.000 l 317.000 111.000 l gs 2 setlinejoin col-1 s gr
% Polyline
n 319 89 m 404 114 l gs col-1 s gr
n 396.889 109.824 m 404.000 114.000 l 395.761 113.661 l gs 2 setlinejoin col-1 s gr
/Times-Roman findfont 12.00 scalefont setfont
209 122 m 
gs 1 -1 scale (q_next) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
124 217 m 
gs 1 -1 scale (q_next) col-1 show gr
/Times-Italic findfont 12.00 scalefont setfont
29 259 m 
gs 1 -1 scale (Driver) col-1 show gr
/Times-Italic findfont 12.00 scalefont setfont
29 164 m 
gs 1 -1 scale (Module) col-1 show gr
/Times-Italic findfont 12.00 scalefont setfont
4 54 m 
gs 1 -1 scale (Stream head) col-1 show gr
/Times-Roman findfont 12.00 scalefont setfont
269 69 m 
gs 1 -1 scale (q_info) col-1 show gr
$F2psEnd
%%EndDocument
 @endspecial 1334 3837 a(Figure)g(4:)25 b(Queues)20 b(in)g(a)h(STREAM)
565 4119 y(The)f(head)h(of)g(the)g(STREAM)h(is)g(another)e(interesting)
g(piece)h(of)g(softw)o(are.)28 b(In)21 b(\002gure)f(5)i(you)440
4219 y(can)g(see)g(ho)n(w)f(it)h(gets)g(reached)f(from)f(the)i(Linux)f
(VFS)2054 4189 y Fi(3)2111 4219 y Fn(layer)g(\(the)h(one)f(interf)o
(acing)f(the)i(k)o(ernel)440 4318 y(with)e(\002le)h(systems\).)565
4418 y(F)o(or)d(an)h(actual)g(description)e(of)i(the)g(implementation)e
(you)h(are)h(in)m(vited)f(to)h(either)f(read)h(chap-)440
4518 y(ter)i(7)f(of)g(the)h(Magic)f(Garden)f([2)o(])i(or)f(to)h(w)o
(ait)g(for)f(future)f(articles)i(describing)e(LiS)i(implementa-)440
4617 y(tion)f(details.)440 4855 y Fd(Binary-only)25 b(dri)o(v)o(ers)440
5010 y Fn(LiS)h(also)g(mak)o(es)g(pro)o(vision)e(for)h(binary-only)d
(dri)n(v)o(ers)j(to)h(be)g(link)o(ed)f(in)g(with)h(it.)43
b(This)26 b(allo)n(ws)440 5110 y(companies)d(which)h(ha)n(v)o(e)f
(proprietary)f(dri)n(v)o(ers,)h(such)h(as)h(Gcom,)g(to)f(port)g(their)f
(dri)n(v)o(er)g(code)h(to)p 440 5181 1146 4 v 531 5237
a Fh(3)560 5261 y Fg(Linux)19 b(does)h(not)g(ha)o(v)o(e)g(a)g(clean)h
(and)f(isolated)i(VFS)d(layer)l(.)29 b(Ho)n(we)n(v)o(er)m(,)22
b(Linux)e(i-nodes)g(are)h(v-nodes)f(in)g(spirit)g(and)440
5340 y(its)d(\002le)h(system)f(interf)o(ace)j(could)e(be)g(considered)h
(to)e(be)h(a)f(VFS.)1851 5662 y Fn(6)p eop
%%Page: 7 7
7 6 bop 927 2277 a @beginspecial 0 @llx 0 @lly 277 @urx
268 @ury 2267 @rwi @setspecial
%%BeginDocument: fig/strhd.eps
%Magnification: 1.00
/$F2psDict 200 dict def
$F2psDict begin
$F2psDict /mtrx matrix put
/col-1 {0 setgray} bind def
/col0 {0.000 0.000 0.000 srgb} bind def
/col1 {0.000 0.000 1.000 srgb} bind def
/col2 {0.000 1.000 0.000 srgb} bind def
/col3 {0.000 1.000 1.000 srgb} bind def
/col4 {1.000 0.000 0.000 srgb} bind def
/col5 {1.000 0.000 1.000 srgb} bind def
/col6 {1.000 1.000 0.000 srgb} bind def
/col7 {1.000 1.000 1.000 srgb} bind def
/col8 {0.000 0.000 0.560 srgb} bind def
/col9 {0.000 0.000 0.690 srgb} bind def
/col10 {0.000 0.000 0.820 srgb} bind def
/col11 {0.530 0.810 1.000 srgb} bind def
/col12 {0.000 0.560 0.000 srgb} bind def
/col13 {0.000 0.690 0.000 srgb} bind def
/col14 {0.000 0.820 0.000 srgb} bind def
/col15 {0.000 0.560 0.560 srgb} bind def
/col16 {0.000 0.690 0.690 srgb} bind def
/col17 {0.000 0.820 0.820 srgb} bind def
/col18 {0.560 0.000 0.000 srgb} bind def
/col19 {0.690 0.000 0.000 srgb} bind def
/col20 {0.820 0.000 0.000 srgb} bind def
/col21 {0.560 0.000 0.560 srgb} bind def
/col22 {0.690 0.000 0.690 srgb} bind def
/col23 {0.820 0.000 0.820 srgb} bind def
/col24 {0.500 0.190 0.000 srgb} bind def
/col25 {0.630 0.250 0.000 srgb} bind def
/col26 {0.750 0.380 0.000 srgb} bind def
/col27 {1.000 0.500 0.500 srgb} bind def
/col28 {1.000 0.630 0.630 srgb} bind def
/col29 {1.000 0.750 0.750 srgb} bind def
/col30 {1.000 0.880 0.880 srgb} bind def
/col31 {1.000 0.840 0.000 srgb} bind def

end
save
-3.0 285.0 translate
1 -1 scale

/cp {closepath} bind def
/ef {eofill} bind def
/gr {grestore} bind def
/gs {gsave} bind def
/sa {save} bind def
/rs {restore} bind def
/l {lineto} bind def
/m {moveto} bind def
/rm {rmoveto} bind def
/n {newpath} bind def
/s {stroke} bind def
/sh {show} bind def
/slc {setlinecap} bind def
/slj {setlinejoin} bind def
/slw {setlinewidth} bind def
/srgb {setrgbcolor} bind def
/rot {rotate} bind def
/sc {scale} bind def
/sd {setdash} bind def
/ff {findfont} bind def
/sf {setfont} bind def
/scf {scalefont} bind def
/sw {stringwidth} bind def
/tr {translate} bind def
/tnt {dup dup currentrgbcolor
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add srgb}
  bind def
/shd {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
  4 -2 roll mul srgb} bind def
 /DrawSplineSection {
	/y3 exch def
	/x3 exch def
	/y2 exch def
	/x2 exch def
	/y1 exch def
	/x1 exch def
	/xa x1 x2 x1 sub 0.666667 mul add def
	/ya y1 y2 y1 sub 0.666667 mul add def
	/xb x3 x2 x3 sub 0.666667 mul add def
	/yb y3 y2 y3 sub 0.666667 mul add def
	x1 y1 lineto
	xa ya xb yb x3 y3 curveto
	} def

/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
10 setmiterlimit
n 0 792 m 0 0 l 612 0 l 612 792 l cp clip
 0.06000 0.06000 sc
7.500 slw
% Polyline
n 3180 3105 m 3180 2580 l 1980 2580 l 1980 3105 l cp gs col-1 s gr 
/Times-Roman ff 180.00 scf sf
2145 2925 m
gs 1 -1 sc (RD\(queue\)) col-1 sh gr
% Polyline
n 4380 3105 m 4380 2580 l 3180 2580 l 3180 3105 l cp gs col-1 s gr 
/Times-Roman ff 180.00 scf sf
3330 2925 m
gs 1 -1 sc (WR\(queue\)) col-1 sh gr
% Polyline
 [15 50.0] 50.0 sd
n 1830 2400 m 1725 2400 1725 3195 105 arcto 4 {pop} repeat
  1725 3300 4545 3300 105 arcto 4 {pop} repeat
  4650 3300 4650 2505 105 arcto 4 {pop} repeat
  4650 2400 1830 2400 105 arcto 4 {pop} repeat
 cp gs col-1 s gr  [] 0 sd
% Polyline
n 3180 4530 m 3180 4005 l 1980 4005 l 1980 4530 l cp gs col-1 s gr 
/Times-Roman ff 180.00 scf sf
2145 4350 m
gs 1 -1 sc (RD\(queue\)) col-1 sh gr
% Polyline
n 4380 4530 m 4380 4005 l 3180 4005 l 3180 4530 l cp gs col-1 s gr 
/Times-Roman ff 180.00 scf sf
3330 4350 m
gs 1 -1 sc (WR\(queue\)) col-1 sh gr
% Polyline
 [15 50.0] 50.0 sd
n 1830 3825 m 1725 3825 1725 4620 105 arcto 4 {pop} repeat
  1725 4725 4545 4725 105 arcto 4 {pop} repeat
  4650 4725 4650 3930 105 arcto 4 {pop} repeat
  4650 3825 1830 3825 105 arcto 4 {pop} repeat
 cp gs col-1 s gr  [] 0 sd
% Polyline
gs  clippath
3788 3741 m 3750 3875 l 3713 3741 l 3713 3915 l 3788 3915 l  cp clip
n 3750 3075 m 3750 3900 l gs col-1 s gr gr

% arrowhead
n 3788 3741 m 3750 3875 l 3713 3741 l  col-1 s
% Polyline
gs  clippath
2438 3309 m 2475 3174 l 2513 3309 l 2513 3135 l 2438 3135 l  cp clip
n 2475 3975 m 2475 3150 l gs col-1 s gr gr

% arrowhead
n 2438 3309 m 2475 3174 l 2513 3309 l  col-1 s
/Times-Roman ff 180.00 scf sf
3825 3645 m
gs 1 -1 sc (q_next) col-1 sh gr
% Polyline
n 2850 1500 m 2850 1125 l 2100 1125 l 2100 1500 l cp gs col-1 s gr 
/Times-Roman ff 180.00 scf sf
2235 1380 m
gs 1 -1 sc (stdata) col-1 sh gr
% Polyline
n 900 600 m 900 300 l 600 300 l 600 600 l cp gs col-1 s gr 
% Polyline
n 1200 600 m 1200 300 l 900 300 l 900 600 l cp gs col-1 s gr 
% Polyline
n 600 600 m 600 300 l 300 300 l 300 600 l cp gs col-1 s gr 
% Polyline
n 150 300 m 1350 300 l gs col-1 s gr 
% Polyline
n 150 600 m 1500 600 l gs col-1 s gr 
% Polyline
n 1350 300 m 1500 375 l 1350 375 l 1500 600 l gs col-1 s gr 
% Polyline
n 150 600 m 225 525 l 75 375 l 150 300 l gs col-1 s gr 
% Polyline
gs  clippath
1866 1313 m 2000 1350 l 1866 1388 l 2040 1388 l 2040 1313 l  cp clip
n 1125 1350 m 2025 1350 l gs col-1 s gr gr

% arrowhead
n 1866 1313 m 2000 1350 l 1866 1388 l  col-1 s
% Polyline
 [15 50.0] 50.0 sd
n 150 2100 m 1200 2100 l 2100 675 l 3075 675 l gs col-1 s gr  [] 0 sd
% Polyline
n 1125 1500 m 1125 1125 l 375 1125 l 375 1500 l cp gs col-1 s gr 
% Polyline
 [15 50.0] 50.0 sd
gs  clippath
705 903 m 675 1023 l 645 903 l 645 1065 l 705 1065 l  cp clip
n 675 450 m 675 1050 l gs col-1 s gr gr
 [] 0 sd
% arrowhead
n 705 903 m 675 1023 l 645 903 l  col-1 s
% Open spline
gs  clippath
3823 2161 m 3819 2301 l 3750 2180 l 3792 2349 l 3865 2330 l  cp clip
n 2850.0 1350.0 m 3262.5 1537.5 l
	3262.5 1537.5 3675.0 1725.0 3750.0 2025.0 DrawSplineSection
	3825.0 2325.0 l  gs col-1 s gr
 gr

% arrowhead
n 3823 2161 m 3819 2301 l 3750 2180 l  col-1 s
/Times-Italic ff 180.00 scf sf
675 2925 m
gs 1 -1 sc (Stream head) col-1 sh gr
/Times-Roman ff 180.00 scf sf
3225 2250 m
gs 1 -1 sc (sd_wq) col-1 sh gr
/Times-Bold ff 180.00 scf sf
75 2025 m
gs 1 -1 sc (Linux kernel) col-1 sh gr
/Times-Bold ff 180.00 scf sf
1050 2325 m
gs 1 -1 sc (LiS) col-1 sh gr
/Times-Roman ff 180.00 scf sf
525 1380 m
gs 1 -1 sc (i-node) col-1 sh gr
/Times-Italic ff 180.00 scf sf
750 4350 m
gs 1 -1 sc (driver or) col-1 sh gr
/Times-Italic ff 180.00 scf sf
750 4575 m
gs 1 -1 sc (module) col-1 sh gr
/Times-Roman ff 180.00 scf sf
1275 1275 m
gs 1 -1 sc (generic_ip) col-1 sh gr
/Times-Italic ff 180.00 scf sf
1650 525 m
gs 1 -1 sc (file descriptor entry) col-1 sh gr
$F2psEnd
rs
%%EndDocument
 @endspecial 1376 2459 a Fn(Figure)20 b(5:)25 b(The)20
b(STREAM)g(head)440 2809 y(LiS)f(and)g(distrib)n(ute)f(binaries.)24
b(This)19 b(is)h(an)f(important)e(feature)h(if)h(we)g(e)o(xpect)f
(companies)g(to)h(port)440 2909 y(their)e(e)o(xisting)f(SVr4)g(STREAMS)
i(dri)n(v)o(ers)d(to)i(LiS.)g(The)g(more)f(of)g(these)h(that)g(are)g
(done)f(the)h(more)440 3009 y(the)j(Linux)f(k)o(ernel)h(functionality)e
(is)j(enhanced.)440 3246 y Fd(Deb)n(ug)26 b(facilities)440
3402 y Fn(LiS)17 b(deb)n(ugging)d(features)i(are)h(specially)f(con)m(v)
o(enient)e(and)i(sho)n(w)g(another)f(departure)g(point)h(from)440
3502 y(SVr4.)565 3601 y(Of)24 b(course,)f(those)h(f)o(acilities)h
(include)e(some)g(general)g(purpose)g(deb)n(ug)f(utilities,)k(lik)o(e)e
(mes-)440 3701 y(sage)29 b(pretty-printers.)49 b(But)30
b(we)g(are)f(talking)f(about)g(signi\002cant)h(aids)g(such)g(as)h(the)f
(ability)g(to)440 3800 y(selecti)n(v)o(ely)20 b(trace,)f(for)h(e)o
(xample,)e Fl(getmsg)23 b Fn(calls.)j(That)20 b(can)g(really)g(help)f
(with)i(deb)n(ugging.)565 3900 y(The)c(memory)e(allocator)i(k)o(eeps)g
(\002le)h(and)f(line)h(numbers)d(close)j(to)g(allocated)e(memory)g
(areas.)440 4000 y(Combine)22 b(that)h(with)g(the)g(ability)g(to)g
(print)g(out)f(all)i(the)f(in-use)f(memory)f(areas)j(and)e(you)g(ha)n
(v)o(e)g(a)440 4099 y(tool)e(for)g(\002nding)f(memory)f(leaks)i(in)h
(your)e(dri)n(v)o(ers.)565 4199 y(Usage)29 b(statistics)j(are)d
(designed)g(to)h(help,)h(not)f(to)g(o)o(v)o(erload)d(the)j(user)g(with)
g(unuseful)e(in-)440 4299 y(formation.)57 b(The)31 b
Fl(streams)j Fn(command)c(prints)h(out)g(lots)h(of)f(useful)g
(information)e(about)h(LiS)440 4398 y(operation.)i(There)23
b(is)h(e)n(v)o(en)e(a)i(deb)n(ug)e(bitmap)g(to)i(cause)f(LiS)h(to)f
(trigger)f(dif)n(ferent)g(deb)n(ug)g(f)o(acil-)440 4498
y(ities.)46 b(One)26 b(of)h(them)f(is)i(the)f(ability)f(to)h(time)g(v)n
(arious)f(operations)f(using)h(the)h(high)f(resolution)440
4597 y(timer)-5 b(.)26 b(Thus,)20 b(the)h(user)g(can)f(get)h
(\002ne-grain)d(dri)n(v)o(er)i(timings)g(for)g(those)g(dri)n(v)o(ers)g
(using)g(LiS)h(tools)440 4697 y(and)f(with)g(no)g(e)o(xtra)f(code)h(in)
g(the)g(dri)n(v)o(er)-5 b(.)565 4797 y(Last)28 b(b)n(ut)h(not)f(least,)
i(LiS)f(allo)n(ws)g(module)e(deb)n(ugging)e(in)k(user)f(space)g(by)g
(emulating)f(the)440 4896 y(whole)f(STREAMS)g(frame)n(w)o(ork.)41
b(A)26 b(module)f(can)h(thus)g(be)g(easily)g(de)n(v)o(eloped)e(in)i
(user)g(space)440 4996 y(and)g(then)f(do)n(wnloaded)e(into)j(the)g(k)o
(ernel)g(when)f(it)i(w)o(orks.)42 b(That)26 b(is)h(achie)n(v)o(ed)d(by)
i(a)g(\223port\224)f(of)440 5096 y(LiS)c(which)e(runs)h(in)g(user)h
(space)f(on)f(Linux)h(\(in)g(a)g(dummied-up)d(manner\).)565
5195 y(STREAMS)i(modules)e(can)i(be)f(tested)h(by)f(surrounding)e(them)
i(with)h(test)h(modules)d(and)h(then)440 5295 y(dri)n(ving)26
b(kno)n(wn)f(sequences)i(of)g(messages)g(through)e(the)i(module)f
(under)g(test.)47 b(The)27 b(LiS)h(loop)1851 5662 y(7)p
eop
%%Page: 8 8
8 7 bop 440 531 a Fn(dri)n(v)o(er)18 b(is)j(suitable)e(to)h(place)f
(belo)n(w)g(the)h(dri)n(v)o(er)e(being)g(tested)i(as)g(it)h(beha)n(v)o
(es)d(lik)o(e)i(a)g(simple)g(echo)440 631 y(serv)o(er)-5
b(.)25 b(The)19 b(stream)h(head)g(may)g(v)o(ery)f(well)h(be)h(all)f
(that)h(is)g(needed)e(abo)o(v)o(e.)440 911 y Fo(STREAMS)31
b(w)o(orks)f(with)g(Linux)h(TCP/IP)440 1097 y Fn(The)f(whole)g(TCP/IP)h
(stack)g(can)f(be)h(reused,)h(thus)e(TCP/IP)h(performance)d(with)i
(STREAMS)440 1196 y(is)h(a)g(non-issue.)53 b(LiS)31 b(comes)f(with)g
(an)g(adapter)g(dri)n(v)o(er)e(that)j(\002ts)g(belo)n(w)e(standard)g
(Linux)g(IP)440 1296 y(and)22 b(interf)o(aces)f(of)n(f)h(to)g(STREAMS)h
(dri)n(v)o(ers)e(using)g(DLPI.)h(Gcom)g(uses)h(this)f(to)h(interf)o
(ace)e(their)440 1396 y(STREAMS)g(based)e(Frame)h(Relay)h(and)e
(\(soon\))g(X.25.)565 1495 y(Also,)30 b(a)e(contrib)n(uted)e(dri)n(v)o
(er)g(that)i(will)h(be)f(distrib)n(uted)f(with)h(LiS)g(\(sitting)g(in)g
(Da)n(v)o(e')-5 b(s)28 b(\224in)440 1595 y(box\224)20
b(as)i(of)f(this)h(writing\))e(sits)i(on)f(top)g(of)g(an)o(y)f(Linux)g
(MA)m(C)i(dri)n(v)o(er)d(as)j(a)g(client)f(and)g(presents)f(a)440
1694 y(DLPI)k(interf)o(ace)g(abo)o(v)o(e.)35 b(Gcom)23
b(will)i(probably)d(use)i(this)h(dri)n(v)o(er)e(to)h(interf)o(ace)f
(its)j(SN)m(A)f(to)f(the)440 1794 y(Linux)19 b(tok)o(en)h(ring)f(dri)n
(v)o(er)-5 b(.)440 2074 y Fo(LiS)30 b(Licensing)440 2260
y Fn(LiS)20 b(is)h(licensed)e(using)g(the)g(GNU)h(Library)e(Public)i
(License)f(so)h(that)g(companies)e(can)h(port)g(their)440
2359 y(e)o(xisting)28 b(SVr4)g(proprietary)e(STREAMS)k(dri)n(v)o(ers)d
(to)i(LiS)g(and)f(use)h(them)f(in)h(Linux)f(without)440
2459 y(ha)n(ving)16 b(to)g(publish)g(their)h(source)f(code.)23
b(This)17 b(is)g(important)e(if)i(we)g(are)g(to)g(encourage)d
(companies)440 2559 y(to)20 b(support)f(Linux)g(with)i(their)f(\224f)o
(amily)f(je)n(wels\224)i(products.)440 2839 y Fo(Final)31
b(r)n(emarks)440 3024 y Fn(It)20 b(w)o(ould)f(help)g(if)h(support)f
(needed)f(to)i(run)f(LiS)h(could)f(be)g(included)g(in)h(the)f
(mainstream)g(k)o(ernel.)440 3124 y(W)-7 b(e)18 b(are)g(referring)d
(mainly)h(to)i(the)f(ne)n(w)g(system)h(calls)g(and)e(other)h(small)g
Fk(hooks)p Fn(,)g(not)g(to)h(LiS)f(itself.)440 3224 y(That)22
b(w)o(ould)g(mak)o(e)g(it)i(easier)e(for)g(people)g(to)g(do)n(wnload)f
(LiS)i(and)f(install)h(it)g(without)f(ha)n(ving)g(to)440
3323 y(patch)e(the)g(k)o(ernel.)440 3590 y Fo(Refer)n(ences)440
3759 y Fb([1])42 b(Inc.)16 b(A)-8 b(T&T)14 b(UNIX)i(System)g
(Laboratories.)21 b Fa(UNIX)15 b(System)h(V)g(Release)g(4)g(STREAMS)g
(Pr)m(o)o(gr)o(ammer')m(s)569 3850 y(Guide)p Fb(.)27
b(Prentice)18 b(Hall,)g(Engle)n(w)o(ood)j(Clif)n(fs,)d(NJ)g(\(USA\),)g
(1990.)440 3975 y([2])42 b(GoodHeart)19 b(and)h(Cox.)27
b Fa(The)19 b(Ma)o(gic)h(Gar)m(den)g(Explained)f Fb(.)27
b(Prentice-Hall,)18 b(1993.)440 4100 y([3])42 b(D.)19
b(Presotto.)29 b(Multiprocessor)21 b(Streams)e(for)g(Plan)h(9.)29
b(In)20 b Fa(Pr)m(oceedings)g(of)g(the)g(Summer)g(1990)h(Conf)o(.)p
Fb(,)569 4191 y(London,)e(England,)h(1990.)g(UKUUG.)440
4315 y([4])42 b(S.)18 b(A.)g(Rago.)27 b Fa(UNIX)18 b(System)h(V)g
(Network)g(Pr)m(o)o(gr)o(amming)p Fb(.)27 b(Addison)20
b(W)-6 b(esle)o(y)h(,)19 b(??)440 4440 y([5])42 b(Dennis)36
b(M.)h(Ritchie.)82 b(A)36 b(Stream)g(Input-Output)h(System.)82
b Fa(A)m(T&T)35 b(Bell)h(Labor)o(atories)h(T)-7 b(ec)o(h-)569
4531 y(nical)43 b(J)n(ournal)p Fb(,)49 b(63\(8\):1897\2261910,)j
(October)43 b(1984.)105 b(Also)42 b(a)o(v)n(ailable)h(from)g
(http://cm.bell-)569 4623 y(labs.com/cm/cs/who/dmr/st.html.)1851
5662 y Fn(8)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
