%PDF-1.3
%âãÏÓ
2 0 obj
<<
/Length 4700
>>
stream
BT
/TT2 1 Tf
12 0 0 12 171.342 669 Tm
0 g
/GS1 gs
0 Tc
0 Tw
[(Intr)18(oducción a Sistemas Operati)10(v)10(os: Ficher)18(os)]TJ
/TT4 1 Tf
10 0 0 10 241.08 633 Tm
[(F)55(r)55( )210(ancisco J Ballester)45(os)]TJ
/TT2 1 Tf
-16.908 -4.8 TD
0.25 Tw
(1. Entrada/Salida)Tj
/TT6 1 Tf
0 -1.56 TD
0.0988 Tw
(Es importante saber cómo utilizar )Tj
/TT7 1 Tf
14.2396 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0988 Tw
(cheros. En UNIX, es aún más importante dado que gran parte de los)Tj
-14.7958 -1.2 TD
0.0735 Tw
[(recursos, dispositi)25(v)20(o)0(s)-323.5(y)-323.5(abstracciones del sistema aparentan ser )]TJ
/TT7 1 Tf
26.064 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0736 Tw
(cheros. Por ejemplo, el teclado, la salida)Tj
-26.6202 -1.2 TD
0.049 Tw
[(de te)15(xto en la pantalla, las cone)15(xiones de red, una impresora USB..., casi todo es un )]TJ
/TT7 1 Tf
34.4118 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.049 Tw
(chero o se comporta)Tj
-34.968 -1.2 TD
0 Tw
(como tal.)Tj
0 -2.4 TD
0.0151 Tw
[(Antes de UNIX la mayoría de los sistemas utilizaban abstracciones diferentes para cada dispositi)25(v)20(o)20( )-20.1(\(para el)]TJ
0 -1.2 TD
0.2369 Tw
(teclado, la impresora, etc.\). Una de las razones por las que UNIX se hizo popular es que utilizó la)Tj
T*
0 Tw
(abstracción)Tj
/TT8 1 Tf
4.8364 0 TD
(Þ)Tj
/TT4 1 Tf
0.5 0 TD
[(c)15(her)45(o)]TJ
/TT6 1 Tf
2.5001 0 TD
0.0332 Tw
[(como interf)10(az para todos ellos. Eso permite utilizar los comandos y llamadas al sistema)]TJ
-7.8365 -1.2 TD
0.0598 Tw
(que operan en )Tj
/TT7 1 Tf
6.0378 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0598 Tw
[(cheros para operar en casi cualquier dispositi)25(v)20(o)0(.)-309.8(¡Al contrario que en MS-DOS y en W)40(in-)]TJ
-6.594 -1.2 TD
0 Tw
[(do)25(ws aunque estos sistemas sean posteriores!)]TJ
0 -2.4 TD
0.0299 Tw
(En cuanto a )Tj
/TT7 1 Tf
5.0599 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0299 Tw
[(cheros contenidos en un disco, normalmente el disco se suele di)25(vidir en trozos más pequeños)]TJ
-5.6161 -1.2 TD
0.0946 Tw
(llamados particiones. Cada partición no es muy diferente a un disco: es una secuencia de bloques siendo)Tj
T*
0.0907 Tw
(cada bloque un array de bytes \(normalmente de 512 bytes, 1KiB, 8KiB o 16KiB\). UNIX guarda en cada)Tj
T*
0.1114 Tw
(partición estructuras de datos para implementar los )Tj
/TT7 1 Tf
21.4116 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1114 Tw
(cheros. Se suele llamar)Tj
/TT2 1 Tf
9.9143 0 TD
0.1113 Tw
(sistema de )Tj
/TT9 1 Tf
4.8886 0 TD
0 Tw
(Þ)Tj
/TT2 1 Tf
0.5562 0 TD
[(cher)18(os)]TJ
/TT6 1 Tf
3.1202 0 TD
0.1113 Tw
(al pro-)Tj
-40.447 -1.2 TD
0.023 Tw
(grama que implementa esa abstracción, el)Tj
/TT8 1 Tf
17.1028 0 TD
0 Tw
(Þ)Tj
/TT4 1 Tf
0.5 0 TD
[(c)15(her)45(o)]TJ
/TT6 1 Tf
2.2169 0 TD
0.0231 Tw
[(,)-273(que suele ser parte del k)10(ernel. Cuando das formato a una)]TJ
-19.8197 -1.2 TD
0.0201 Tw
(partición para guardar )Tj
/TT7 1 Tf
9.1389 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0201 Tw
(cheros, determinas el tipo de sistema de )Tj
/TT7 1 Tf
16.3023 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.02 Tw
[(cheros que creas. V)111(eremos más sobre sis-)]TJ
-26.5535 -1.2 TD
0 Tw
(temas de )Tj
/TT7 1 Tf
3.7764 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(cheros más adelante.)Tj
-4.3325 -2.4 TD
0.0627 Tw
(En realidad ya conoces mucho sobre )Tj
/TT7 1 Tf
15.2595 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0627 Tw
[(cheros. En cursos pre)25(vios has utilizado la librería de tu lenguaje de)]TJ
-15.8157 -1.2 TD
0.1155 Tw
[(programación para abrir)40(,)-365.6(leer y escribir )]TJ
/TT7 1 Tf
16.562 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1155 Tw
(cheros. Y probablemente encontrases problemas que te costaba)Tj
-17.1181 -1.2 TD
0.0578 Tw
[(e)15(xplicar)55(.)-307.8(Ahora v)25(amos a utilizar el interf)10(az suministrado por UNIX para manipular )]TJ
/TT7 1 Tf
33.994 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0579 Tw
(cheros, que es casi el)Tj
-34.5501 -1.2 TD
0.0175 Tw
[(interf)10(az uni)25(v)15(ersal en todos los sistemas operati)25(v)20(os, y v)15(erás cómo desaparecen los problemas tanto en UNIX)]TJ
T*
0 Tw
(como al usar cualquier otro lenguaje.)Tj
0 -2.4 TD
(Considera)Tj
/TT11 1 Tf
4.403 0 TD
(printf)Tj
/TT6 1 Tf
3.6006 0 TD
0.0983 Tw
[(.)-348.3(E)0(s)-348.3(una función de librería documentada en)]TJ
/TT4 1 Tf
18.641 0 TD
0 Tw
(printf\(3\))Tj
/TT6 1 Tf
3.7371 0 TD
0.0984 Tw
[(que imprime mensajes con for)20(-)]TJ
-30.3816 -1.2 TD
0.0858 Tw
(mato. Escribe siempre en un )Tj
/TT7 1 Tf
12.0364 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0858 Tw
(chero ¡incluso cuando escribes en la pantalla! y para ello llama a)Tj
/TT4 1 Tf
27.1292 0 TD
0 Tw
(write\(2\))Tj
/TT6 1 Tf
3.2217 0 TD
(.)Tj
-42.9435 -1.2 TD
[(V)111(eamos un programa...)]TJ
0 -22.14 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
3 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT8 8 0 R
/TT9 9 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
14 0 obj
<<
/Length 6779
>>
stream
BT
/TT6 1 Tf
10 0 0 10 282.17 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-2-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(#include <stdio.h>)Tj
0 -1.5 TD
(#include <stdlib.h>)Tj
T*
(#include <unistd.h>)Tj
T*
(#include <err.h>)Tj
T*
(#include <string.h>)Tj
0 -3 TD
(int)Tj
0 -1.5 TD
(main\(int argc, char* argv[]\))Tj
T*
({)Tj
2.4 -1.5 TD
1.8 Tw
[(char msg[])-600(=)-600("hello\\n";)]TJ
T*
[(int n,)-600(nw;)]TJ
0 -3 TD
0 Tw
[(n)-600(=)-600(strlen\(msg\);)]TJ
0 -1.5 TD
(nw = write\(1, msg, n\);)Tj
T*
(if \(nw != n\) {)Tj
2.4 -1.5 TD
(err\(1, "write"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(exit\(0\);)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 462 Tm
0.1093 Tw
[(Es algo más elaborado de lo que podría ser)55(.)-359.3(E)0(l)-359.3(mensaje)]TJ
/TT11 1 Tf
23.4735 0 TD
0 Tw
(msg)Tj
/TT6 1 Tf
2.1596 0 TD
0.1093 Tw
(lo guardamos en un array de caracteres en)Tj
-25.6331 -1.2 TD
-0.0003 Tc
0.1353 Tw
(lugar de utilizar)Tj
/TT11 1 Tf
6.9806 0 TD
0 Tc
0 Tw
("hello\\n")Tj
/TT6 1 Tf
5.7859 0 TD
0.1349 Tw
[(directamente para que puedas v)15(er lo que hace)]TJ
/TT11 1 Tf
19.4993 0 TD
0 Tw
(write)Tj
/TT6 1 Tf
3.3854 0 TD
0.1349 Tw
(lo más claramente)Tj
-35.6511 -1.2 TD
0 Tw
[(posible. V)111(amos a ejecutarlo:)]TJ
/TT11 1 Tf
8 0 0 8 133 420 Tm
(unix$ write)Tj
0 -1.5 TD
(hello)Tj
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 378 Tm
(¡Hace lo mismo que si utilizamos)Tj
/TT11 1 Tf
13.6641 0 TD
(printf\("hello\\n"\))Tj
/TT6 1 Tf
10.4517 0 TD
(o)Tj
/TT11 1 Tf
0.75 0 TD
(puts\("hello"\))Tj
/TT6 1 Tf
7.8013 0 TD
(!)Tj
-32.667 -2.4 TD
0.06 Tw
(La llamada)Tj
/TT4 1 Tf
4.8397 0 TD
0 Tw
(write\(2\))Tj
/TT6 1 Tf
3.5317 0 TD
0.0601 Tw
(escribe bytes en un )Tj
/TT7 1 Tf
8.1266 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0601 Tw
(chero. El primer parámetro es un)Tj
/TT11 1 Tf
13.7717 0 TD
0 Tw
(int)Tj
/TT6 1 Tf
2.1104 0 TD
0.0601 Tw
(que representa un )Tj
/TT7 1 Tf
7.4825 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
-40.975 -1.2 TD
0.1234 Tw
[(abierto en que se desea escribir)55(.)-373.5(E)0(l)-373.4(s)0(e)15(gundo parámetro es una dirección de memoria, un puntero. Indica)]TJ
T*
0.1242 Tw
(dónde tienes los bytes que deseas escribir en el )Tj
/TT7 1 Tf
20.1398 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1242 Tw
(chero. El último parámetro es el número de bytes que)Tj
-20.6959 -1.2 TD
0.0121 Tw
[(deseas escribir)55(.)-262.2(T)80(al y como indica el manual, el v)25(alor de)25(vuelto es el número de bytes que se han escrito y se)]TJ
T*
0.0352 Tw
[(considera un error que write escriba un número de bytes distinto al que se desea escribir)55(.)-285.2(¿Entiendes mejor)]TJ
T*
0 Tw
(el código ahora?)Tj
0 -2.4 TD
(El )Tj
/TT7 1 Tf
1.1558 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0171 Tw
(chero en que hemos escrito es simplemente ")Tj
/TT11 1 Tf
18.1055 0 TD
0 Tw
(1)Tj
/TT6 1 Tf
0.6001 0 TD
0.0171 Tw
[(")-267.1(e)0(n)-267.1(este caso. Los )]TJ
/TT7 1 Tf
7.7691 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0171 Tw
(cheros tienen nombres, como sabes.)Tj
-28.7428 -1.2 TD
0.0427 Tw
(Los nombres de )Tj
/TT7 1 Tf
6.7658 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0427 Tw
[(chero son strings que UNIX interpreta como paths absolutos o relati)25(v)20(os, dependiendo de)]TJ
-7.3219 -1.2 TD
0.0252 Tw
(si comienzan por ")Tj
/TT11 1 Tf
7.5649 0 TD
0 Tw
(/)Tj
/TT6 1 Tf
0.6001 0 TD
0.2752 Tw
[(")-275.2(o)-275.2(no. Pues)-275.2(bien, )250(los )]TJ
/TT7 1 Tf
9.0872 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0252 Tw
(cheros abiertos que utiliza un proceso también tienen nombres.)Tj
-17.8083 -1.2 TD
0 Tw
(En este caso los llamamos)Tj
/TT2 1 Tf
10.7476 0 TD
[(descriptor)18(es de )]TJ
/TT9 1 Tf
6.7027 0 TD
(Þ)Tj
/TT2 1 Tf
0.5562 0 TD
[(cher)18(o)]TJ
/TT6 1 Tf
2.3697 0 TD
(.)Tj
-20.3761 -2.4 TD
(Un)Tj
/TT4 1 Tf
1.4902 0 TD
0.018 Tw
(descriptor de )Tj
/TT8 1 Tf
5.5907 0 TD
0 Tw
(Þ)Tj
/TT4 1 Tf
0.5 0 TD
[(c)15(her)45(o)]TJ
/TT6 1 Tf
2.4849 0 TD
0.0181 Tw
(es un entero que indica qué )Tj
/TT7 1 Tf
11.2712 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0181 Tw
[(chero abierto se desea usar)55(.)-268.1(Cuando abres un )]TJ
/TT7 1 Tf
18.2773 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero,)Tj
-40.7265 -1.2 TD
0.0125 Tw
[(UNIX te da un nue)25(v)20(o)20( )-20.1(descriptor de )]TJ
/TT7 1 Tf
14.3443 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0125 Tw
[(chero. Cuando lo cierras, dicho descriptor deja de e)15(xistir)55(.)-262.5(E)0(l)-262.5(descriptor)]TJ
-14.9004 -1.2 TD
0 Tw
(de )Tj
/TT7 1 Tf
1.3042 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1104 Tw
(chero es simplemente un índice en un array de )Tj
/TT7 1 Tf
19.7919 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1104 Tw
(cheros abiertos. Este array lo mantiene UNIX para)Tj
-22.2085 -1.2 TD
0 Tw
(cada proceso. Mira la )Tj
/TT7 1 Tf
8.8569 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(gura 1.)Tj
-9.4131 -3.6 TD
0.0639 Tw
[(El con)40(v)15(enio en UNIX es que todos los procesos parten con tres descriptores de )]TJ
/TT7 1 Tf
32.6086 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5561 0 TD
0.0639 Tw
(chero abiertos:)Tj
/TT11 1 Tf
6.2918 0 TD
0 Tw
(0)Tj
/TT6 1 Tf
0.6001 0 TD
(,)Tj
/TT11 1 Tf
0.5638 0 TD
(1)Tj
/TT6 1 Tf
0.9139 0 TD
(y)Tj
/TT11 1 Tf
0.8138 0 TD
(2)Tj
/TT6 1 Tf
0.6001 0 TD
(.)Tj
-42.9482 -1.2 TD
0.0634 Tw
(Corresponden a los )Tj
/TT7 1 Tf
8.1609 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0634 Tw
(cheros llamados)Tj
/TT2 1 Tf
6.847 0 TD
(entrada estándar)Tj
/TT6 1 Tf
7.3686 0 TD
0 Tw
(,)Tj
/TT2 1 Tf
0.5634 0 TD
0.0634 Tw
(salida estándar)Tj
/TT6 1 Tf
6.8499 0 TD
0 Tw
(y)Tj
/TT2 1 Tf
0.8134 0 TD
0.0635 Tw
[(salida de err)18(or estándar)]TJ
/TT6 1 Tf
10.421 0 TD
0.3135 Tc
0 Tw
[(.L)313.5(a)]TJ
-41.5804 -1.2 TD
0 Tc
0.0054 Tw
(idea es que se espera que el programa lea sus datos de entrada del )Tj
/TT7 1 Tf
26.5644 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0054 Tw
(chero abierto)Tj
/TT11 1 Tf
5.5079 0 TD
0 Tw
(0)Tj
/TT6 1 Tf
0.6001 0 TD
0.0053 Tw
[(,)-255.4(o)-255.3(de la entrada estándar)]TJ
-33.2285 -1.2 TD
0.3024 Tc
0 Tw
[(od)302.4(e)]TJ
/TT4 1 Tf
2.0486 0 TD
0 Tc
(stdin)Tj
/TT6 1 Tf
1.9448 0 TD
0.0524 Tw
[(.)-552.4(Igualmente, se espera que el programa escriba cualquier resultado en el )]TJ
/TT7 1 Tf
30.1434 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0524 Tw
(chero abierto)Tj
/TT11 1 Tf
5.602 0 TD
0 Tw
(1)Tj
/TT6 1 Tf
0.6001 0 TD
0.3025 Tc
[(,oe)302.5(n)]TJ
-40.8951 -1.2 TD
0 Tc
0.0688 Tw
(la salida estándar o en)Tj
/TT4 1 Tf
9.4236 0 TD
0 Tw
(stdout)Tj
/TT6 1 Tf
2.4448 0 TD
0.0687 Tw
[(.)-318.8(E)0(n)-318.8(cambio, los mensajes de error se escriben en la salida de error estándar)40(,)]TJ
-11.8684 -1.2 TD
0.048 Tw
(que corresponde con el descriptor)Tj
/TT11 1 Tf
13.9846 0 TD
0 Tw
(2)Tj
/TT6 1 Tf
0.6001 0 TD
0.0481 Tw
[(.)-298(L)0(a)-298(razón para tener una salida de error estándar separada de la salida)]TJ
-14.5847 -1.2 TD
0.0455 Tw
[(estándar es e)25(vitar que se mezclen los resultados de la ejecución de un programa con los mensajes de error)55(.)]TJ
0 -4.2 TD
0 Tw
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
15 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT8 8 0 R
/TT9 9 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
17 0 obj
<<
/Length 4664
>>
stream
BT
/TT6 1 Tf
10 0 0 10 282.17 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-3-)Tj
ET
0 G
1 J 1 j 0.4 w 10 M []0 d
1 i 
172.8 673.2 m
172.8 657.302 159.898 644.4 144 644.4 c
128.102 644.4 115.2 657.302 115.2 673.2 c
115.2 689.098 128.102 702 144 702 c
159.898 702 172.8 689.098 172.8 673.2 c
s
BT
10 0 0 10 128.17 671 Tm
(Proceso)Tj
ET
244.8 637.2 m
243 644.4 l
246.6 644.4 l
f
0.1 w 
244.8 637.2 m
243 644.4 l
246.6 644.4 l
s
0.4 w 
172.8 673.2 m
208.8 673.2 l
232.8 673.2 244.8 667.32 244.8 655.56 c
244.8 637.92 l
S
BT
10 0 0 10 178.67 659 Tm
(descriptores de)Tj
/TT7 1 Tf
1.6245 -1.2 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
0.5823 -1.92 TD
(0)Tj
ET
244.8 622.8 72 14.4 re
S
BT
10 0 0 10 206.3 613.4 Tm
(1)Tj
ET
244.8 608.4 72 14.4 re
S
BT
10 0 0 10 206.3 599 Tm
(2)Tj
ET
244.8 594 72 14.4 re
S
BT
10 0 0 10 206.3 584.6 Tm
[(3)-6575(...)]TJ
0 -1.44 TD
(n)Tj
ET
244.8 565.2 72 14.4 re
S
388.8 666 m
381.6 664.2 l
381.6 667.8 l
f
0.1 w 
388.8 666 m
381.6 664.2 l
381.6 667.8 l
s
0.4 w 
280.8 630 m
316.8 630 l
340.8 630 352.8 636 352.8 648 c
352.8 660 358.68 666 370.44 666 c
388.08 666 l
388.8 651.6 72 28.8 re
S
BT
10 0 0 10 410.085 669.8 Tm
(entrada)Tj
0.763 -1.2 TD
(std.)Tj
ET
388.8 615.6 m
381.6 613.8 l
381.6 617.4 l
f
0.1 w 
388.8 615.6 m
381.6 613.8 l
381.6 617.4 l
s
0.4 w 
280.83 615.63 m
381.63 615.63 l
388.8 601.2 72 28.8 re
S
BT
10 0 0 10 413.135 619.4 Tm
(salida)Tj
0.458 -1.2 TD
(std.)Tj
ET
388.8 565.2 m
381.6 563.4 l
381.6 567 l
f
0.1 w 
388.8 565.2 m
381.6 563.4 l
381.6 567 l
s
0.4 w 
280.8 601.2 m
316.8 601.2 l
340.8 601.2 352.8 595.2 352.8 583.2 c
352.8 571.2 358.68 565.2 370.44 565.2 c
388.08 565.2 l
388.8 550.8 72 28.8 re
S
BT
10 0 0 10 407.165 569 Tm
(salida de)Tj
-0.0415 -1.2 TD
(error std.)Tj
/TT2 1 Tf
-30.975 -2.92 TD
0.073 Tw
(Figura 1:)Tj
/TT4 1 Tf
4.3677 0 TD
[(Los descriptor)37(es de )]TJ
/TT8 1 Tf
8.265 0 TD
0 Tw
(Þ)Tj
/TT4 1 Tf
0.5 0 TD
0.0729 Tw
[(c)15(her)45(o)-323(son entr)15(adas en un arr)15(ay que apuntan a los )]TJ
/TT8 1 Tf
20.8598 0 TD
0 Tw
(Þ)Tj
/TT4 1 Tf
0.5 0 TD
0.0729 Tw
[(c)15(her)45(os abiertos)]TJ
-34.4925 -1.2 TD
0.0449 Tw
[(de un pr)45(oceso. Se utilizan par)15(a)-294.9(l)0(a)-294.9(entr)15(ada estándar)111(,)-294.9(l)0(a)-294.9(salida estándar)111(,)-295(l)0(a)-295(salida de err)45(or estándar y)]TJ
T*
0 Tw
[(cualquier otr)45(o)]TJ
/TT8 1 Tf
5.9545 0 TD
(Þ)Tj
/TT4 1 Tf
0.5 0 TD
[(c)15(her)45(o)-250(abierto.)]TJ
/TT6 1 Tf
-8.9545 -1.2 TD
0.0256 Tw
(Por ejemplo, podríamos ejecutar un programa guardando sus resultados en un )Tj
/TT7 1 Tf
31.6068 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0256 Tw
[(chero y)65(,)-275.6(aún así, querremos)]TJ
-32.1629 -1.2 TD
0 Tw
(que los mensajes de error aparezcan en la pantalla.)Tj
0 -2.4 TD
0.0557 Tw
[(Cuando ejecutas un programa desde el shell en una v)15(entana de tu sistema la entrada estándar es el teclado)]TJ
0 -1.2 TD
0.0068 Tw
[(en dicha v)15(entana y tanto la salida estándar como la salida de error estándar son la pantalla en dicha v)15(entana.)]TJ
T*
0 Tw
(Esto es así a no ser que lo cambies. Recuerda cuando ejecutamos...)Tj
/TT11 1 Tf
8 0 0 8 133 413.8 Tm
(unix$ echo hola >unfichero)Tj
/TT6 1 Tf
10 0 0 10 72 395.8 Tm
0.0647 Tw
(En este caso el shell habrá hecho que la salida estándar de)Tj
/TT11 1 Tf
24.211 0 TD
0 Tw
(echo)Tj
/TT6 1 Tf
2.715 0 TD
(sea)Tj
/TT11 1 Tf
1.5915 0 TD
(unfichero)Tj
/TT6 1 Tf
5.4009 0 TD
0.0646 Tw
[(.)-314.6(Y)100(a)-314.6(v)15(eremos más ade-)]TJ
-33.9183 -1.2 TD
0 Tw
(lante como funciona esto.)Tj
0 -2.4 TD
0.0626 Tw
[(P)15(ara leer un )]TJ
/TT7 1 Tf
5.1982 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0626 Tw
(chero \(abierto\) se utiliza)Tj
/TT4 1 Tf
10.2455 0 TD
0 Tw
[(r)37(ead\(2\))]TJ
/TT6 1 Tf
2.962 0 TD
0.0626 Tw
[(.)-312.6(Igual que)]TJ
/TT11 1 Tf
4.6863 0 TD
0 Tw
(write)Tj
/TT6 1 Tf
3.0005 0 TD
0.0627 Tw
[(,)-312.6(esta función recibe tres ar)18(gumentos: un)]TJ
-26.6487 -1.2 TD
0.0068 Tw
(descriptor de )Tj
/TT7 1 Tf
5.456 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0068 Tw
(chero, una dirección de memoria y un número entero. La llamada)Tj
/TT11 1 Tf
26.4805 0 TD
0 Tw
(read)Tj
/TT6 1 Tf
2.6571 0 TD
0.0067 Tw
(lee bytes del )Tj
/TT7 1 Tf
5.2681 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
-40.974 -1.2 TD
(indicado por el descriptor de )Tj
/TT7 1 Tf
11.6904 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
[(chero y los deja en la memoria a partir de la posición indicada por el se)15(gundo)]TJ
-12.2466 -1.2 TD
0.0699 Tw
[(ar)18(gumento \(un puntero\). Como mucho se leen tantos bytes como indica el tercer ar)18(gumento, pero podrían)]TJ
T*
0 Tw
[(leerse menos. V)111(eamos un programa que lee de la entrada estándar y escribe lo que lee en la salida estándar:)]TJ
0 -28.78 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
18 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT8 8 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
20 0 obj
<<
/Length 3972
>>
stream
BT
/TT6 1 Tf
10 0 0 10 282.17 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-4-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(#include <stdio.h>)Tj
0 -1.5 TD
(#include <stdlib.h>)Tj
T*
(#include <unistd.h>)Tj
T*
(#include <err.h>)Tj
0 -3 TD
(int)Tj
0 -1.5 TD
(main\(int argc, char* argv[]\))Tj
T*
({)Tj
2.4 -1.5 TD
1.8 Tw
(char buffer[1024];)Tj
T*
(int nr;)Tj
0 -3 TD
0 Tw
(nr = read\(0, buffer, sizeof buffer\);)Tj
0 -1.5 TD
(if \(nr < 0\) {)Tj
2.4 -1.5 TD
(err\(1, "read"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(if \(write\(1, buffer, nr\) != nr\) {)Tj
2.4 -1.5 TD
(err\(1, "write"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(exit\(0\);)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 462 Tm
[(Y)-250(así es cómo ejecuta...)]TJ
/TT11 1 Tf
8 0 0 8 133 444 Tm
(unix$ read1)Tj
T*
(hola)Tj
T*
(hola)Tj
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 390 Tm
0.0312 Tw
(El primer ")Tj
/TT11 1 Tf
4.5248 0 TD
0 Tw
(hola)Tj
/TT6 1 Tf
2.4004 0 TD
0.0313 Tw
[(")-281.3(l)0(o)-281.3(hemos escrito nosotros. El se)15(gundo en cambio lo ha escrito el programa)]TJ
/TT11 1 Tf
31.0741 0 TD
0 Tw
(read1)Tj
/TT6 1 Tf
3.0005 0 TD
[(.)-281.3(Una)]TJ
-40.9998 -1.2 TD
[(v)15(e)0(z)-250(l)0(o)-250(h)0(a)-250(escrito, el programa termina.)]TJ
0 -2.4 TD
0.0554 Tw
[(Como v)15(erás, el programa lee del descriptor)]TJ
/TT11 1 Tf
17.8666 0 TD
0 Tw
(0)Tj
/TT6 1 Tf
0.9055 0 TD
0.0554 Tw
[(y)-305.4(escribe en el)]TJ
/TT11 1 Tf
6.2187 0 TD
0 Tw
(1)Tj
/TT6 1 Tf
0.6001 0 TD
0.0554 Tw
[(.)-305.4(O)-305.4(dicho de otro modo, lee de la entrada y)]TJ
-25.5908 -1.2 TD
0.2087 Tw
(escribe en la salida lo que lee. Hasta que hemos escrito ")Tj
/TT11 1 Tf
24.9178 0 TD
0 Tw
(hola)Tj
/TT6 1 Tf
2.4004 0 TD
[(")-458.7(y)-458.7(pulsado)]TJ
/TT4 1 Tf
5.3951 0 TD
(enter)Tj
/TT6 1 Tf
2.5134 0 TD
0.2087 Tw
(el programa estaba)Tj
-35.2267 -1.2 TD
0.1353 Tw
(esperando a que escribiéramos. O, más precisamente, el programa estaba dentro de la llamada a)Tj
/TT4 1 Tf
40.5129 0 TD
0 Tw
[(r)37(ead)]TJ
/TT6 1 Tf
2.1813 0 TD
(y)Tj
-42.6942 -1.2 TD
0.0696 Tw
(UNIX tenía el proceso bloqueado a la espera de tener algo que leer \(esto es, no estaba ejecutando ni listo)Tj
T*
0 Tw
(para ejecutar\).)Tj
0 -2.4 TD
0.048 Tw
(Cuando pulsamos teclas para escribir ")Tj
/TT11 1 Tf
15.7825 0 TD
0 Tw
(hola)Tj
/TT6 1 Tf
2.4004 0 TD
0.048 Tw
[(")-298(e)0(l)-298(teclado en)40(vía interrupciones que atiende UNIX. El mane-)]TJ
-18.1829 -1.2 TD
0.1572 Tw
[(jador de dichas interrupciones ha ido guardando los caracteres correspondientes en un b)20(u)0(f)25(fer hasta que)]TJ
T*
0.0055 Tw
(hemos pulsado)Tj
/TT4 1 Tf
6.2327 0 TD
0 Tw
(enter)Tj
/TT6 1 Tf
2.0547 0 TD
0.0055 Tw
[(.)-255.5(E)0(n)-255.5(dicho momento, UNIX ha copiado los caracteres de dicho b)20(u)0(f)25(fer hacia la memoria)]TJ
-8.2874 -1.2 TD
0 Tw
(del proceso \(para atender la llamada a)Tj
/TT4 1 Tf
15.4082 0 TD
[(r)37(ead)]TJ
/TT6 1 Tf
2.046 0 TD
(que estaba haciendo\) y listo.)Tj
-17.4542 -2.4 TD
0.0011 Tw
(¡Esa es la razón por la que puedes borrar caracteres cuando escribes en el teclado! Cuando pulsas la tecla de)Tj
0 -1.2 TD
0.1369 Tw
[(borrar)40(,)-387(UNIX lee el carácter \(que es tan b)20(ueno como cualquier otro\) y entiende que quieres eliminar el)]TJ
T*
0.0053 Tw
[(último carácter que había en el b)20(u)0(f)25(fer de lectura de teclado.)-505.3(Cuando pulsas)]TJ
/TT4 1 Tf
30.372 0 TD
0 Tw
(enter)Tj
/TT6 1 Tf
2.0547 0 TD
0.0053 Tw
[(,)-255.3(UNIX entiende que dicha)]TJ
-32.4267 -1.2 TD
0 Tw
(línea está lista para quien quiera que lea de teclado.)Tj
0 -2.4 TD
0.1357 Tw
(La mayoría de los programas en UNIX aceptan nombres de )Tj
/TT7 1 Tf
25.4039 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1356 Tw
[(chero como ar)18(gumentos para trabajar con)]TJ
-25.96 -1.2 TD
0.0946 Tw
[(ellos y)65(,)-344.6(lo)-344.6(normal, es que si no indicas ningún nombre de )]TJ
/TT7 1 Tf
24.1229 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5561 0 TD
0.0947 Tw
(chero el programa en cuestión trabaje con su)Tj
-24.679 -1.2 TD
0 Tw
[(entrada estándar)55(.)]TJ
0 -2.4 TD
(Por ejemplo, en este caso)Tj
0 -9 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
21 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
23 0 obj
<<
/Length 4045
>>
stream
BT
/TT6 1 Tf
10 0 0 10 282.17 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-5-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(unix$ echo hola >/tmp/fich)Tj
0 -1.5 TD
(unix$ cat /tmp/fich)Tj
T*
(hola)Tj
T*
(unix$ cat /tmp/fich /tmp/fich)Tj
T*
(hola)Tj
T*
(hola)Tj
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 618 Tm
0.0895 Tw
(el comando)Tj
/TT4 1 Tf
5.0662 0 TD
0 Tw
(cat)Tj
/TT6 1 Tf
1.5612 0 TD
(lee)Tj
/TT11 1 Tf
1.505 0 TD
(/tmp/fich)Tj
/TT6 1 Tf
5.7404 0 TD
0.0895 Tw
[(y)-339.5(escribe su contenido en la salida estándar)55(.)-339.5(Pero si llamamos a)]TJ
/TT4 1 Tf
26.5947 0 TD
0 Tw
(cat)Tj
/TT6 1 Tf
1.5612 0 TD
(sin)Tj
-42.0287 -1.2 TD
(indicar ningún nombre de )Tj
/TT7 1 Tf
10.5527 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero...)Tj
/TT11 1 Tf
8 0 0 8 133 588 Tm
(unix$ cat)Tj
0 -1.5 TD
(xxx)Tj
T*
(xxx)Tj
T*
(yyy)Tj
T*
(yyy)Tj
T*
(ˆD)Tj
T*
(unix$)Tj
/TT4 1 Tf
10 0 0 10 72 498 Tm
(cat)Tj
/TT6 1 Tf
1.6113 0 TD
0.1396 Tw
(se limita a leer de su entrada estándar hasta el )Tj
/TT7 1 Tf
19.8877 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1396 Tw
(n de )Tj
/TT7 1 Tf
2.223 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1396 Tw
(chero y a escribir todo cuanto lea. Nosotros)Tj
-24.8343 -1.2 TD
0.0361 Tw
(escribimos una línea con)Tj
/TT11 1 Tf
10.308 0 TD
0 Tw
(xxx)Tj
/TT6 1 Tf
2.0864 0 TD
0.0361 Tw
(en el teclado y)Tj
/TT4 1 Tf
6.1971 0 TD
0 Tw
(cat)Tj
/TT6 1 Tf
1.5078 0 TD
0.0361 Tw
(la escribe en su salida. Después escribimos una línea con)Tj
/TT11 1 Tf
-20.0993 -1.2 TD
0 Tw
(yyy)Tj
/TT6 1 Tf
2.0503 0 TD
(en el teclado y)Tj
/TT4 1 Tf
6.0527 0 TD
(cat)Tj
/TT6 1 Tf
1.4717 0 TD
(la escribe en su salida. Hasta el )Tj
/TT7 1 Tf
12.7173 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(n de )Tj
/TT7 1 Tf
1.9438 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero.)Tj
-25.3481 -2.4 TD
0.1953 Tw
(¡Un momento! ¿Fin de )Tj
/TT7 1 Tf
10.1684 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1953 Tw
(chero para el teclado? Pues si. El )Tj
/TT7 1 Tf
14.8061 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1953 Tw
(chero que corresponde al teclado es una)Tj
-26.0868 -1.2 TD
0.1887 Tw
(abstracción, ¿Recuerdas?. Cuando mantienes pulsado)Tj
/TT4 1 Tf
22.5747 0 TD
0 Tw
[(contr)45(ol)]TJ
/TT6 1 Tf
3.2823 0 TD
0.1886 Tw
[(y)-438.6(pulsas ")]TJ
/TT11 1 Tf
4.2854 0 TD
0 Tw
(d)Tj
/TT6 1 Tf
0.6001 0 TD
0.1886 Tw
(", \(esto es,)Tj
/TT4 1 Tf
5.0009 0 TD
0 Tw
[(contr)45(ol-d)]TJ
/TT6 1 Tf
3.6767 0 TD
[(,)-438.6(a)-438.6(v)15(eces)]TJ
-39.4201 -1.2 TD
0.115 Tw
(escrito como)Tj
/TT11 1 Tf
5.6172 0 TD
0 Tw
(ˆD)Tj
/TT6 1 Tf
1.5652 0 TD
0.1151 Tw
(como hemos hecho nosotros en el ejemplo\) UNIX entiende que quieres que quien esté)Tj
-7.1824 -1.2 TD
0.1147 Tw
[(le)15(yendo de teclado reciba una indicación de )]TJ
/TT7 1 Tf
18.5296 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1147 Tw
(n de )Tj
/TT7 1 Tf
2.1732 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1147 Tw
(chero. Así pues,)Tj
/TT4 1 Tf
7.037 0 TD
0 Tw
(cat)Tj
/TT6 1 Tf
1.5864 0 TD
0.3647 Tw
[(termina. \(Acabamos)-364.6(de )250.1(mentir)]TJ
-30.4385 -1.2 TD
0 Tw
(respecto a lo que hace)Tj
/TT4 1 Tf
9.0786 0 TD
[(contr)45(ol-d)]TJ
/TT6 1 Tf
3.9267 0 TD
[(pero desharemos la mentira en bre)25(v)15(e\).)]TJ
-13.0053 -2.4 TD
0.0032 Tw
[(Cabe otra pre)15(gunta... ¿Cómo es que)]TJ
/TT4 1 Tf
14.528 0 TD
0 Tw
(cat)Tj
/TT6 1 Tf
1.475 0 TD
0.0033 Tw
(copia múltiples líneas y nuestro programa sólo una? La respuesta es)Tj
-16.003 -1.2 TD
0.1335 Tw
(simple si piensas que no hay magia y piensas en lo que hace)Tj
/TT4 1 Tf
26.0348 0 TD
0 Tw
[(r)37(ead\(2\))]TJ
/TT6 1 Tf
2.962 0 TD
[(.)-633.5(Cuando)]TJ
/TT11 1 Tf
4.3778 0 TD
(read)Tj
/TT6 1 Tf
2.7839 0 TD
0.1335 Tw
(lee los bytes que)Tj
-36.1586 -1.2 TD
0.0966 Tw
(puede leer y te dice cuántos bytes ha leído,)Tj
/TT11 1 Tf
18.2517 0 TD
0 Tw
(read)Tj
/TT6 1 Tf
2.747 0 TD
0.0966 Tw
[(ha terminado su trabajo.)-596.6(Nuestro programa llamaba a)]TJ
/TT11 1 Tf
-20.9987 -1.2 TD
0 Tw
(read)Tj
/TT6 1 Tf
2.6504 0 TD
[(una única v)15(ez, por lo que al leer de teclado ha leído una única línea.)]TJ
-2.6504 -2.4 TD
[(V)111(amos a arre)15(glarlo haciendo un nue)25(v)20(o)20( )-20(programa.)]TJ
0 -29.4 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
24 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
26 0 obj
<<
/Length 3184
>>
stream
BT
/TT6 1 Tf
10 0 0 10 282.17 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-6-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(#include <stdio.h>)Tj
0 -1.5 TD
(#include <stdlib.h>)Tj
T*
(#include <unistd.h>)Tj
T*
(#include <err.h>)Tj
0 -3 TD
(int)Tj
0 -1.5 TD
(main\(int argc, char* argv[]\))Tj
T*
({)Tj
2.4 -1.5 TD
1.8 Tw
(char buffer[1024];)Tj
T*
(int nr;)Tj
0 -3 TD
0 Tw
(for\(;;\) {)Tj
2.4 -1.5 TD
(nr = read\(0, buffer, sizeof buffer\);)Tj
T*
(if \(nr < 0\) {)Tj
2.4 -1.5 TD
(err\(1, "read"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(if \(nr == 0\) {)Tj
2.4 -1.5 TD
1.8 Tw
[(break; //)-600(EOF)]TJ
-2.4 -1.5 TD
0 Tw
(})Tj
T*
(if \(write\(1, buffer, nr\) != nr\) {)Tj
2.4 -1.5 TD
(err\(1, "write"\);)Tj
-2.4 -1.5 TD
(})Tj
-2.4 -1.5 TD
(})Tj
T*
(exit\(0\);)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 402 Tm
[(Si lo ejecutamos v)15(eremos que se comporta como)]TJ
/TT4 1 Tf
19.7575 0 TD
(cat)Tj
/TT6 1 Tf
1.2217 0 TD
(:)Tj
/TT11 1 Tf
8 0 0 8 133 384 Tm
(unix$ readin)Tj
0 -1.5 TD
(xxx)Tj
T*
(xxx)Tj
T*
(yyy)Tj
T*
(yyy)Tj
T*
(ˆD)Tj
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 282 Tm
0.1132 Tw
[(Esta v)15(ez llamamos a)]TJ
/TT11 1 Tf
8.8791 0 TD
0 Tw
(read)Tj
/TT6 1 Tf
2.7635 0 TD
0.1131 Tw
[(las v)15(eces que sea preciso para leer)]TJ
/TT4 1 Tf
14.6859 0 TD
0 Tw
(toda)Tj
/TT6 1 Tf
2.1409 0 TD
0.1131 Tw
(la entrada. En cada llamada pueden)Tj
-28.4694 -1.2 TD
0 Tw
(ocurrir tres cosas:)Tj
2.5 -1.56 TD
[(•)-2150(Puede que leamos algunos bytes.)]TJ
T*
-0.0001 Tc
0.0001 Tw
[(•)-2150.1(Puede que no tengamos nada más que leer)54.9(.)]TJ
T*
0 Tc
0 Tw
[(•)-2150(Puede que suframos un error)55(.)]TJ
-2.5 -1.2 TD
0.1197 Tw
(En el último caso la página de manual)Tj
/TT4 1 Tf
16.4528 0 TD
0 Tw
[(r)37(ead\(2\))]TJ
/TT6 1 Tf
3.3318 0 TD
0.1198 Tw
(nos dice que)Tj
/TT11 1 Tf
5.6079 0 TD
0 Tw
(read)Tj
/TT6 1 Tf
2.7702 0 TD
[(de)25(vuelv)15(e)]TJ
/TT11 1 Tf
3.9392 0 TD
(-1)Tj
/TT6 1 Tf
1.57 0 TD
[(y)-369.8(actualiza)]TJ
/TT11 1 Tf
4.7923 0 TD
(errno)Tj
/TT6 1 Tf
3.0005 0 TD
0.3698 Tc
[(.E)369.8(n)]TJ
-41.4648 -1.2 TD
0 Tc
[(dicho caso nuestro programa aborta tras imprimir un mensaje e)15(xplicati)25(v)20(o)20( )-20(del error)55(.)]TJ
0 -2.4 TD
0.0166 Tw
[(En el penúltimo caso \(EOF\) el programa termina con normalidad. Y)129(,)-266.6(en)-266.6(el)-266.6(primer caso, el programa escribe)]TJ
0 -1.2 TD
0 Tw
[(en la salida los bytes que ha conse)15(guido leer)55(.)]TJ
0 -2.4 TD
0.0066 Tw
(Recuerda que aunque tu desees leer)Tj
/TT4 1 Tf
14.5328 0 TD
0 Tw
(n)Tj
/TT6 1 Tf
0.7567 0 TD
(bytes,)Tj
/TT11 1 Tf
2.6175 0 TD
(read)Tj
/TT6 1 Tf
2.6571 0 TD
-0.0001 Tc
0.0068 Tw
(no garantiza que pueda leerlos todos. Así pues, si deseas)Tj
-20.5641 -1.2 TD
0 Tc
0.029 Tw
(leer todo un )Tj
/TT7 1 Tf
5.1134 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.029 Tw
(chero o un número dado de bytes, deberás llamar a)Tj
/TT11 1 Tf
20.8657 0 TD
0 Tw
(read)Tj
/TT6 1 Tf
2.6794 0 TD
-0.0002 Tc
0.0292 Tw
[(múltiples v)14.8(eces hasta que consigas)]TJ
-29.2146 -1.2 TD
0 Tc
0.0375 Tw
(leer todo lo que quieres. Un error frecuente cuando no se sabe utilizar UNIX \(¡Cuando no se sabe leer!\) es)Tj
T*
0 Tw
(llamar a)Tj
/TT11 1 Tf
3.498 0 TD
(read)Tj
/TT6 1 Tf
2.6504 0 TD
[(una única v)15(ez.)]TJ
-6.1484 -7.92 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
27 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
29 0 obj
<<
/Length 3226
>>
stream
BT
/TT6 1 Tf
10 0 0 10 282.17 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-7-)Tj
/TT2 1 Tf
-21.017 -3.6 TD
[(2. )-250(Open,)-250(close, el terminal y la consola)]TJ
/TT6 1 Tf
0 -1.56 TD
[(V)111(amos a cambiar nuestro programa para que use)]TJ
/TT4 1 Tf
19.659 0 TD
(open\(2\))Tj
/TT6 1 Tf
3.3599 0 TD
[(y)-250(v)15(eamos que ocurre.)]TJ
/TT11 1 Tf
8 0 0 8 133 674.4 Tm
(#include <stdio.h>)Tj
0 -1.5 TD
(#include <stdlib.h>)Tj
T*
(#include <unistd.h>)Tj
T*
(#include <fcntl.h>)Tj
T*
(#include <err.h>)Tj
0 -3 TD
(int)Tj
0 -1.5 TD
(main\(int argc, char* argv[]\))Tj
T*
({)Tj
2.4 -1.5 TD
1.8 Tw
(char buffer[1024];)Tj
T*
[(int fd,)-600(nr;)]TJ
0 -3 TD
0 Tw
(fd = open\("/dev/tty", O_RDWR\);)Tj
0 -1.5 TD
(if \(fd < 0\) {)Tj
2.4 -1.5 TD
(err\(1, "open %s", "/dev/tty"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(for\(;;\) {)Tj
2.4 -1.5 TD
(nr = read\(fd, buffer, sizeof buffer\);)Tj
T*
(if \(nr < 0\) {)Tj
2.4 -1.5 TD
(close\(fd\);)Tj
T*
(err\(1, "read"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(if \(nr == 0\) {)Tj
2.4 -1.5 TD
1.8 Tw
[(break; //)-600(EOF)]TJ
-2.4 -1.5 TD
0 Tw
(})Tj
T*
(if \(write\(fd, buffer, nr\) != nr\) {)Tj
2.4 -1.5 TD
(close\(fd\);)Tj
T*
(err\(1, "write"\);)Tj
-2.4 -1.5 TD
(})Tj
-2.4 -1.5 TD
(})Tj
T*
(if \(close\(fd\) < 0\) {)Tj
2.4 -1.5 TD
(err\(1, "close"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(exit\(0\);)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 236.4 Tm
(Esto es lo que sucede al ejecutarlo:)Tj
/TT11 1 Tf
8 0 0 8 133 218.4 Tm
(unix$ readtty)Tj
T*
(hola)Tj
T*
(hola)Tj
T*
(caracola)Tj
T*
(caracola)Tj
T*
(ˆD)Tj
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 128.4 Tm
0.1139 Tw
(¡Lo mismo que al utilizar el descriptor)Tj
/TT11 1 Tf
16.4316 0 TD
0 Tw
(0)Tj
/TT6 1 Tf
0.964 0 TD
0.1138 Tw
(para leer y el descriptor)Tj
/TT11 1 Tf
10.2585 0 TD
0 Tw
(1)Tj
/TT6 1 Tf
0.9639 0 TD
0.1138 Tw
[(para escribir! Esta v)15(ez estamos uti-)]TJ
-28.6179 -1.2 TD
0.0516 Tw
[(lizando como descriptor \(para leer y escribir\) el que nos ha de)25(vuelto)]TJ
/TT11 1 Tf
28.0836 0 TD
0 Tw
(open)Tj
/TT6 1 Tf
2.4004 0 TD
0.0517 Tw
[(.)-301.7(Y)-301.7(hemos utilizado)]TJ
/TT11 1 Tf
8.2888 0 TD
0 Tw
(open)Tj
/TT6 1 Tf
2.7021 0 TD
(para)Tj
-41.4749 -1.2 TD
0.0692 Tw
(abrir el )Tj
/TT7 1 Tf
3.2478 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
/TT11 1 Tf
2.5399 0 TD
(/dev/tty)Tj
/TT6 1 Tf
5.12 0 TD
0.0692 Tw
[(para lectura/escritura.)-569.2(El primer parámetro de)]TJ
/TT11 1 Tf
19.1276 0 TD
0 Tw
(open)Tj
/TT6 1 Tf
2.7196 0 TD
0.0692 Tw
(es un nombre de )Tj
/TT7 1 Tf
7.1083 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
-40.9755 -1.2 TD
0.1153 Tw
[(que queremos abrir y el se)15(gundo es un entero que has de interpretar como un conjunto de bits. El v)25(alor)]TJ
/TT11 1 Tf
T*
0 Tw
(O_RDWR)Tj
/TT6 1 Tf
3.9255 0 TD
0.0749 Tw
(indica que queremos abrir el )Tj
/TT7 1 Tf
12.0088 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0749 Tw
[(chero para leer y escribir)55(.)-324.9(E)0(l)-324.9(resultado de)]TJ
/TT11 1 Tf
17.2307 0 TD
0 Tw
(open)Tj
/TT6 1 Tf
2.7253 0 TD
0.0748 Tw
(es un entero que)Tj
-36.4464 -1.2 TD
0.1223 Tw
[(indica qué descriptor podemos utilizar para el nue)25(v)20(o)20( )]TJ
/TT7 1 Tf
22.1482 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1224 Tw
(chero abierto. Por ejemplo, si en nuestro ejemplo)Tj
-22.7044 -4.44 TD
0 Tw
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
30 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
32 0 obj
<<
/Length 6127
>>
stream
BT
/TT6 1 Tf
10 0 0 10 282.17 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-8-)Tj
-21.017 -3.6 TD
0.0276 Tw
(resulta que)Tj
/TT11 1 Tf
4.6646 0 TD
0 Tw
(open)Tj
/TT6 1 Tf
2.678 0 TD
0.0276 Tw
[(ha de)25(vuelto)]TJ
/TT11 1 Tf
4.9174 0 TD
0 Tw
(3)Tj
/TT6 1 Tf
0.6001 0 TD
0.0275 Tw
[(,)-277.6(tendríamos posiblemente unos descriptores como los que puedes v)15(er en la)]TJ
/TT7 1 Tf
-12.8601 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(gura 2.)Tj
ET
0 G
1 J 1 j 0.4 w 10 M []0 d
1 i 
180 630 m
180 610.128 163.872 594 144 594 c
124.128 594 108 610.128 108 630 c
108 649.872 124.128 666 144 666 c
163.872 666 180 649.872 180 630 c
s
BT
10 0 0 10 128.17 627.8 Tm
(Proceso)Tj
ET
252 594 m
250.2 601.2 l
253.8 601.2 l
f
0.1 w 
252 594 m
250.2 601.2 l
253.8 601.2 l
s
0.4 w 
180 630 m
216 630 l
240 630 252 624.12 252 612.36 c
252 594.72 l
S
BT
10 0 0 10 191.84 615.8 Tm
(descriptores)Tj
0.4305 -1.2 TD
(de )Tj
/TT7 1 Tf
1.1938 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
-0.0145 -1.92 TD
(0)Tj
ET
252 579.6 72 14.4 re
S
BT
10 0 0 10 213.5 570.2 Tm
(1)Tj
ET
252 565.2 72 14.4 re
S
BT
10 0 0 10 213.5 555.8 Tm
(2)Tj
ET
252 550.8 72 14.4 re
S
BT
10 0 0 10 213.5 541.4 Tm
(3)Tj
ET
252 536.4 72 14.4 re
S
BT
10 0 0 10 284.25 527 Tm
(...)Tj
-7.075 -1.44 TD
(n)Tj
ET
252 507.6 72 14.4 re
396 500.4 72 14.4 re
S
BT
/TT11 1 Tf
10 0 0 10 408 505.4 Tm
(/dev/tty)Tj
ET
405.216 531.648 m
398.664 535.104 l
401.04 537.768 l
f
0.1 w 
405.216 531.648 m
398.664 535.104 l
401.04 537.768 l
s
0.4 w 
324 572.4 m
342 572.4 l
354 572.4 367.452 565.692 382.356 552.276 c
404.712 532.152 l
S
407.808 534.24 m
401.616 538.344 l
404.28 540.792 l
f
0.1 w 
407.808 534.24 m
401.616 538.344 l
404.28 540.792 l
s
0.4 w 
324 586.8 m
342 586.8 l
354 586.8 367.884 578.124 383.652 560.772 c
407.304 534.744 l
S
402.48 528.264 m
395.568 530.928 l
397.656 533.88 l
f
0.1 w 
402.48 528.264 m
395.568 530.928 l
397.656 533.88 l
s
0.4 w 
324 558 m
342 558 l
354 558 366.984 553.104 380.952 543.312 c
401.904 528.624 l
S
399.816 523.728 m
392.544 525.312 l
394.128 528.552 l
f
0.1 w 
399.816 523.728 m
392.544 525.312 l
394.128 528.552 l
s
0.4 w 
324 543.6 m
342 543.6 l
354 543.6 366.528 540.336 379.584 533.808 c
399.168 524.016 l
S
BT
/TT2 1 Tf
10 0 0 10 97 448.6 Tm
(Figura 2:)Tj
/TT4 1 Tf
4.2217 0 TD
[(Descriptor)37(es tr)15(as abrir el terminal usando)]TJ
/TT11 1 Tf
17.2258 0 TD
(open)Tj
/TT4 1 Tf
2.4004 0 TD
(.)Tj
/TT6 1 Tf
-26.3479 -2.4 TD
0.0534 Tw
(Cuando abrimos un )Tj
/TT7 1 Tf
8.2427 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0534 Tw
(chero, se espera que lo cerremos en el momento en que deje de sernos útil, cosa que)Tj
-8.7989 -1.2 TD
(se consigue llamando a)Tj
/TT4 1 Tf
9.7659 0 TD
0 Tw
(close\(2\))Tj
/TT6 1 Tf
3.524 0 TD
0.0532 Tw
(con el descriptor de )Tj
/TT7 1 Tf
8.3207 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0532 Tw
[(chero que se desea cerrar)55(.)-303.2(Y)-303.2(cuidado aquí...)]TJ
/TT11 1 Tf
18.0288 0 TD
0 Tw
(close)Tj
/TT6 1 Tf
-40.1956 -1.2 TD
0.0221 Tw
[(podría f)10(allar y hay que comprobar si ha podido hacer su trabajo o no. De no hacerlo, puede que no detectes)]TJ
T*
0.046 Tw
[(que todas tus escrituras han alcanzado su destino. Una v)15(ez has cerrado un descriptor)40(,)-296(podría ser que)]TJ
/TT11 1 Tf
40.7963 0 TD
0 Tw
(open)Tj
/TT6 1 Tf
-40.7963 -1.2 TD
0.129 Tw
[(en el futuro de)25(vuelv)25(a)-379(justo ese descriptor para otro )]TJ
/TT7 1 Tf
21.6315 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.129 Tw
(chero. Un descriptor de )Tj
/TT7 1 Tf
10.1513 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.129 Tw
(chero es simplemente un)Tj
-32.8951 -1.2 TD
0 Tw
(índice en la tabla de )Tj
/TT7 1 Tf
8.2461 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(cheros abiertos del proceso.)Tj
-8.8022 -2.4 TD
0.0211 Tw
[(En este punto, deberíamos pre)15(guntarnos... ¿Qué )]TJ
/TT7 1 Tf
19.4953 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0211 Tw
(chero es la entrada estándar? ¿Y la salida? La mayoría de)Tj
-20.0515 -1.2 TD
0.0544 Tw
[(las v)15(eces la entrada y la salida corresponden al )]TJ
/TT7 1 Tf
19.3828 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
/TT11 1 Tf
2.5252 0 TD
(/dev/tty)Tj
/TT6 1 Tf
4.8008 0 TD
0.0545 Tw
[(,)-304.5(que representa el)]TJ
/TT4 1 Tf
7.7419 0 TD
0 Tw
(terminal)Tj
/TT6 1 Tf
3.6932 0 TD
0.0545 Tw
(en que eje-)Tj
-38.7 -1.2 TD
0.017 Tw
[(cuta nuestro programa. Es por esto que nuestro programa consigue el mismo efecto le)15(yendo de)]TJ
/TT11 1 Tf
38.3961 0 TD
0 Tw
(/dev/tty)Tj
/TT6 1 Tf
-38.3961 -1.2 TD
0.0624 Tw
[(que le)15(yendo del descriptor)]TJ
/TT11 1 Tf
11.0642 0 TD
0 Tw
(0)Tj
/TT6 1 Tf
0.9125 0 TD
0.0624 Tw
[(y)-312.4(escribiendo en)]TJ
/TT11 1 Tf
6.9904 0 TD
0 Tw
(/dev/tty)Tj
/TT6 1 Tf
5.1132 0 TD
-0.0001 Tc
0.0625 Tw
(en lugar de escribir en el descriptor)Tj
/TT11 1 Tf
14.7869 0 TD
0 Tc
0 Tw
(1)Tj
/TT6 1 Tf
0.6001 0 TD
[(.)-312.5(Simple-)]TJ
-39.4673 -1.2 TD
(mente)Tj
/TT11 1 Tf
2.6934 0 TD
(0)Tj
/TT6 1 Tf
0.8501 0 TD
(y)Tj
/TT11 1 Tf
0.75 0 TD
(1)Tj
/TT6 1 Tf
0.8501 0 TD
(ya se referían a)Tj
/TT11 1 Tf
6.3291 0 TD
(/dev/tty)Tj
/TT6 1 Tf
4.8008 0 TD
(.)Tj
-16.2734 -2.4 TD
(Pero mira esto:)Tj
/TT11 1 Tf
8 0 0 8 133 250.6 Tm
(unix$ readin >/tmp/fich)Tj
0 -1.5 TD
(hola)Tj
T*
(ˆD)Tj
T*
(unix$ cat /tmp/fich)Tj
T*
(hola)Tj
T*
(unix$)Tj
T*
(unix$ readtty >/tmp/fich)Tj
T*
(hola)Tj
T*
(hola)Tj
T*
(ˆD)Tj
T*
(unix$ cat /tmp/fich)Tj
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 100.6 Tm
0.0606 Tw
(Si utilizamos el programa que lee de la entrada estándar y escribe en la salida estándar \(¡Que es lo que se)Tj
0 -1.2 TD
0.0853 Tw
[(espera de un programa en UNIX!\))-585.3(v)15(emos que el programa se comporta de forma diferente a cuando uti-)]TJ
T*
0.0567 Tw
(lizamos el programa que utiliza)Tj
/TT11 1 Tf
13.1398 0 TD
0 Tw
(/dev/tty)Tj
/TT6 1 Tf
5.1074 0 TD
0.0566 Tw
(para leer y escribir en el. En este caso, hemos pedido al shell)Tj
-18.2472 -1.2 TD
0.1794 Tw
(que ejecute)Tj
/TT11 1 Tf
5.1337 0 TD
0 Tw
(readin)Tj
/TT6 1 Tf
4.03 0 TD
0.1795 Tw
[(en)40(viando su salida estándar al )]TJ
/TT7 1 Tf
13.0479 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
/TT11 1 Tf
2.6502 0 TD
(/tmp/fich)Tj
/TT6 1 Tf
5.4009 0 TD
0.1795 Tw
[(,)-429.5(por lo que el programa que)]TJ
-30.8188 -4.06 TD
0 Tw
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
33 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
35 0 obj
<<
/Length 5042
>>
stream
BT
/TT6 1 Tf
10 0 0 10 282.17 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-9-)Tj
-21.017 -3.6 TD
0.0767 Tw
(escribe en)Tj
/TT11 1 Tf
4.4288 0 TD
0 Tw
(1)Tj
/TT6 1 Tf
0.9268 0 TD
0.0767 Tw
[(en)40(vía su salida correctamente a dicho )]TJ
/TT7 1 Tf
15.6355 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0767 Tw
(chero. En cambio,)Tj
/TT11 1 Tf
7.755 0 TD
0 Tw
(readtty)Tj
/TT6 1 Tf
4.5274 0 TD
0.0766 Tw
(sigue escribiendo en la)Tj
-33.8297 -1.2 TD
0 Tw
[(v)15(entana \(en el terminal\). ¡Normal!, considerando que dicho programa abre el terminal y escribe en el.)]TJ
0 -2.4 TD
0.0279 Tw
[(Cuando el sistema arranca, antes de que ejecute el sistema de v)15(entanas, los programas utilizan la pantalla y)]TJ
0 -1.2 TD
0.0105 Tw
(el teclado. Ambos están abstraídos en el )Tj
/TT7 1 Tf
16.3465 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
/TT11 1 Tf
2.4812 0 TD
(/dev/cons)Tj
/TT6 1 Tf
5.4009 0 TD
0.0105 Tw
[(,)-260.5(llamado así por ser la)]TJ
/TT4 1 Tf
9.3657 0 TD
0 Tw
(consola)Tj
/TT6 1 Tf
3.3713 0 TD
0.0105 Tw
(\(Hace tiempo,)Tj
-37.5218 -1.2 TD
0.0548 Tw
(las máquinas eran mucho mas grandes y tenían aspecto de mueble siendo la pantalla y el teclado algo con)Tj
T*
0 Tw
(aspecto de consola\).)Tj
0 -2.4 TD
0.0051 Tw
[(Una v)15(ez ejecuta el sistema de v)15(entanas \(que es un programa como todo lo demás\), éste se queda con la con-)]TJ
0 -1.2 TD
0.0265 Tw
[(sola para poder leer y escribir y se in)40(v)15(enta las)]TJ
/TT4 1 Tf
18.7027 0 TD
0 Tw
(ventanas)Tj
/TT6 1 Tf
3.8312 0 TD
0.0266 Tw
[(como abstracción para que ejecuten nue)25(v)20(o)0(s)-276.6(progra-)]TJ
-22.5339 -1.2 TD
0.1425 Tw
[(mas. Igualmente, cuando un usuario remoto establece una cone)15(xión de red y se conecta para utilizar la)]TJ
T*
0.0279 Tw
(máquina, se le asigna un)Tj
/TT4 1 Tf
10.1922 0 TD
0 Tw
(terminal)Tj
/TT6 1 Tf
3.6666 0 TD
0.0279 Tw
[(que es de nue)25(v)20(o)20( )-20(una abstracción y tiene aspecto de ser un )]TJ
/TT7 1 Tf
23.504 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.028 Tw
(chero similar)Tj
-37.9189 -1.2 TD
0 Tw
[(a)-250(l)0(a)-250(consola.)]TJ
0 -2.4 TD
0.2214 Tw
(En cualquier caso,)Tj
/TT11 1 Tf
8.2721 0 TD
0 Tw
(/dev/tty)Tj
/TT6 1 Tf
5.2722 0 TD
0.2213 Tw
(es siempre el terminal que estamos utilizando. Si leemos, leemos del)Tj
-13.5443 -1.2 TD
0.02 Tw
[(teclado. Cuando se trata de una v)15(entana, el teclado naturalmente sólo escribe en esa v)15(entana cuando la v)15(en-)]TJ
T*
0 Tw
(tana tiene el)Tj
/TT4 1 Tf
5.0806 0 TD
(foco)Tj
/TT6 1 Tf
1.9717 0 TD
(\(hemos dado click con el ratón en ella o algo similar\).)Tj
-7.0522 -2.4 TD
(Los )Tj
/TT7 1 Tf
1.75 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(cheros que representan terminales pueden encontrarse en)Tj
/TT11 1 Tf
23.0171 0 TD
(/dev)Tj
/TT6 1 Tf
2.4004 0 TD
(:)Tj
/TT11 1 Tf
8 0 0 8 133 474 Tm
(unix$ ls /dev/tty*)Tj
0 -1.5 TD
1.8 Tw
(/dev/ttyp0 /dev/ttyqa /dev/ttys4 /dev/ttyte /dev/ttyv8)Tj
T*
(/dev/ttyp1 /dev/ttyqb /dev/ttys5 /dev/ttytf /dev/ttyv9)Tj
T*
(/dev/ttyp2 /dev/ttyqc /dev/ttys6 /dev/ttyu0 /dev/ttyva)Tj
T*
(/dev/ttyp3 /dev/ttyqd /dev/ttys7 /dev/ttyu1 /dev/ttyvb)Tj
T*
(/dev/ttyp4 /dev/ttyqe /dev/ttys8 /dev/ttyu2 /dev/ttyvc)Tj
T*
(/dev/ttyp5 /dev/ttyqf /dev/ttys9 /dev/ttyu3 /dev/ttyvd)Tj
T*
(/dev/ttyp6 /dev/ttyr0 /dev/ttysa /dev/ttyu4 /dev/ttyve)Tj
T*
0 Tw
(...)Tj
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 348 Tm
0.2713 Tw
[(Pero para que sea tri)25(vial encontrar el )]TJ
/TT7 1 Tf
16.7838 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.2713 Tw
(chero que corresponde al terminal que usa nuestro proceso,)Tj
/TT11 1 Tf
-17.3399 -1.2 TD
0 Tw
(/dev/tty)Tj
/TT4 1 Tf
5.1281 0 TD
[(siempr)37(e)]TJ
/TT6 1 Tf
3.4563 0 TD
0.0774 Tw
(corresponde al terminal que usamos. Eso sí, en cada proceso)Tj
/TT11 1 Tf
25.2105 0 TD
0 Tw
(/dev/tty)Tj
/TT6 1 Tf
5.1282 0 TD
(correspon-)Tj
-38.9231 -1.2 TD
0.1443 Tw
(derá a un )Tj
/TT7 1 Tf
4.3475 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1443 Tw
(chero de terminal distinto. Esto no es un problema. Dado que UNIX sabe qué proceso está)Tj
-4.9036 -1.2 TD
0.0768 Tw
(haciendo la llamada para abrir)Tj
/TT11 1 Tf
12.7385 0 TD
0 Tw
(/dev/tty)Tj
/TT6 1 Tf
4.8008 0 TD
0.0769 Tw
[(,)-326.9(UNIX puede dar "el cambiazo" perfectamente y hacer que se)]TJ
-17.5393 -1.2 TD
0 Tw
(abra en realidad el terminal que está usando el proceso.)Tj
0 -2.4 TD
0.1116 Tw
[(Y)100(a)100( )-100(v)15(es que el)]TJ
/TT2 1 Tf
5.996 0 TD
[(terminal de contr)18(ol)]TJ
/TT6 1 Tf
8.787 0 TD
(de un proceso \(que es como se denomina\) es en realidad otro de los)Tj
-14.783 -1.2 TD
0 Tw
[(atrib)20(utos o elementos que tiene cada proceso en UNIX.)]TJ
/TT2 1 Tf
0 -3.6 TD
0.25 Tw
[(3. Ficher)18(os )250(abiertos)]TJ
/TT6 1 Tf
0 -1.56 TD
0.1678 Tw
[(Resulta instructi)25(v)20(o)20( )-20(v)15(er qué )]TJ
/TT7 1 Tf
11.609 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1679 Tw
[(cheros tiene abierto un proceso. V)111(amos a hacer un programa que abra un)]TJ
/TT7 1 Tf
-12.1651 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
-0.0001 Tc
0.0001 Tw
[(chero y lue)14.9(go se limite a dormir durante un tiempo, para darnos tiempo a jugar con el.)]TJ
-0.5562 -17.64 TD
0 Tc
0 Tw
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
36 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
38 0 obj
<<
/Length 2648
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-10-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(#include <stdio.h>)Tj
0 -1.5 TD
(#include <stdlib.h>)Tj
T*
(#include <unistd.h>)Tj
T*
(#include <fcntl.h>)Tj
T*
(#include <err.h>)Tj
0 -3 TD
(int)Tj
0 -1.5 TD
(main\(int argc, char* argv[]\))Tj
T*
({)Tj
2.4 -1.5 TD
1.8 Tw
(int fd;)Tj
0 -3 TD
0 Tw
(fd = open\("sleepfd.c", O_RDONLY\);)Tj
0 -1.5 TD
(if \(fd < 0\) {)Tj
2.4 -1.5 TD
(err\(1, "open: %s", "sleepfd.c"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(sleep\(3600\);)Tj
T*
(if \(close\(fd\) < 0\) {)Tj
2.4 -1.5 TD
(err\(1, "close"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(exit\(0\);)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 438 Tm
0.0416 Tw
[(Primero v)25(amos a ejecutarlo, pero pidiendo al shell que no espere a que termine antes de leer mas líneas de)]TJ
0 -1.2 TD
0 Tw
(comandos...)Tj
/TT11 1 Tf
8 0 0 8 133 408 Tm
(unix$ sleepfd &)Tj
0 -1.5 TD
([1] 93552)Tj
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 366 Tm
0.0536 Tw
(El ")Tj
/TT11 1 Tf
1.6005 0 TD
0 Tw
(&)Tj
/TT6 1 Tf
0.6001 0 TD
0.3036 Tc
[("a)303.6(l)]TJ
/TT7 1 Tf
1.7371 0 TD
0 Tc
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0536 Tw
[(nal de una línea de comandos es sintaxis de shell \(de nue)25(v)20(o)0(\))-303.7(y)-303.7(hace que shell continúe le)15(yendo)]TJ
-4.4938 -1.2 TD
0.0782 Tw
(líneas de comandos sin esperar a que el comando termine. El shell ha sido tan amable de decirnos que el)Tj
T*
0 Tw
(proceso tiene el pid)Tj
/TT11 1 Tf
8.0527 0 TD
(93552)Tj
/TT6 1 Tf
3.0005 0 TD
[(,)-250(pero v)25(amos a v)15(er qué procesos tenemos en cualquier caso.)]TJ
/TT11 1 Tf
8 0 0 8 133 324 Tm
(unix$ ps)Tj
1.2 -1.5 TD
[(448 ttys000)-2400(0:00.01 -bash)]TJ
T*
[(519 ttys000)-2400(0:00.01 acme)]TJ
-1.2 -1.5 TD
[(93552 ttys002)-2400(0:00.00 sleepfd)]TJ
T*
(...)Tj
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 234 Tm
0.0242 Tw
(Ahora que tenemos a)Tj
/TT11 1 Tf
8.8161 0 TD
0 Tw
(sleepfd)Tj
/TT6 1 Tf
4.475 0 TD
0.0243 Tw
(esperando, podemos utilizar el comando)Tj
/TT4 1 Tf
16.5053 0 TD
0 Tw
(lsof\(1\))Tj
/TT6 1 Tf
2.8851 0 TD
0.0243 Tw
(que lista )Tj
/TT7 1 Tf
3.659 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0243 Tw
(cheros abiertos.)Tj
-36.8967 -1.2 TD
0.1469 Tw
[(Este comando es útil tanto para v)15(er qué procesos tienen determinado )]TJ
/TT7 1 Tf
29.286 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1468 Tw
[(chero abierto como para v)15(er los)]TJ
/TT7 1 Tf
-29.8421 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0205 Tw
(cheros abiertos de un proceso. Con la opción)Tj
/TT11 1 Tf
18.3535 0 TD
0 Tw
(-p)Tj
/TT6 1 Tf
1.4707 0 TD
0.0205 Tw
(permite indicar el pid del proceso en que estamos intere-)Tj
-20.3803 -1.2 TD
0 Tw
(sados.)Tj
0 -17.4 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
39 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
41 0 obj
<<
/Length 8724
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-11-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(unix$ lsof -p 93552)Tj
0 -1.5 TD
1.2 Tw
[(COMMAND )-1200(PID)-600(USER FD TYPE)-600(DEVICE )600(SIZE/OFF)-2400(NODE )1200(NAME)]TJ
T*
0 Tw
[(sleepfd 93552 nemo)-1200(cwd )-1800(DIR )-1800(1,4)-3600(1020 7766070 /home/nemo/sot)]TJ
T*
[(sleepfd 93552 nemo)-1200(txt )-1800(REG )-1800(1,4)-3600(8700 7781483 /home/nemo/sot/sleepfd)]TJ
T*
1.8 Tw
[(sleepfd )1800(93552 )1800(nemo)-1200(txt REG 1,4 642448)-600(4991292 )1800(/usr/lib/dyld)]TJ
T*
0 Tw
[(sleepfd 93552 nemo)-2400(0u )-1200(CHR )-1200(16,2)-1200(0t638511 )-1800(1037)-600(/dev/tty02)]TJ
T*
[(sleepfd 93552 nemo)-2400(1u )-1200(CHR )-1200(16,2)-1200(0t638511 )-1800(1037)-600(/dev/tty02)]TJ
T*
[(sleepfd 93552 nemo)-2400(2u )-1200(CHR )-1200(16,2)-1200(0t638511 )-1800(1037)-600(/dev/tty02)]TJ
T*
[(sleepfd 93552 nemo)-2400(3r )-1200(REG)-2400(1,4 )-3600(398)-600(7781474 /home/nemo/sot/sleepfd.c)]TJ
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 582 Tm
0.0132 Tw
(La primera línea muestra que el proceso está usando)Tj
/TT11 1 Tf
21.3047 0 TD
0 Tw
(/home/nemo/sot)Tj
/TT6 1 Tf
8.4014 0 TD
0.0131 Tw
[(,)-263.1(que es un directorio \(la columna)]TJ
/TT11 1 Tf
-29.7061 -1.2 TD
0 Tw
(TYPE)Tj
/TT6 1 Tf
2.717 0 TD
(muestra)Tj
/TT11 1 Tf
3.4821 0 TD
(DIR)Tj
/TT6 1 Tf
1.8003 0 TD
0.0666 Tw
(\). Mirando la columna llamada)Tj
/TT11 1 Tf
12.9399 0 TD
0 Tw
(FD)Tj
/TT6 1 Tf
1.2002 0 TD
0.0666 Tw
[(,)-316.6(v)15(emos que indica)]TJ
/TT11 1 Tf
7.9995 0 TD
0 Tw
(cwd)Tj
/TT6 1 Tf
1.8003 0 TD
0.0667 Tw
[(,)-316.7(l)0(o)-316.7(que quiere decir que en)]TJ
-31.9394 -1.2 TD
0 Tw
(realidad se trata del directorio actual \()Tj
/TT4 1 Tf
15.1587 0 TD
[(curr)37(ent working dir)37(ectory)]TJ
/TT6 1 Tf
10.3132 0 TD
[(\))-250(del proceso.)]TJ
-25.4719 -2.4 TD
0.1787 Tw
[(La se)15(gunda línea muestra que también está usando)]TJ
/TT11 1 Tf
21.9079 0 TD
0 Tw
(/home/nemo/sot/sleepfd)Tj
/TT6 1 Tf
13.2021 0 TD
0.1787 Tw
[(,)-428.7(¡el ejecutable que)]TJ
-35.11 -1.2 TD
0.0039 Tw
(hemos ejecutado!. Y la columna)Tj
/TT11 1 Tf
13.1816 0 TD
0 Tw
(TYPE)Tj
/TT6 1 Tf
2.6543 0 TD
(muestra)Tj
/TT11 1 Tf
3.4194 0 TD
(txt)Tj
/TT6 1 Tf
1.8003 0 TD
0.004 Tw
[(,)-253.9(indicando que se está usando ese )]TJ
/TT7 1 Tf
13.9127 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.004 Tw
(chero como código)Tj
-35.5244 -1.2 TD
0.0096 Tw
[(\(o te)15(xto\) para paginar código hacia el se)15(gmento de te)15(xto, posiblemente. Igualmente, la tercera línea muestra)]TJ
T*
0 Tw
(que se está utilizando el código del enlazador dinámico)Tj
/TT11 1 Tf
22.353 0 TD
(dyld)Tj
/TT6 1 Tf
2.6504 0 TD
(para suministrar código.)Tj
-25.0034 -2.4 TD
0.0986 Tw
(Las últimas cuatro )Tj
/TT7 1 Tf
7.9325 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0986 Tw
[(las son nuestro objeti)25(v)20(o)0(.)-348.6(Como puedes v)15(e)0(r)40(,)-348.6(la)-348.6(columna)]TJ
/TT11 1 Tf
22.9222 0 TD
0 Tw
(FD)Tj
/TT6 1 Tf
1.5488 0 TD
(indica)Tj
/TT11 1 Tf
2.792 0 TD
(0u)Tj
/TT6 1 Tf
1.2002 0 TD
(,)Tj
/TT11 1 Tf
0.5986 0 TD
(1u)Tj
/TT6 1 Tf
1.2002 0 TD
(,)Tj
/TT11 1 Tf
0.5986 0 TD
(2u)Tj
/TT6 1 Tf
1.5489 0 TD
(y)Tj
/TT11 1 Tf
0.8487 0 TD
(3r)Tj
/TT6 1 Tf
1.2002 0 TD
(.)Tj
-42.947 -1.2 TD
0.0433 Tw
[(Además, puedes v)15(er que)]TJ
/TT11 1 Tf
10.1826 0 TD
0 Tw
(0)Tj
/TT6 1 Tf
0.6001 0 TD
(,)Tj
/TT11 1 Tf
0.5433 0 TD
(1)Tj
/TT6 1 Tf
0.8934 0 TD
(y)Tj
/TT11 1 Tf
0.7933 0 TD
(2)Tj
/TT6 1 Tf
0.8934 0 TD
0.0433 Tw
(se re)Tj
/TT7 1 Tf
1.9032 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0433 Tw
(eren a)Tj
/TT11 1 Tf
2.7512 0 TD
0 Tw
(/dev/ttys002)Tj
/TT6 1 Tf
7.4945 0 TD
0.0432 Tw
(\(¡un terminal!\). Estos tres son la entrada,)Tj
-26.611 -1.2 TD
0.0907 Tw
(salida y salida de error estándar de nuestro proceso. La cuarta )Tj
/TT7 1 Tf
25.8756 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0907 Tw
(la indica que el descriptor)Tj
/TT11 1 Tf
11.0326 0 TD
0 Tw
(3)Tj
/TT6 1 Tf
0.9408 0 TD
0.0907 Tw
(se re)Tj
/TT7 1 Tf
1.9506 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0907 Tw
(ere al)Tj
/TT7 1 Tf
-40.9119 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
/TT11 1 Tf
2.4707 0 TD
(sleepfd.c)Tj
/TT6 1 Tf
5.4009 0 TD
[(,)-250(que es el )]TJ
/TT7 1 Tf
4.2485 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero que nuestro programa ha abierto.)Tj
-13.2324 -2.4 TD
[(P)15(ara no dejar programas danzando inútilmente, v)25(amos a matar nuestro proceso...)]TJ
/TT11 1 Tf
8 0 0 8 133 396 Tm
(unix$ kill 93552)Tj
0 -1.5 TD
0.6 Tw
[([1]+ Terminated:)-600(15 )-4800(sleepfd)]TJ
T*
0 Tw
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 354 Tm
0.156 Tw
(El comando)Tj
/TT4 1 Tf
5.3662 0 TD
0 Tw
(kill\(1\))Tj
/TT6 1 Tf
2.8494 0 TD
0.1559 Tw
(puede utilizarse para matar procesos, basta darle el pid de los mismos. El shell, de)Tj
-8.2156 -1.2 TD
0.01 Tw
[(nue)25(v)20(o)0(,)-260(h)0(a)-260(sido tan amable de informar que uno de los comandos que había dejado ejecutando ha terminado.)]TJ
0 -2.4 TD
0.0591 Tw
[(En el futuro, si te pre)15(guntas si se te ha olvidado en tu programa cerrar algún descriptor)40(,)-309.1(podrías incluir un)]TJ
/TT7 1 Tf
0 -1.2 TD
0 Tw
(ß)Tj
/TT6 1 Tf
0.5562 0 TD
-0.0001 Tc
0.0001 Tw
[(ag que haga)-250.1(que tu programa duerma al )]TJ
/TT7 1 Tf
16.0438 0 TD
0 Tc
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
[(nal y lue)15(go utilizar)]TJ
/TT4 1 Tf
7.7604 0 TD
(lsof\(1\))Tj
/TT6 1 Tf
2.8608 0 TD
(para inspeccionarlo.)Tj
/TT2 1 Tf
-27.7774 -3.6 TD
[(4. )-250(P)20(ermisos y contr)18(ol de acceso)]TJ
/TT6 1 Tf
0 -1.56 TD
0.051 Tw
[(Resulta instructi)25(v)20(o)20( )-20(considerar los permisos y las comprobaciones que hace UNIX para intentar ase)15(gurar el)]TJ
0 -1.2 TD
0.0182 Tw
(acceso a )Tj
/TT7 1 Tf
3.6448 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0182 Tw
(cheros. Como sabes, cada )Tj
/TT7 1 Tf
10.625 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0182 Tw
(chero tiene una)Tj
/TT4 1 Tf
6.4125 0 TD
[(lista de contr)45(ol de acceso)]TJ
/TT6 1 Tf
10.2475 0 TD
[(,)-268.1(implementada en un único)]TJ
-32.0422 -1.2 TD
0.0258 Tw
(entero donde cada bit indica un permiso para el dueño, el grupo de usuarios al que pertenece el )Tj
/TT7 1 Tf
38.6441 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0258 Tw
(chero o el)Tj
-39.2002 -1.2 TD
0 Tw
(resto del mundo.)Tj
0 -2.4 TD
0.0165 Tw
(Pues bien, esta lista se comprueba)Tj
/TT4 1 Tf
13.9564 0 TD
[(dur)15(ante open)]TJ
/TT6 1 Tf
5.3062 0 TD
[(.)-266.5(E)0(n)-266.5(ningún caso)]TJ
/TT11 1 Tf
6.9815 0 TD
0 Tw
(read)Tj
/TT6 1 Tf
2.6669 0 TD
(o)Tj
/TT11 1 Tf
0.7665 0 TD
(write)Tj
/TT6 1 Tf
3.267 0 TD
0.0165 Tw
(comprueban los permisos)Tj
-32.9445 -1.2 TD
0 Tw
(del )Tj
/TT7 1 Tf
1.6454 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1737 Tw
(chero en que operan. Se supone que si un proceso ha tenido permisos para abrir un )Tj
/TT7 1 Tf
36.0746 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1737 Tw
(chero para)Tj
-38.8323 -1.2 TD
0 Tw
[(escribir en el, por ejemplo, es le)15(gítimo que)]TJ
/TT11 1 Tf
17.3131 0 TD
(write)Tj
/TT6 1 Tf
3.2505 0 TD
(pueda proceder para dicho )Tj
/TT7 1 Tf
10.8276 0 TD
(Þ)Tj
/TT6 1 Tf
0.5561 0 TD
(chero desde ese proceso.)Tj
-31.9474 -2.4 TD
(Las)Tj
/TT2 1 Tf
1.7305 0 TD
0.0367 Tw
[(listas de contr)18(ol de acceso)]TJ
/TT6 1 Tf
11.3579 0 TD
[(\(A)40(CL en inglés\) son similares a los vigilantes de se)15(guridad en la puerta de)]TJ
-13.0884 -1.2 TD
0 Tw
(una )Tj
/TT7 1 Tf
1.702 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0082 Tw
(esta. En este caso el vigilante es UNIX y comprueba para cada proceso \(visitante de la )Tj
/TT7 1 Tf
34.9227 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5561 0 TD
0.0082 Tw
(esta\) si puede)Tj
-37.7371 -1.2 TD
0.0228 Tw
[(o)-272.8(n)0(o)-272.8(acceder a la misma \(al )]TJ
/TT7 1 Tf
11.3486 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0228 Tw
(chero\). Una alternat)Tj
8.0134 0 TD
-0.025 Tc
0.0728 Tw
(iva a )Tj
2.1611 0 TD
0 Tc
0.0227 Tw
(una lista de control de acceso es utilizar algo similar)Tj
-22.0792 -1.2 TD
0.0887 Tw
[(a)-338.7(una "lla)20(v)15(e)0(")-338.7(que permite la entrada. En este caso, esa "lla)20(v)15(e)0(")-338.7(suele denominarse)]TJ
/TT2 1 Tf
33.6244 0 TD
0 Tw
(capability)Tj
/TT6 1 Tf
4.5614 0 TD
0.0888 Tw
[(e)-338.7(indica que)]TJ
-38.1858 -1.2 TD
0 Tw
(quien la posee puede hacer algo con algún recurso \(abrir una puerta en el ejemplo\).)Tj
0 -2.4 TD
0.165 Tw
(Aunque los )Tj
/TT7 1 Tf
5.163 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.165 Tw
[(cheros están prote)15(gidos con una A)40(CL,)]TJ
/TT11 1 Tf
16.4588 0 TD
0 Tw
(read)Tj
/TT6 1 Tf
2.4004 0 TD
(,)Tj
/TT11 1 Tf
0.6649 0 TD
(write)Tj
/TT6 1 Tf
3.4154 0 TD
0.1649 Tw
[(y)-414.9(e)0(l)-414.9(resto de operaciones sobre un)]TJ
/TT7 1 Tf
-28.6587 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1172 Tw
(chero abierto operan utilizando el descriptor como)Tj
/TT4 1 Tf
21.2291 0 TD
0 Tw
(capability)Tj
/TT6 1 Tf
3.999 0 TD
0.1172 Tw
[(.)-367.2(Una v)15(ez tienes el descriptor abierto para)]TJ
-25.7843 -3.84 TD
0 Tw
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
42 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
46 0 obj
<<
/Length 5665
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-12-)Tj
-20.767 -3.6 TD
(escribir puedes escribir en el )Tj
/TT7 1 Tf
11.6895 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
[(chero. Y)100(a)-250(no)-250(es)-250(preciso v)20(olv)15(er a comprobar los permisos.)]TJ
-12.2456 -2.4 TD
0.1325 Tw
(La estructura de datos a la que apunta un descriptor de )Tj
/TT7 1 Tf
23.4765 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1325 Tw
[(chero, que v)15(eremos más adelante, contiene un)]TJ
-24.0327 -1.2 TD
0.1366 Tw
[(campo que re)15(gistra para qué se abrió el )]TJ
/TT7 1 Tf
16.9596 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1366 Tw
[(chero \(leer)40(,)-386.7(escribir)40(,)-386.7(leer y escribir\) y posteriormente)]TJ
/TT11 1 Tf
22.3924 0 TD
0 Tw
(read)Tj
/TT6 1 Tf
2.7871 0 TD
(y)Tj
/TT11 1 Tf
-42.6953 -1.2 TD
(write)Tj
/TT6 1 Tf
3.2505 0 TD
(tan sólo han de comprobar si el descriptor es válido para ellos.)Tj
-3.2505 -2.4 TD
(¡Curiosamente el uso de )Tj
/TT7 1 Tf
9.9419 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
[(cheros en UNIX combina tanto A)40(CLs como capabilities!)]TJ
/TT2 1 Tf
-10.498 -3.6 TD
0.25 Tw
(5. Offsets)Tj
/TT6 1 Tf
0 -1.56 TD
0.0199 Tw
[(Hay una pre)15(gunta que se)15(guramente te has hecho. ¿Cómo saben)]TJ
/TT11 1 Tf
25.6324 0 TD
0 Tw
(read)Tj
/TT6 1 Tf
2.6703 0 TD
(y)Tj
/TT11 1 Tf
0.7699 0 TD
(write)Tj
/TT6 1 Tf
3.2704 0 TD
0.0198 Tw
(en qué posición del )Tj
/TT7 1 Tf
8.0772 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
-40.9764 -1.2 TD
(han de trabajar? Esto es, ¿En qué)Tj
/TT4 1 Tf
13.4941 0 TD
[(of)18(fset)]TJ
/TT6 1 Tf
2.3985 0 TD
(debe escribir)Tj
/TT11 1 Tf
5.3862 0 TD
(write)Tj
/TT6 1 Tf
3.0005 0 TD
[(?)-250(o)-250(¿Desde qué)]TJ
/TT4 1 Tf
6.3306 0 TD
[(of)18(fset)]TJ
/TT6 1 Tf
2.3985 0 TD
(debe leer)Tj
/TT11 1 Tf
3.8862 0 TD
(read)Tj
/TT6 1 Tf
2.4004 0 TD
(?)Tj
-39.2951 -2.4 TD
0.0418 Tw
(La respuesta procede de)Tj
/TT11 1 Tf
10.051 0 TD
0 Tw
(open)Tj
/TT6 1 Tf
2.4004 0 TD
0.0418 Tw
[(.)-291.8(Cuando se abre un )]TJ
/TT7 1 Tf
8.3736 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0418 Tw
(chero, el sistema mantiene la pista de en qué posición)Tj
-21.3811 -1.2 TD
0 Tw
(del )Tj
/TT7 1 Tf
1.5819 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1102 Tw
[(chero se está trabajando. Inicialmente este of)25(fset es cero. Cuando se escribe, se escribe en el of)25(fset)]TJ
-2.138 -1.2 TD
0.0632 Tw
(para el )Tj
/TT7 1 Tf
3.0688 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0632 Tw
(chero abierto y un efecto lateral de escribir)Tj
/TT4 1 Tf
17.8855 0 TD
0 Tw
(n)Tj
/TT6 1 Tf
0.8132 0 TD
0.0632 Tw
[(bytes es que el of)25(fset aumenta en)]TJ
/TT4 1 Tf
13.8847 0 TD
0 Tw
(n)Tj
/TT6 1 Tf
0.8132 0 TD
0.0632 Tw
(unidades. Igual)Tj
-37.0215 -1.2 TD
0.0043 Tw
(sucede en)Tj
/TT11 1 Tf
4.1732 0 TD
0 Tw
(read)Tj
/TT6 1 Tf
2.4004 0 TD
0.0043 Tw
[(.)-254.3(Cuando se lee, se lee desde el of)25(fset que UNIX mantiene para el )]TJ
/TT7 1 Tf
26.4693 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0043 Tw
(chero abierto. Si se leen)Tj
/TT4 1 Tf
-33.599 -1.2 TD
0 Tw
(n)Tj
/TT6 1 Tf
0.8416 0 TD
0.0916 Tw
[(bytes, el of)25(fset aumenta en)]TJ
/TT4 1 Tf
11.3734 0 TD
0 Tw
(n)Tj
/TT6 1 Tf
0.5 0 TD
0.0916 Tw
[(.)-341.6(Dicho de otro modo, los )]TJ
/TT7 1 Tf
10.993 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0916 Tw
(chero se leen y escriben)Tj
/TT2 1 Tf
10.2589 0 TD
0 Tw
(secuencialmente)Tj
/TT6 1 Tf
7.2841 0 TD
(uti-)Tj
-41.8071 -1.2 TD
(lizando)Tj
/TT11 1 Tf
3.1998 0 TD
(read)Tj
/TT6 1 Tf
2.6568 0 TD
(y)Tj
/TT11 1 Tf
0.7564 0 TD
(write)Tj
/TT6 1 Tf
3.0005 0 TD
0.0063 Tw
[(.)-256.4(S)0(i)-256.4(vuelv)15(es a mirar la salida de)]TJ
/TT4 1 Tf
12.7817 0 TD
0 Tw
(lsof)Tj
/TT6 1 Tf
1.7011 0 TD
0.0063 Tw
[(que mostramos anteriormente, v)15(erás que una de)]TJ
-24.0963 -1.2 TD
0 Tw
[(las columnas indica cuál es el of)25(fset para cada descriptor)55(.)]TJ
0 -2.4 TD
(Por ejemplo, considera este programa:)Tj
/TT11 1 Tf
8 0 0 8 133 434.4 Tm
(#include <stdlib.h>)Tj
0 -1.5 TD
(#include <fcntl.h>)Tj
T*
(#include <unistd.h>)Tj
T*
(#include <err.h>)Tj
T*
(#include <string.h>)Tj
0 -3 TD
(int)Tj
0 -1.5 TD
(main\(int argc, char* argv[]\))Tj
T*
({)Tj
2.4 -1.5 TD
1.8 Tw
[(int fd,)-600(i, )1800(n;)]TJ
0 -3 TD
0 Tw
(fd = open\("afile", O_WRONLY|O_CREAT, 0644\);)Tj
0 -1.5 TD
(if \(fd < 0\) {)Tj
2.4 -1.5 TD
(err\(1, "afile"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(for \(i = 1; i < argc; i++\) {)Tj
2.4 -1.5 TD
[(n)-600(=)-600(strlen\(argv[i]\);)]TJ
T*
(if \(write\(fd, argv[i], n\) != n\) {)Tj
2.4 -1.5 TD
(close\(fd\);)Tj
T*
(err\(1, "write"\);)Tj
-2.4 -1.5 TD
(})Tj
-2.4 -1.5 TD
(})Tj
T*
(if \(close\(fd\) < 0\) {)Tj
2.4 -1.5 TD
(err\(1, "close"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(exit\(0\);)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 92.4 Tm
0.0454 Tw
[(El programa escribe sus ar)18(gumentos en el )]TJ
/TT7 1 Tf
17.2109 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
/TT11 1 Tf
2.5161 0 TD
(afile)Tj
/TT6 1 Tf
3.0005 0 TD
0.0454 Tw
[(.)-295.4(L)0(a)-295.4(llamada a)]TJ
/TT11 1 Tf
6.0952 0 TD
0 Tw
(open)Tj
/TT6 1 Tf
2.6958 0 TD
0.0454 Tw
(abre el )Tj
/TT7 1 Tf
3.0332 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
/TT11 1 Tf
2.5162 0 TD
(afile)Tj
/TT6 1 Tf
3.296 0 TD
(para)Tj
-41.4762 -1.2 TD
0.0463 Tw
(escribir en el \()Tj
/TT11 1 Tf
5.886 0 TD
0 Tw
(O_WRONLY)Tj
/TT6 1 Tf
4.8008 0 TD
0.0463 Tw
[(\). Como v)15(erás, el se)15(gundo ar)18(gumento son )]TJ
/TT7 1 Tf
17.134 0 TD
0 Tw
(ß)Tj
/TT6 1 Tf
0.5562 0 TD
0.0463 Tw
(ags en un único entero. Se utiliza un)Tj
/TT4 1 Tf
-28.3769 -1.2 TD
0 Tw
(or)Tj
/TT6 1 Tf
1.2688 0 TD
0.1296 Tw
[(para acti)25(v)25(a)0(r)-379.6(los bits que se desean en el entero.)]TJ
/TT11 1 Tf
20.2104 0 TD
0 Tw
(O_CREAT)Tj
/TT6 1 Tf
4.5803 0 TD
0.1297 Tw
[(indica que si no e)15(xiste queremos crear el)]TJ
-26.0594 -4.44 TD
0 Tw
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
47 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
49 0 obj
<<
/Length 5921
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-13-)Tj
/TT7 1 Tf
-20.767 -3.6 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0028 Tw
(chero. En dicho caso, cuando el )Tj
/TT7 1 Tf
12.9563 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0027 Tw
[(chero no e)15(xiste y se crea, el tercer ar)18(gumento indica qué permisos quere-)]TJ
-14.0686 -1.2 TD
0 Tw
[(mos para el nue)25(v)20(o)20( )]TJ
/TT7 1 Tf
7.5082 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero.)Tj
-8.0644 -2.4 TD
[(V)111(amos a ejecutarlo por primera v)15(ez tras comprobar que)]TJ
/TT11 1 Tf
22.3921 0 TD
(afile)Tj
/TT6 1 Tf
3.2505 0 TD
[(no e)15(xiste.)]TJ
/TT11 1 Tf
8 0 0 8 133 654 Tm
(unix$ ls -l afile)Tj
0 -1.5 TD
(ls: afile: No such file or directory)Tj
T*
(unix$ writef aa bb cc)Tj
/TT6 1 Tf
10 0 0 10 72 612 Tm
(Si inspeccionamos)Tj
/TT11 1 Tf
7.7212 0 TD
(afile)Tj
/TT6 1 Tf
3.2505 0 TD
[(v)15(eremos que tiene 9 bytes)]TJ
/TT11 1 Tf
8 0 0 8 133 594 Tm
(unix$ ls -l afile)Tj
0 -1.5 TD
0.6 Tw
[(-rw-r--r-- 1)-600(nemo staff 9)-600(Aug )600(20 )600(15:49 )600(afile)]TJ
/TT6 1 Tf
10 0 0 10 72 564 Tm
0 Tw
[(y)-250(que su contenido son los ar)18(gumentos de)]TJ
/TT11 1 Tf
16.9239 0 TD
(writef)Tj
/TT6 1 Tf
3.8506 0 TD
(\(con un )Tj
/TT7 1 Tf
3.2769 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(n de línea añadido tras cada uno\):)Tj
/TT11 1 Tf
8 0 0 8 133 546 Tm
(unix$ cat afile)Tj
0 -1.5 TD
(aa)Tj
T*
(bb)Tj
T*
(cc)Tj
/TT6 1 Tf
10 0 0 10 72 492 Tm
(Podemos utilizar)Tj
/TT4 1 Tf
6.999 0 TD
(xd\(1\))Tj
/TT6 1 Tf
2.3599 0 TD
[(para v)15(er los bytes y caracteres que contiene el )]TJ
/TT7 1 Tf
18.5592 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero:)Tj
/TT11 1 Tf
8 0 0 8 133 474 Tm
(unix$ xd -b -c afile)Tj
0 -1.5 TD
[(0000000 )-600(61)-600(61 0a 62 62 0a 63 63 0a)]TJ
3.6 -1.5 TD
0.6 Tw
[(0)-1800(a)-1200(a)-600(\\)0(n)-1200(b)-1200(b)-600(\\n c c)-600(\\)0(n)]TJ
-3.6 -1.5 TD
0 Tw
(0000009)Tj
/TT6 1 Tf
10 0 0 10 72 408 Tm
0.0392 Tw
[(La primera columna indica el of)25(fset en que aparecen los bytes que)]TJ
/TT4 1 Tf
27.157 0 TD
0 Tw
(xd)Tj
/TT6 1 Tf
1.2331 0 TD
0.0393 Tw
(muestra a continuación. Los )Tj
/TT7 1 Tf
11.6816 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0393 Tw
(nes de)Tj
-40.628 -1.2 TD
0.0847 Tw
[(línea son bytes con el v)25(alor)]TJ
/TT11 1 Tf
11.6468 0 TD
0 Tw
(0xa)Tj
/TT6 1 Tf
2.1349 0 TD
(\()Tj
/TT11 1 Tf
0.333 0 TD
(10)Tj
/TT6 1 Tf
1.5348 0 TD
0.0846 Tw
[(en decimal\). Como v)15(erás, hemos hecho seis writes y se han escrito)]TJ
-15.6495 -1.2 TD
0.1796 Tw
(secuencialmente en el )Tj
/TT7 1 Tf
9.5617 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1796 Tw
(chero. Esto quiere decir que el primer)Tj
/TT11 1 Tf
16.5839 0 TD
0 Tw
(write)Tj
/TT6 1 Tf
3.4301 0 TD
0.1796 Tw
(ha escrito en la posición)Tj
/TT11 1 Tf
10.8116 0 TD
0 Tw
(0)Tj
/TT6 1 Tf
1.0297 0 TD
(del)Tj
/TT7 1 Tf
-41.9731 -1.2 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0392 Tw
[(chero: ha utilizado el of)25(fset)]TJ
/TT11 1 Tf
11.3608 0 TD
0 Tw
(0)Tj
/TT6 1 Tf
0.6001 0 TD
[(.)-289.1(E)0(l)-289.1(s)0(e)15(gundo)]TJ
/TT11 1 Tf
5.324 0 TD
(write)Tj
/TT6 1 Tf
3.2896 0 TD
0.0391 Tw
(ha escrito un ")Tj
/TT11 1 Tf
5.8849 0 TD
0 Tw
(\\n)Tj
/TT6 1 Tf
1.2002 0 TD
0.0391 Tw
[(")-289.1(tras escribir el primer ar)18(gumento, y)]TJ
-28.2157 -1.2 TD
0.0042 Tw
[(ha escrito a partir del of)25(fset)]TJ
/TT11 1 Tf
11.2175 0 TD
0 Tw
(2)Tj
/TT6 1 Tf
0.8543 0 TD
0.0042 Tw
(en el )Tj
/TT7 1 Tf
2.1739 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0042 Tw
(chero. El tercer)Tj
/TT11 1 Tf
6.3974 0 TD
0 Tw
(write)Tj
/TT6 1 Tf
3.2547 0 TD
0.0042 Tw
[(ha escrito el se)15(gundo ar)18(gumento en la posición)]TJ
/TT11 1 Tf
-24.4539 -1.2 TD
0 Tw
(3)Tj
/TT6 1 Tf
0.6001 0 TD
[(.)-250(Y)-250(así sucesi)25(v)25(amente.)]TJ
-0.6001 -2.4 TD
0.0281 Tw
(Por cierto, el tamaño del )Tj
/TT7 1 Tf
10.1927 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0281 Tw
(chero es)Tj
/TT11 1 Tf
3.6099 0 TD
0 Tw
(9)Tj
/TT6 1 Tf
0.8782 0 TD
0.028 Tw
[(puesto que el mayor of)25(fset escrito ha sido el)]TJ
/TT11 1 Tf
18.0834 0 TD
0 Tw
(8)Tj
/TT6 1 Tf
0.8781 0 TD
0.028 Tw
[(y)-278(empezamos a contar)]TJ
-34.1985 -1.2 TD
0 Tw
(en)Tj
/TT11 1 Tf
1.1976 0 TD
(0)Tj
/TT6 1 Tf
0.6001 0 TD
0.0038 Tw
[(.)-253.8(Lue)15(go el )]TJ
/TT7 1 Tf
4.2728 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0038 Tw
(chero tiene)Tj
/TT11 1 Tf
4.6717 0 TD
0 Tw
(9)Tj
/TT6 1 Tf
0.8539 0 TD
0.0039 Tw
(bytes escritos en total. Más allá no hemos escrito nunca. Dicho de otro modo,)Tj
-12.1522 -1.2 TD
0 Tw
(el tamaño del )Tj
/TT7 1 Tf
5.6367 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero está determinado por hasta dónde hemos escrito en el )Tj
/TT7 1 Tf
24.0469 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero.)Tj
-30.7959 -2.4 TD
[(Si ejecutamos el programa una se)15(gunda v)15(ez, v)15(eremos mejor qué supone utilizar un of)25(fset.)]TJ
/TT11 1 Tf
8 0 0 8 133 258 Tm
(unix$ writef x y)Tj
0 -1.5 TD
(unix$ ls -l afile)Tj
T*
0.6 Tw
[(-rw-r--r-- 1)-600(nemo staff 9)-600(Aug )600(20 )600(15:49 )600(afile)]TJ
T*
0 Tw
(unix$ cat afile)Tj
T*
(x)Tj
T*
(y)Tj
T*
(b)Tj
T*
(cc)Tj
T*
(unix$ xd -b -c afile)Tj
T*
[(0000000 )-600(78)-600(0a 79 0a 62 0a 63 63 0a)]TJ
3.6 -1.5 TD
0.6 Tw
[(0)-1800(x)-600(\\n y)-600(\\n b)-600(\\n c c)-600(\\)0(n)]TJ
-3.6 -1.5 TD
0 Tw
(0000009)Tj
/TT6 1 Tf
10 0 0 10 72 96 Tm
0.1617 Tw
[(Lo primero que v)15(emos es que ¡el )]TJ
/TT7 1 Tf
14.5295 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1617 Tw
(chero sigue teniendo 9 bytes!. Dicho de otro modo, aunque hemos)Tj
-15.0857 -1.2 TD
0.0087 Tw
[(escrito más v)15(eces, el tamaño no ha aumentado. El primer ar)18(gumento se ha escrito al principio, lo que quiere)]TJ
T*
0.007 Tw
(decir que el primer)Tj
/TT11 1 Tf
7.8576 0 TD
0 Tw
(write)Tj
/TT6 1 Tf
3.2575 0 TD
0.007 Tw
[(ha utilizado un of)25(fset)]TJ
/TT11 1 Tf
8.7227 0 TD
0 Tw
(0)Tj
/TT6 1 Tf
0.8571 0 TD
0.0069 Tw
[(y)-257(h)0(a)-256.9(escrito un byte. El se)15(gundo)]TJ
/TT11 1 Tf
13.0861 0 TD
0 Tw
(write)Tj
/TT6 1 Tf
3.2574 0 TD
0.0069 Tw
(ha escrito el )Tj
/TT7 1 Tf
5.1018 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(n)Tj
-42.6963 -4.8 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
50 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
52 0 obj
<<
/Length 6563
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-14-)Tj
-20.767 -3.6 TD
[(de línea en el of)25(fset)]TJ
/TT11 1 Tf
8.0546 0 TD
(1)Tj
/TT6 1 Tf
0.6001 0 TD
[(,)-250(dado que el primer write escribió un byte.)-500(Etcétera.)]TJ
-8.6547 -2.4 TD
0.2159 Tw
[(Otro detalle curioso es que después del te)15(xto escrito \(")]TJ
/TT11 1 Tf
23.6908 0 TD
0 Tw
(x\\ny\\n)Tj
/TT6 1 Tf
3.6006 0 TD
0.2159 Tw
[("\) puedes v)15(er que el )]TJ
/TT7 1 Tf
9.2752 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.216 Tw
(chero contiene)Tj
-37.1228 -1.2 TD
0 Tw
(")Tj
/TT11 1 Tf
0.4082 0 TD
(b\\ncc\\n)Tj
/TT6 1 Tf
4.2007 0 TD
0.0188 Tw
[(". Lo único que sucede es que esos bytes se escribieron la v)15(ez anterior que ejecutamos)]TJ
/TT11 1 Tf
34.9882 0 TD
0 Tw
(writef)Tj
/TT6 1 Tf
-39.5971 -1.2 TD
0.029 Tw
[(y)-279(esta v)15(ez no los hemos vuelto a escribir)40(,)-279(lue)15(go tienen el mismo v)25(alor que tenían. Recuerda que)]TJ
/TT11 1 Tf
38.8596 0 TD
0 Tw
(write)Tj
/TT2 1 Tf
3.2795 0 TD
(no)Tj
/TT6 1 Tf
-42.1391 -1.2 TD
(inserta,)Tj
/TT11 1 Tf
3.1655 0 TD
(write)Tj
/TT6 1 Tf
3.2505 0 TD
(\(re\)escribe.)Tj
-6.416 -2.4 TD
0.0489 Tw
[(Y)-298.9(una cosa más. Ahora el )]TJ
/TT7 1 Tf
10.8178 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0489 Tw
(chero tiene 4 líneas, pero no obstante su tamaño sigue siendo 9 bytes. Aunque)Tj
-11.374 -1.2 TD
-0.0003 Tc
0.063 Tw
[(tenga)-312.9(más líneas, el )]TJ
/TT7 1 Tf
8.3263 0 TD
0 Tc
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
-0.0001 Tc
0.0628 Tw
[(chero no es mas grande que antes. Que tenga)-312.8(más líneas se debe simplemente a que)]TJ
-8.8824 -1.2 TD
0 Tc
0 Tw
(hay más ")Tj
/TT11 1 Tf
3.9629 0 TD
(\\n)Tj
/TT6 1 Tf
1.2002 0 TD
[(")-250(escritos en el )]TJ
/TT7 1 Tf
6.1284 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero.)Tj
-11.8477 -2.4 TD
0.0421 Tw
[(P)15(ara v)15(er estas cosas te puede resultar cómodo utilizar)]TJ
/TT4 1 Tf
21.9241 0 TD
0 Tw
(wc\(1\))Tj
/TT6 1 Tf
2.2769 0 TD
0.042 Tw
[(,)-292.1(que cuenta líneas, palabras y caracteres en un)]TJ
/TT7 1 Tf
-24.201 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero, o en la entrada si no indicas )Tj
/TT7 1 Tf
14.0781 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero alguno.)Tj
/TT11 1 Tf
8 0 0 8 133 546 Tm
(unix$ wc afile)Tj
4.2 -1.5 TD
[(4)-4200(4)-4200(9)-600(afile)]TJ
-4.2 -1.5 TD
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 492 Tm
[(¿Dónde está el of)25(fset? La )]TJ
/TT7 1 Tf
10.3866 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(gura 3 muestra qué aspecto tiene la estructura de datos que usa UNIX.)Tj
ET
0 G
1 J 1 j 0.4 w 10 M []0 d
1 i 
181.8 445.2 m
181.8 429.302 168.898 416.4 153 416.4 c
137.102 416.4 124.2 429.302 124.2 445.2 c
124.2 461.098 137.102 474 153 474 c
168.898 474 181.8 461.098 181.8 445.2 c
s
BT
10 0 0 10 137.17 443 Tm
(Proceso)Tj
ET
153 380.4 m
151.2 387.6 l
154.8 387.6 l
f
0.1 w 
153 380.4 m
151.2 387.6 l
154.8 387.6 l
s
0.4 w 
153.03 416.43 m
153.03 387.63 l
S
BT
10 0 0 10 159 402.2 Tm
(Descriptores)Tj
0 -1.2 TD
(de )Tj
/TT7 1 Tf
1.1938 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
/TT11 1 Tf
-6.25 -1.92 TD
(0)Tj
ET
124.2 366 72 14.4 re
S
BT
10 0 0 10 114 356.6 Tm
(1)Tj
ET
124.2 351.6 72 14.4 re
S
BT
10 0 0 10 114 342.2 Tm
(2)Tj
ET
124.2 337.2 72 14.4 re
S
BT
10 0 0 10 114 327.8 Tm
(3)Tj
ET
124.2 322.8 72 14.4 re
S
BT
10 0 0 10 151.2 313.4 Tm
(...)Tj
-3.72 -1.44 TD
(n)Tj
ET
124.2 294 72 14.4 re
S
232.2 330 m
225 328.2 l
225 331.8 l
f
0.1 w 
232.2 330 m
225 328.2 l
225 331.8 l
s
0.4 w 
160.23 330.03 m
225.03 330.03 l
232.2 308.4 108 43.2 re
S
BT
10 0 0 10 239.4 342.2 Tm
(offset: 4)Tj
T*
(mode: O_WRONLY)Tj
T*
(file:)Tj
ET
282.6 243.6 m
280.8 250.8 l
284.4 250.8 l
f
0.1 w 
282.6 243.6 m
280.8 250.8 l
284.4 250.8 l
s
0.4 w 
282.6 315.6 m
300.6 315.6 l
312.6 315.6 318.6 309.6 318.6 297.6 c
318.6 285.6 312.6 279.6 300.6 279.6 c
288.6 279.6 282.6 273.72 282.6 261.96 c
282.6 244.32 l
282.6 229.2 14.4 14.4 re
S
BT
/TT6 1 Tf
10 0 0 10 287.3 234.2 Tm
(x)Tj
ET
297 229.2 14.4 14.4 re
S
BT
10 0 0 10 300.31 234.2 Tm
(\\n)Tj
ET
311.4 229.2 14.4 14.4 re
S
BT
10 0 0 10 316.1 234.2 Tm
(y)Tj
ET
325.8 229.2 14.4 14.4 re
S
BT
10 0 0 10 329.11 234.2 Tm
(\\n)Tj
ET
340.2 229.2 72 14.4 re
S
BT
10 0 0 10 372.45 234.2 Tm
[(...)-5064(a)]TJ
/TT7 1 Tf
6.2578 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(le)Tj
ET
340.2 243.6 m
341.784 250.872 l
345.024 249.288 l
f
0.1 w 
340.2 243.6 m
341.784 250.872 l
345.024 249.288 l
s
0.4 w 
318.6 344.4 m
336.6 344.4 l
348.6 344.4 360.6 344.4 372.6 344.4 c
384.6 344.4 382.248 327.708 365.544 294.324 c
340.488 244.248 l
S
BT
10 0 0 10 237.79 356.6 Tm
(Fichero abierto)Tj
/TT2 1 Tf
-14.079 -15.04 TD
0.185 Tw
(Figura 3:)Tj
/TT4 1 Tf
4.5917 0 TD
[(El of)18(fset par)15(a)-435(lectur)15(as y escritur)15(as se guar)37(da fuer)15(a)-435.1(del descriptor de )]TJ
/TT8 1 Tf
29.8249 0 TD
0 Tw
(Þ)Tj
/TT4 1 Tf
0.5 0 TD
0.1851 Tw
[(c)15(her)45(o, en una)]TJ
-34.9166 -1.2 TD
0 Tw
[(entr)15(ada en la tabla de )]TJ
/TT8 1 Tf
9.067 0 TD
(Þ)Tj
/TT4 1 Tf
0.5 0 TD
[(c)15(her)45(os abiertos.)]TJ
/TT6 1 Tf
-12.067 -2.4 TD
0.1069 Tw
(En cada descriptor de )Tj
/TT7 1 Tf
9.3124 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1069 Tw
(chero hay un puntero hacia un record \(como siempre\). En dicho record, llamado)Tj
/TT8 1 Tf
-9.8685 -1.2 TD
0 Tw
(Þ)Tj
/TT4 1 Tf
0.5 0 TD
[(c)15(her)45(o)-250(abierto)]TJ
/TT6 1 Tf
5.6055 0 TD
(por UNIX y almacenado en una)Tj
/TT4 1 Tf
12.9951 0 TD
(tabla de )Tj
/TT8 1 Tf
3.4995 0 TD
(Þ)Tj
/TT4 1 Tf
0.5 0 TD
[(c)15(her)45(os abiertos)]TJ
/TT6 1 Tf
6.3838 0 TD
(se guarda:)Tj
-26.984 -1.56 TD
[(•)-2150(E)0(l)-250(o)0(f)25(fset en que hay que leer/escribir)55(.)]TJ
T*
[(•)-2150(E)0(l)-250(modo en que se abrió el )]TJ
/TT7 1 Tf
13.4137 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero \(lectura, escritura, o lectura/escritura\).)Tj
-13.9698 -1.56 TD
[(•)-2150(E)0(l)-250(puntero hacia la estructura de datos que representa el )]TJ
/TT7 1 Tf
25.0455 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero en UNIX.)Tj
-28.1017 -2.4 TD
0.0479 Tw
(En la )Tj
/TT7 1 Tf
2.4283 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0479 Tw
[(gura se v)15(e)-297.9(qué v)25(alor tenía el contenido de)]TJ
/TT11 1 Tf
17.2457 0 TD
0 Tw
(afile)Tj
/TT6 1 Tf
3.2985 0 TD
0.298 Tc
[(ye)298(l)]TJ
/TT11 1 Tf
1.8177 0 TD
0 Tc
(offset)Tj
/TT6 1 Tf
3.8986 0 TD
(del )Tj
/TT7 1 Tf
1.5197 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.048 Tw
(chero abierto justo al )Tj
/TT7 1 Tf
8.8556 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.048 Tw
(nal de)Tj
-40.7325 -1.2 TD
0 Tw
[(ejecutar por se)15(gunda v)15(e)0(z)]TJ
/TT11 1 Tf
10.1316 0 TD
(afile)Tj
/TT6 1 Tf
3.0005 0 TD
[(,)-250(antes de llamar a)]TJ
/TT11 1 Tf
7.4966 0 TD
(close)Tj
/TT6 1 Tf
3.0005 0 TD
(.)Tj
-23.6292 -5.14 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
53 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT8 8 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
55 0 obj
<<
/Length 6508
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-15-)Tj
-20.767 -3.6 TD
0.0007 Tw
[(Si queremos que cada v)15(ez que ejecutemos)]TJ
/TT11 1 Tf
17.0666 0 TD
0 Tw
(writef)Tj
/TT6 1 Tf
3.8513 0 TD
(el )Tj
/TT7 1 Tf
0.9723 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
/TT11 1 Tf
2.4713 0 TD
(afile)Tj
/TT6 1 Tf
3.2511 0 TD
0.0006 Tw
(quede justo con lo que hemos escrito,)Tj
-28.1687 -1.2 TD
0.1119 Tw
(la solución es eliminar el contenido de)Tj
/TT11 1 Tf
16.4176 0 TD
0 Tw
(afile)Tj
/TT6 1 Tf
3.3624 0 TD
0.1119 Tw
(cuando el )Tj
/TT7 1 Tf
4.3332 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1119 Tw
[(chero ya e)15(xiste, durante)]TJ
/TT11 1 Tf
10.1784 0 TD
0 Tw
(open)Tj
/TT6 1 Tf
2.4004 0 TD
0.112 Tw
[(.)-362(Esto es, si el)]TJ
/TT7 1 Tf
-37.2481 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0738 Tw
[(chero no e)15(xiste lo creamos y si e)15(xiste lo)]TJ
/TT4 1 Tf
16.8248 0 TD
0 Tw
(truncamos)Tj
/TT6 1 Tf
4.546 0 TD
0.0738 Tw
[(a)-323.8(0-bytes. El )]TJ
/TT7 1 Tf
5.4978 0 TD
0 Tw
(ß)Tj
/TT6 1 Tf
0.5562 0 TD
(ag)Tj
/TT11 1 Tf
1.2677 0 TD
(O_TRUNC)Tj
/TT6 1 Tf
4.5245 0 TD
(de)Tj
/TT11 1 Tf
1.2676 0 TD
(open)Tj
/TT6 1 Tf
2.7242 0 TD
0.0738 Tw
(consigue este)Tj
-37.7649 -1.2 TD
0 Tw
(efecto. Basta utilizar)Tj
/TT11 1 Tf
8 0 0 8 133 654 Tm
(fd = open\("afile", O_WRONLY|O_TRUNC|O_CREAT, 0644\);)Tj
/TT6 1 Tf
10 0 0 10 72 636 Tm
-0.0002 Tc
0.0463 Tw
(en lugar de la llamada a)Tj
/TT11 1 Tf
10.0447 0 TD
0 Tc
0 Tw
(open)Tj
/TT6 1 Tf
2.6966 0 TD
0.0462 Tw
[(que hacíamos antes. La próxima v)15(ez que ejecutemos)]TJ
/TT11 1 Tf
21.5963 0 TD
0 Tw
(writef)Tj
/TT6 1 Tf
3.8968 0 TD
0.0462 Tw
(no quedarán)Tj
-38.2343 -1.2 TD
0.0248 Tw
(restos del contenido que)Tj
/TT11 1 Tf
10.0411 0 TD
0 Tw
(afile)Tj
/TT6 1 Tf
3.2752 0 TD
0.0247 Tw
[(pudiera tener antes si es que e)15(xistía. Aunque claro, si has leído)]TJ
/TT4 1 Tf
25.5514 0 TD
0 Tw
(open\(2\))Tj
/TT6 1 Tf
3.3846 0 TD
(ya)Tj
-42.2523 -1.2 TD
(lo sabías.)Tj
0 -2.4 TD
0.0638 Tw
(Existe otro )Tj
/TT7 1 Tf
4.738 0 TD
0 Tw
(ß)Tj
/TT6 1 Tf
0.5562 0 TD
0.0638 Tw
(ag que podemos utilizar con)Tj
/TT4 1 Tf
11.8434 0 TD
0 Tw
(open\(2\))Tj
/TT6 1 Tf
3.4237 0 TD
0.0638 Tw
[(que afecta al of)25(fset que utiliza)]TJ
/TT11 1 Tf
12.6294 0 TD
0 Tw
(write)Tj
/TT6 1 Tf
3.0005 0 TD
0.0639 Tw
[(.)-313.9(S)0(e)-313.9(trata del )]TJ
/TT7 1 Tf
5.5036 0 TD
0 Tw
(ß)Tj
/TT6 1 Tf
0.5562 0 TD
(ag)Tj
/TT11 1 Tf
-42.2509 -1.2 TD
(O_APPEND)Tj
/TT6 1 Tf
4.8008 0 TD
[(.)-411.6(S)0(i)-411.6(indicamos)]TJ
/TT11 1 Tf
6.4291 0 TD
(O_APPEND)Tj
/TT6 1 Tf
5.2124 0 TD
(en)Tj
/TT11 1 Tf
1.3554 0 TD
(open)Tj
/TT6 1 Tf
2.4004 0 TD
0.1615 Tw
[(,)-411.5(las llamadas a)]TJ
/TT11 1 Tf
7.0049 0 TD
0 Tw
(write)Tj
/TT6 1 Tf
3.412 0 TD
0.1615 Tw
[(ignoran el of)25(fset del )]TJ
/TT7 1 Tf
8.8959 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1615 Tw
(chero y)Tj
-40.0671 -1.2 TD
0.0362 Tw
(escriben siempre al )Tj
/TT7 1 Tf
8.0774 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0362 Tw
(nal del mismo. En realidad, se escribe justo en la posición indicada por el tamaño del)Tj
/TT7 1 Tf
-8.6335 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0919 Tw
[(chero. )-250(Pero)-341.9(cuidado aquí si el )]TJ
/TT7 1 Tf
12.881 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0919 Tw
(chero es un )Tj
/TT7 1 Tf
5.0794 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0919 Tw
(chero compartido en red: cada UNIX que tiene abierto el)Tj
/TT7 1 Tf
-19.6289 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.098 Tw
(chero podría tener su propia idea del tamaño del mismo \(por ejemplo si un UNIX acaba justo de hacer)Tj
-0.5562 -1.2 TD
0 Tw
(crecer el )Tj
/TT7 1 Tf
3.6631 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
[(chero pero otro no se ha dado cuenta toda)20(vía\).)]TJ
/TT2 1 Tf
-4.2192 -3.6 TD
0.25 Tw
[(6. Ajustando)-250(el )250(offset)]TJ
/TT6 1 Tf
0 -1.56 TD
0.0941 Tw
[(P)15(ara e)25(vitar errores utilizando)]TJ
/TT11 1 Tf
12.1645 0 TD
0 Tw
(read)Tj
/TT6 1 Tf
2.7445 0 TD
(y)Tj
/TT11 1 Tf
0.8441 0 TD
(write)Tj
/TT6 1 Tf
3.3446 0 TD
0.094 Tw
(basta con que pienses que UNIX es muy obediente y hace)Tj
-19.0977 -1.2 TD
0.0431 Tw
(justo lo que se supone que cada llama hace. No hay magia. Si recuerdas lo que hemos visto, podrás enten-)Tj
T*
0 Tw
[(der lo que ocurre. ¡V)111(amos a comprobarlo!)]TJ
0 -2.4 TD
0.079 Tw
(Hay otra llamada,)Tj
/TT4 1 Tf
7.6227 0 TD
0 Tw
(lseek\(2\))Tj
/TT6 1 Tf
3.1645 0 TD
0.079 Tw
[(,)-329(que permite cambiar el of)25(fset de un descriptor de )]TJ
/TT7 1 Tf
21.118 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5561 0 TD
0.079 Tw
(chero. Bueno, en realidad,)Tj
-32.4615 -1.2 TD
0.0502 Tw
(queremos decir ")Tj
/TT4 1 Tf
6.8948 0 TD
[(el of)18(fset de un )]TJ
/TT8 1 Tf
6.0152 0 TD
0 Tw
(Þ)Tj
/TT4 1 Tf
0.5 0 TD
0.0503 Tw
[(c)15(her)45(o)-300.3(abierto al que apunta un descriptor)]TJ
/TT6 1 Tf
17.0177 0 TD
(". Se le suministra el descriptor)Tj
-30.4277 -1.2 TD
0 Tw
(de )Tj
/TT7 1 Tf
1.1938 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
[(chero, cuantos bytes queremos mo)15(v)15(e)0(r)-250(e)0(l)-250(o)0(f)25(fset y desde donde contamos. Por ejemplo,)]TJ
0.75 -1.56 TD
(•)Tj
/TT11 1 Tf
2.5001 0 TD
(lseek\(fd, 10, SEEK_SET\))Tj
/TT7 1 Tf
14.0522 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
[(ja el of)25(fset a 10 en)]TJ
/TT11 1 Tf
7.5829 0 TD
(fd)Tj
/TT6 1 Tf
1.2002 0 TD
(.)Tj
-25.8916 -1.56 TD
(•)Tj
/TT11 1 Tf
2.5001 0 TD
(lseek\(fd, 10, SEEK_CUR\))Tj
/TT6 1 Tf
14.0522 0 TD
[(añade 10 al of)25(fset de)]TJ
/TT11 1 Tf
8.4989 0 TD
(fd)Tj
/TT6 1 Tf
1.2002 0 TD
(.)Tj
-26.2515 -1.56 TD
(•)Tj
/TT11 1 Tf
2.5001 0 TD
0.142 Tw
(lseek\(fd, 10, SEEK_END\))Tj
/TT7 1 Tf
14.4782 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1419 Tw
[(ja el of)25(fset 10 bytes contando desde el )]TJ
/TT7 1 Tf
16.6053 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1419 Tw
(nal del )Tj
/TT7 1 Tf
3.2272 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5561 0 TD
(chero)Tj
-35.9793 -1.2 TD
(hacia atrás en)Tj
/TT11 1 Tf
5.6909 0 TD
(fd)Tj
/TT6 1 Tf
1.2002 0 TD
(.)Tj
-11.8911 -1.2 TD
0.1465 Tw
(Las constantes)Tj
/TT11 1 Tf
6.4024 0 TD
0 Tw
(SEEK_SET)Tj
/TT6 1 Tf
4.8008 0 TD
(,)Tj
/TT11 1 Tf
0.6465 0 TD
(SEEK_CUR)Tj
/TT6 1 Tf
5.1973 0 TD
(y)Tj
/TT11 1 Tf
0.8965 0 TD
(SEEK_END)Tj
/TT6 1 Tf
5.1973 0 TD
0.1465 Tw
(son simplemente)Tj
/TT11 1 Tf
7.292 0 TD
0 Tw
(0)Tj
/TT6 1 Tf
0.6001 0 TD
(,)Tj
/TT11 1 Tf
0.6465 0 TD
(1)Tj
/TT6 1 Tf
0.9966 0 TD
(y)Tj
/TT11 1 Tf
0.8966 0 TD
(2)Tj
/TT6 1 Tf
0.6001 0 TD
0.1466 Tw
[(.)-396.6(D)0(e)-396.6(hecho, dado que)]TJ
-34.1726 -1.2 TD
0 Tw
[(desde el comienzo de UNIX han tenido esos v)25(alores, es muy poco probable que cambien nunca de v)25(alor)55(.)]TJ
0 -2.4 TD
(Entendido esto, fíjate en este programa:)Tj
0 -27.36 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
56 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT8 8 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
58 0 obj
<<
/Length 3329
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-16-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(#include <stdlib.h>)Tj
0 -1.5 TD
(#include <fcntl.h>)Tj
T*
(#include <unistd.h>)Tj
T*
(#include <err.h>)Tj
0 -3 TD
(int)Tj
0 -1.5 TD
(main\(int argc, char* argv[]\))Tj
T*
({)Tj
2.4 -1.5 TD
1.8 Tw
(int fd;)Tj
0 -3 TD
0 Tw
(fd = open\("afile", O_WRONLY|O_TRUNC|O_CREAT\);)Tj
0 -1.5 TD
(if \(fd < 0\) {)Tj
2.4 -1.5 TD
(err\(1, "open: afile"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(lseek\(fd, 32, 0\);)Tj
T*
(if \(write\(fd, "xx\\n", 3\) != 3\) {)Tj
2.4 -1.5 TD
(close\(fd\);)Tj
T*
(err\(1, "write"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(if \(close\(fd\) < 0\) {)Tj
2.4 -1.5 TD
(err\(1, "close"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(exit\(0\);)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 402 Tm
[(Ejecutándolo podemos v)15(er lo que sucede con el nue)25(v)20(o)]TJ
/TT11 1 Tf
21.9053 0 TD
(afile)Tj
/TT6 1 Tf
3.2505 0 TD
(en este caso.)Tj
/TT11 1 Tf
8 0 0 8 133 384 Tm
(unix$ seekwrite)Tj
0 -1.5 TD
(unix$ ls -l afile)Tj
T*
0.6 Tw
[(-rw-r--r-- 1)-600(nemo staff 35)-600(Aug )600(20 )600(16:32 )600(afile)]TJ
T*
0 Tw
(unix$ cat afile)Tj
T*
(xx)Tj
T*
(unix$ xd -b -c afile)Tj
T*
[(0000000 )-600(00)-600(00 00 00 00 00 00 00 00 00 00 00 00 00 00 00)]TJ
3.6 -1.5 TD
0.6 Tc
[(0)-600(0)600(00)600(00)600(00)600(00)600(00)600(00)600(00)600(00)600(00)600(00)600(00)600(00)600(00)600(00)600(00)600(0)]TJ
-3.6 -1.5 TD
0 Tc
[(0000010 )-600(00)-600(00 00 00 00 00 00 00 00 00 00 00 00 00 00 00)]TJ
3 -1.5 TD
[(10 )-600(00)-600(00 00 00 00 00 00 00 00 00 00 00 00 00 00 00)]TJ
-3 -1.5 TD
0.6 Tw
[(0000020 78)-600(78 )600(0a)]TJ
3 -1.5 TD
1.2 Tw
[(20 x)-1200(x)-600(\\n)]TJ
-3 -1.5 TD
0 Tw
(0000023)Tj
/TT6 1 Tf
10 0 0 10 72 222 Tm
0.2409 Tw
(¡Curioso!, ¿No? Resulta que)Tj
/TT4 1 Tf
12.5998 0 TD
0 Tw
(ls)Tj
/TT6 1 Tf
1.1578 0 TD
0.2408 Tw
(dice que el )Tj
/TT7 1 Tf
5.3035 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.2408 Tw
(chero tiene 35 bytes. Pero sólo hemos escrito 3 bytes.)Tj
-19.6172 -1.2 TD
0 Tw
[(V)111(eamos...)]TJ
2.5 -1.56 TD
(•)Tj
/TT11 1 Tf
2.5001 0 TD
(lseek)Tj
/TT6 1 Tf
3.2505 0 TD
[(ha cambiado el of)25(fset a 32, contando desde el comienzo del )]TJ
/TT7 1 Tf
24.0214 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero.)Tj
-30.3281 -1.56 TD
(•)Tj
/TT11 1 Tf
2.5001 0 TD
(write)Tj
/TT6 1 Tf
3.2505 0 TD
[(ha escrito tres bytes en dicho of)25(fset.)]TJ
-8.2506 -1.2 TD
0.1167 Tw
[(Lue)15(go en total, el byte más alto que hemos escrito es el 34 \(contando desde 0\), lo que quiere decir que)]TJ
T*
0.1166 Tw
(mirando los 35 primeros bytes tenemos el contenido del )Tj
/TT7 1 Tf
23.6837 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1166 Tw
[(chero que hemos escrito alguna v)15(ez. Además,)]TJ
-24.2398 -1.2 TD
0 Tw
[(puedes v)15(er que los bytes que no hemos escrito nunca están a cero. Eso es cortesía de UNIX.)]TJ
0 -2.4 TD
0.0763 Tw
(El otro detalle curioso es que cuando hemos hecho un)Tj
/TT4 1 Tf
22.5345 0 TD
0 Tw
(cat)Tj
/TT6 1 Tf
1.548 0 TD
(del )Tj
/TT7 1 Tf
1.548 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0763 Tw
(chero sólo hemos visto una línea con)Tj
/TT11 1 Tf
15.5586 0 TD
0 Tw
(xx)Tj
/TT6 1 Tf
1.2002 0 TD
(,)Tj
-42.9454 -1.2 TD
[(que era lo que cabría esperar)55(.)-250(Pero en realidad, sí que)]TJ
/TT11 1 Tf
21.5182 0 TD
(cat)Tj
/TT6 1 Tf
2.0503 0 TD
(ha escrito un total de 35 bytes en su salida:)Tj
-23.5685 -8.28 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
59 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
61 0 obj
<<
/Length 7342
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-17-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(unix$ cat afile >/tmp/out)Tj
0 -1.5 TD
(unix$ ls -l /tmp/out)Tj
T*
0.6 Tw
[(-rw-r--r-- 1)-600(nemo wheel 35)-600(Aug )600(20 )600(16:37 )600(/tmp/out)]TJ
T*
0 Tw
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 642 Tm
0.019 Tw
(Lo que ocurre es que cuando)Tj
/TT4 1 Tf
11.887 0 TD
0 Tw
(cat)Tj
/TT6 1 Tf
1.4907 0 TD
0.019 Tw
[(escribe un byte a cero en su salida estándar)40(,)-269(y)-269(esta es el terminal, el termi-)]TJ
-13.3776 -1.2 TD
0.1157 Tw
[(nal no sabe cómo mostrar dicho byte \(¿Cómo dib)20(ujar un símbolo para el byte nulo?\) y no lo escribe en)]TJ
T*
0.109 Tw
(absoluto. Es normal,)Tj
/TT11 1 Tf
8.7982 0 TD
0 Tw
(/dev/tty)Tj
/TT6 1 Tf
5.1598 0 TD
0.109 Tw
[(sólo espera que escribas te)15(xto en el teclado y que muestres te)15(xto en la)]TJ
-13.958 -1.2 TD
0 Tw
(pantalla. No espera efectos especiales.)Tj
0 -2.4 TD
(Utilizar)Tj
/TT11 1 Tf
3.3114 0 TD
(lseek)Tj
/TT6 1 Tf
3.2578 0 TD
0.0073 Tw
(como hemos hecho es muy habitual. Por ejemplo, para crear un )Tj
/TT7 1 Tf
25.7112 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0073 Tw
(chero con 1GiB basta con)Tj
-32.8365 -1.2 TD
-0.0004 Tc
0.0258 Tw
(que hagas un)Tj
/TT11 1 Tf
5.5418 0 TD
0 Tc
0 Tw
(lseek)Tj
/TT6 1 Tf
3.2758 0 TD
[(a)-275.3(l)0(a)-275.3(posición)]TJ
/TT11 1 Tf
5.3801 0 TD
(1024*1024*1024-1)Tj
/TT6 1 Tf
9.8769 0 TD
0.0253 Tw
[(y)-275.3(escribas un byte. El tamaño del nue)25(v)20(o)20( )]TJ
/TT7 1 Tf
16.3473 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
-40.978 -1.2 TD
0.107 Tw
[(será justo de 1GiB. Lo que es más, es muy posible que UNIX no asigne espacio en disco para el nue)25(v)20(o)]TJ
/TT7 1 Tf
T*
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0747 Tw
[(chero salv)20(o)-324.7(para el último)]TJ
/TT4 1 Tf
10.9888 0 TD
0 Tw
(bloque)Tj
/TT6 1 Tf
3.0464 0 TD
0.0746 Tw
(que use el )Tj
/TT7 1 Tf
4.4723 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0746 Tw
[(chero \(que es dónde has escrito el byte\). T)80(odos los trozos)]TJ
-19.6198 -1.2 TD
0.1206 Tw
(anteriores del )Tj
/TT7 1 Tf
5.9053 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1206 Tw
[(chero están sin escribir y)65(,)-370.6(si)-370.6(se)-370.6(leen, UNIX sabe que se leen con todos los bytes a cero.)]TJ
-6.4614 -1.2 TD
0.0319 Tw
[(Siendo esto así, ¿P)15(ara qué guardar los ceros en el disco si UNIX sabe que están a cero? A estos )]TJ
/TT7 1 Tf
38.9165 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0319 Tw
(cheros se)Tj
-39.4726 -1.2 TD
0.1758 Tw
(les llama)Tj
/TT8 1 Tf
4.1836 0 TD
0 Tw
(Þ)Tj
/TT4 1 Tf
0.5 0 TD
0.1758 Tw
[(c)15(her)45(os con huecos)]TJ
/TT6 1 Tf
7.6783 0 TD
0.1759 Tw
[(.)-425.9(¡Puedes tener )]TJ
/TT7 1 Tf
6.6923 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1759 Tw
(cheros más grandes que el tamaño del disco en que los)Tj
-19.6104 -1.2 TD
0 Tw
(guardas!)Tj
0 -2.4 TD
0.0057 Tw
(Otro uso de)Tj
/TT11 1 Tf
4.9331 0 TD
0 Tw
(lseek)Tj
/TT6 1 Tf
3.2562 0 TD
0.0056 Tw
[(es para obtener el of)25(fset. Basta con cambiar el of)25(fset a 0 bytes contando a partir del of)25(f-)]TJ
-8.1893 -1.2 TD
0 Tw
[(set actual, y utilizar el v)25(alor que retorna)]TJ
/TT11 1 Tf
16.1068 0 TD
(lseek)Tj
/TT6 1 Tf
3.2505 0 TD
[(\(que es el nue)25(v)20(o)20( )-20(of)25(fset\). Por ejemplo:)]TJ
/TT11 1 Tf
8 0 0 8 133 444 Tm
(off = lseek\(fd, 0, 1\);)Tj
/TT2 1 Tf
10 0 0 10 72 402 Tm
[(7. )-250(Cr)18(ear y borrar)]TJ
/TT6 1 Tf
0 -1.56 TD
0.1 Tw
[(Y)100(a)100( hemos )100(creado )]TJ
/TT7 1 Tf
7.0914 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(cheros utilizando el )Tj
/TT7 1 Tf
8.0806 0 TD
(ß)Tj
/TT6 1 Tf
0.5562 0 TD
(ag)Tj
/TT11 1 Tf
1.1938 0 TD
(O_CREAT)Tj
/TT6 1 Tf
4.4507 0 TD
(de)Tj
/TT11 1 Tf
1.1938 0 TD
(open)Tj
/TT6 1 Tf
2.4004 0 TD
[(.)-250(Otra forma es utilizar)]TJ
/TT4 1 Tf
9.3296 0 TD
[(cr)37(eat\(2\))]TJ
/TT6 1 Tf
3.1837 0 TD
[(.)-500(Llamar a)]TJ
/TT11 1 Tf
8 0 0 8 133 368.4 Tm
(fd = creat\(path, mode\);)Tj
/TT6 1 Tf
10 0 0 10 72 350.4 Tm
(es lo mismo que llamar a)Tj
/TT11 1 Tf
8 0 0 8 133 332.4 Tm
(fd = open\(path, O_CREAT|OTRUNC|O_WRONLY, mode\);)Tj
/TT6 1 Tf
10 0 0 10 72 314.4 Tm
(así que en realidad ya sabes utilizar)Tj
/TT11 1 Tf
14.4106 0 TD
(creat)Tj
/TT6 1 Tf
3.0005 0 TD
(.)Tj
-17.4111 -2.4 TD
0.2073 Tw
(No es posible crear directorios utilizando)Tj
/TT11 1 Tf
17.9606 0 TD
0 Tw
(creat)Tj
/TT6 1 Tf
3.0005 0 TD
0.2073 Tw
[(.)-457.3(Hay que utilizar)]TJ
/TT4 1 Tf
8.0211 0 TD
0 Tw
(mkdir\(2\))Tj
/TT6 1 Tf
3.499 0 TD
0.2073 Tw
[(.)-457.3(S)0(u)-457.3(uso es similar al de)]TJ
/TT11 1 Tf
-32.4812 -1.2 TD
0 Tw
(creat)Tj
/TT6 1 Tf
3.0005 0 TD
[(,)-255.4(salv)20(o)-255.4(porque)]TJ
/TT11 1 Tf
5.8839 0 TD
(mkdir)Tj
/TT6 1 Tf
3.2559 0 TD
0.0053 Tw
[(no de)25(vuelv)15(e)-255.4(ningún descriptor)55(.)-255.3(T)80(an sólo de)25(vuelv)15(e)]TJ
/TT11 1 Tf
20.0391 0 TD
0 Tw
(-1)Tj
/TT6 1 Tf
1.4555 0 TD
0.0053 Tw
[(si f)10(alla y)]TJ
/TT11 1 Tf
3.6993 0 TD
0 Tw
(0)Tj
/TT6 1 Tf
0.8554 0 TD
0.0053 Tw
(en caso con-)Tj
-38.1895 -1.2 TD
0 Tw
(trario:)Tj
/TT11 1 Tf
8 0 0 8 133 248.4 Tm
(if \(mkdir\("/tmp/mydir", 0755\) < 0\) {)Tj
2.4 -1.5 TD
(...mkdir ha fallado...)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 194.4 Tm
0.1179 Tw
(Los permisos \(o como UNIX lo denomina, el)Tj
/TT4 1 Tf
19.3011 0 TD
0 Tw
(modo)Tj
/TT6 1 Tf
2.2222 0 TD
0.118 Tw
[(\))-367.9(con que se crean los )]TJ
/TT7 1 Tf
9.5932 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.118 Tw
(cheros y directorios no sólo)Tj
-31.6726 -1.2 TD
0.0516 Tw
(dependen de los permisos que indiques en la llamada a)Tj
/TT11 1 Tf
22.6762 0 TD
0 Tw
(open)Tj
/TT6 1 Tf
2.4004 0 TD
(,)Tj
/TT11 1 Tf
0.5516 0 TD
(creat)Tj
/TT6 1 Tf
3.3021 0 TD
(o)Tj
/TT11 1 Tf
0.8016 0 TD
(mkdir)Tj
/TT6 1 Tf
3.0005 0 TD
0.0515 Tw
[(.)-301.6(Por se)15(guridad, cada pro-)]TJ
-32.7323 -1.2 TD
0.0984 Tw
[(ceso tiene un atrib)20(uto denominado)]TJ
/TT4 1 Tf
14.4959 0 TD
0 Tw
(umask)Tj
/TT6 1 Tf
2.5552 0 TD
0.3484 Tc
[(.E)348.4(l)]TJ
/TT4 1 Tf
1.8355 0 TD
0 Tc
(umask)Tj
/TT6 1 Tf
2.9036 0 TD
0.0984 Tw
(es la)Tj
/TT4 1 Tf
2.2515 0 TD
[(máscar)15(a)-348.4(d)0(e)-348.4(c)0(r)37(eación de )]TJ
/TT8 1 Tf
10.1722 0 TD
0 Tw
(Þ)Tj
/TT4 1 Tf
0.5 0 TD
[(c)15(her)45(os)]TJ
/TT6 1 Tf
2.9544 0 TD
0.0985 Tw
[(y)-348.5(actúa como)]TJ
-37.6682 -1.2 TD
0.0213 Tw
[(una máscara para e)25(vitar que permisos no deseados se den a )]TJ
/TT7 1 Tf
24.0609 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0213 Tw
(cheros que crea un proceso. La llamada al sis-)Tj
-24.617 -1.2 TD
0 Tw
(tema es)Tj
/TT4 1 Tf
3.2764 0 TD
(umask\(2\))Tj
/TT6 1 Tf
3.9712 0 TD
[(y)-250(e)0(l)-250(comando que utiliza dicha llamada y podemos utilizar en el shell es)]TJ
/TT4 1 Tf
28.9907 0 TD
(umask\(1\))Tj
/TT6 1 Tf
3.7212 0 TD
(.)Tj
-39.9595 -2.4 TD
[(P)15(ara cambiar la)]TJ
/TT4 1 Tf
6.4538 0 TD
(umask)Tj
/TT6 1 Tf
2.8052 0 TD
(desde C podemos utilizar código como)Tj
/TT11 1 Tf
8 0 0 8 133 104.4 Tm
(umask\(077\);)Tj
/TT6 1 Tf
10 0 0 10 72 86.4 Tm
0.0505 Tw
(Con esta llamada ponemos la máscara a 0077, lo que hace que en ningún caso se den permisos de lectura,)Tj
0 -1.2 TD
0.0811 Tw
(escritura o ejecución para el grupo de usuarios o para el resto del mundo. Si con esta máscara utilizamos)Tj
T*
0.1267 Tw
(0755 como modo en)Tj
/TT11 1 Tf
8.9502 0 TD
0 Tw
(creat)Tj
/TT6 1 Tf
3.0005 0 TD
0.1267 Tw
[(,)-376.7(los permisos del nue)25(v)20(o)20( )]TJ
/TT7 1 Tf
10.532 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1268 Tw
(chero serán en realidad 0700. Aunque no hemos)Tj
-23.0388 -3.84 TD
0 Tw
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
62 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT8 8 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
64 0 obj
<<
/Length 2993
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-18-)Tj
-20.767 -3.6 TD
0.0938 Tw
[(usado el v)25(alor que de)25(vuelv)15(e)]TJ
/TT11 1 Tf
11.8168 0 TD
0 Tw
(umask)Tj
/TT6 1 Tf
3.0005 0 TD
0.0938 Tw
[(,)-343.8(l)0(a)-343.8(llamada de)25(vuelv)15(e)-343.8(l)0(a)-343.8(máscara anterior)40(,)-343.8(por si queremos v)20(olv)15(erla a)]TJ
-14.8173 -1.2 TD
0 Tw
(dejar como estaba.)Tj
0 -2.4 TD
0.1206 Tw
(Normalmente, la máscara es 0022, lo que hace que ni el grupo ni el resto del mundo pueda escribir los)Tj
/TT7 1 Tf
0 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
[(cheros o directorios que creamos.)-500(¿Puedes ahora e)15(xplicar lo que sucede en esta sesión de shell?)]TJ
/TT11 1 Tf
8 0 0 8 133 642 Tm
(unix$ umask)Tj
0 -1.5 TD
(0022)Tj
T*
(unix$ touch a)Tj
T*
(unix$ ls -l a)Tj
T*
0.6 Tw
[(-rw-r--r-- 1)-600(nemo staff 0)-600(Aug )600(20 )600(21:32 )600(a)]TJ
T*
0 Tw
(unix$ umask 077)Tj
T*
(unix$ umask)Tj
T*
(0077)Tj
T*
(unix$ rm a)Tj
T*
(unix$ touch a)Tj
T*
(unix$ ls -l a)Tj
T*
0.6 Tw
[(-rw------- 1)-600(nemo staff 0)-600(Aug )600(20 )600(21:32 )600(a)]TJ
T*
0 Tw
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 468 Tm
(Cuando un proceso crea un )Tj
/TT7 1 Tf
11.1353 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero hace en realidad dos cosas:)Tj
-9.1914 -1.56 TD
[(•)-2150(crear el )]TJ
/TT7 1 Tf
5.7193 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
-6.2755 -1.56 TD
[(•)-2150(darle un nombre en un directorio)]TJ
-2.5 -2.4 TD
0.0884 Tw
[(Ambas cosas suceden dentro de la llamada. Esto hace que resulte natural que no e)15(xista una llamada para)]TJ
0 -1.2 TD
0.0362 Tw
(borrar un )Tj
/TT7 1 Tf
4.0153 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0362 Tw
[(chero. P)15(ara borrar un )]TJ
/TT7 1 Tf
8.8205 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0363 Tw
(chero lo que se hace es eliminar el nombre del )Tj
/TT7 1 Tf
19.133 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0363 Tw
(chero. Si nadie está uti-)Tj
-33.6373 -1.2 TD
0 Tw
(lizando el )Tj
/TT7 1 Tf
4.165 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero y no hay ningún otro nombre para el )Tj
/TT7 1 Tf
17.3003 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero, este se borra.)Tj
-22.5776 -2.4 TD
[(Por ejemplo, este programa es una v)15(ersión simpli)]TJ
/TT7 1 Tf
19.7028 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(cada de)Tj
/TT4 1 Tf
3.2754 0 TD
(rm\(1\))Tj
/TT6 1 Tf
2.2773 0 TD
(.)Tj
/TT11 1 Tf
8 0 0 8 133 346.8 Tm
(#include <stdio.h>)Tj
0 -1.5 TD
(#include <stdlib.h>)Tj
T*
(#include <unistd.h>)Tj
T*
(#include <err.h>)Tj
0 -3 TD
(int)Tj
0 -1.5 TD
(main\(int argc, char* argv[]\))Tj
T*
({)Tj
2.4 -1.5 TD
(int i, sts;)Tj
0 -3 TD
(sts = 0;)Tj
0 -1.5 TD
(if \(argc == 1\) {)Tj
2.4 -1.5 TD
(fprintf\(stderr, "usage: %s file...\\n", argv[0]\);)Tj
T*
(exit\(1\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(for \(i = 1; i < argc; i++\) {)Tj
2.4 -1.5 TD
(if \(unlink\(argv[i]\) < 0\) {)Tj
2.4 -1.5 TD
(warn\("%s: unlink", argv[i]\);)Tj
T*
(sts = 1;)Tj
-2.4 -1.5 TD
(})Tj
-2.4 -1.5 TD
(})Tj
T*
(exit\(sts\);)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 24 Tm
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
65 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
67 0 obj
<<
/Length 4048
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-19-)Tj
-20.767 -3.6 TD
(Podemos utilizarlo para borrar )Tj
/TT7 1 Tf
12.4404 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(cheros:)Tj
/TT11 1 Tf
8 0 0 8 133 690 Tm
(unix$ touch /tmp/a /tmp/b /tmp/c)Tj
0 -1.5 TD
(unix$ ls -l /tmp/?)Tj
T*
0.6 Tw
[(-rw-r--r-- 1)-600(nemo wheel 0)-600(Aug )600(20 )600(18:57 )600(/tmp/a)]TJ
T*
[(-rw-r--r-- 1)-600(nemo wheel 0)-600(Aug )600(20 )600(18:57 )600(/tmp/b)]TJ
T*
[(-rw-r--r-- 1)-600(nemo wheel 0)-600(Aug )600(20 )600(18:57 )600(/tmp/c)]TJ
T*
0 Tw
(unix$ chmod -w /tmp/b)Tj
T*
(unix$ ls -l /tmp/b)Tj
T*
0.6 Tw
[(-r--r--r-- 1)-600(nemo wheel 0)-600(Aug )600(20 )600(18:57 )600(/tmp/b)]TJ
T*
0 Tw
(unix$ rem /tmp/[abc])Tj
T*
(unix$ ls -l /tmp/?)Tj
T*
(ls: /tmp/?: No such file or directory)Tj
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 540 Tm
0.0177 Tw
(Hemos utilizado)Tj
/TT11 1 Tf
6.8674 0 TD
0 Tw
(/tmp/?)Tj
/TT6 1 Tf
3.8683 0 TD
0.0176 Tw
(para que el shell escriba por nosotros en la línea de comandos todos los nombres)Tj
-10.7357 -1.2 TD
0 Tw
(de )Tj
/TT7 1 Tf
1.514 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.3202 Tw
(chero que están en)Tj
/TT11 1 Tf
8.9439 0 TD
0 Tw
(/tmp)Tj
/TT6 1 Tf
2.9706 0 TD
0.3202 Tw
[(y)-570.2(tienen como nombre un sólo carácter)55(.)-820.2(T)80(ambién hemos utilizado)]TJ
/TT11 1 Tf
-13.9847 -1.2 TD
0 Tw
(/tmp/[abc])Tj
/TT6 1 Tf
6.3055 0 TD
0.0544 Tw
(para que el shell escriba por nosotros los nombres de )Tj
/TT7 1 Tf
21.9273 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0544 Tw
(cheros en)Tj
/TT11 1 Tf
4.1625 0 TD
0 Tw
(/tmp)Tj
/TT6 1 Tf
2.7048 0 TD
0.0544 Tw
(que sean)Tj
/TT11 1 Tf
3.8295 0 TD
0 Tw
(a)Tj
/TT6 1 Tf
0.6001 0 TD
(,)Tj
/TT11 1 Tf
0.5544 0 TD
(b)Tj
/TT6 1 Tf
0.9045 0 TD
(o)Tj
/TT11 1 Tf
0.8044 0 TD
(c)Tj
/TT6 1 Tf
0.6001 0 TD
(.)Tj
-42.9492 -1.2 TD
0.0523 Tw
[(Si esto te resulta confuso, piensa que hemos usando siempre los ar)18(gumentos que hemos dado a)]TJ
/TT11 1 Tf
38.9502 0 TD
0 Tw
(touch)Tj
/TT6 1 Tf
3.3029 0 TD
(en)Tj
-42.253 -1.2 TD
-0.0006 Tc
0.0006 Tw
(lugar de)Tj
/TT11 1 Tf
3.4935 0 TD
0 Tc
0 Tw
(/tmp/[abc])Tj
/TT6 1 Tf
6.251 0 TD
0.25 Tc
[(od)250(e)]TJ
/TT11 1 Tf
1.9438 0 TD
0 Tc
(/tmp/?)Tj
/TT6 1 Tf
3.6006 0 TD
[(.)-250(Más adelante e)15(xplicaremos estas e)15(xpresiones con más detalle.)]TJ
-15.2889 -2.4 TD
-0.0001 Tc
0.0314 Tw
[(Como v)14.9(erás, que no tengas permiso de escritura en un )]TJ
/TT7 1 Tf
22.148 0 TD
0 Tc
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0313 Tw
(chero no quiere decir que no puedas borrarlo. Pero)Tj
-22.7041 -1.2 TD
0 Tw
(mira esto:)Tj
/TT11 1 Tf
8 0 0 8 133 438 Tm
(unix$ mkdir /tmp/d)Tj
0 -1.5 TD
(unix$ touch /tmp/d/a)Tj
T*
(unix$ chmod -w /tmp/d)Tj
T*
(unix$ 8.rem /tmp/d/a)Tj
T*
(rem: /tmp/d/a: unlink: Permission denied)Tj
T*
(unix$ chmod +w /tmp/d)Tj
T*
(unix$ rem /tmp/d/a)Tj
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 336 Tm
0.0843 Tw
(Como indica la página de manual)Tj
/TT4 1 Tf
14.1684 0 TD
0 Tw
(unlink\(2\))Tj
/TT6 1 Tf
3.6655 0 TD
0.0843 Tw
[(,)-334.3(borrar un )]TJ
/TT7 1 Tf
4.6958 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0843 Tw
(chero requiere poder escribir el directorio en que)Tj
-23.0858 -1.2 TD
-0.0001 Tc
0.0001 Tw
(está. Cuando tengas dudas respecto a permisos, consulta el manual.)Tj
0 -2.4 TD
0 Tc
0 Tw
(Otra cosa curiosa sucede si intentamos borrar)Tj
/TT11 1 Tf
18.4102 0 TD
(/tmp/d)Tj
/TT6 1 Tf
3.6006 0 TD
(.)Tj
/TT11 1 Tf
8 0 0 8 133 282 Tm
(unix$ rem /tmp/d)Tj
0 -1.5 TD
(rem: /tmp/d: unlink: Operation not permitted)Tj
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 240 Tm
(La llamada)Tj
/TT11 1 Tf
4.7197 0 TD
(unlink)Tj
/TT6 1 Tf
3.8506 0 TD
(no sabe borrar directorios.)Tj
-8.5703 -2.4 TD
0.0296 Tw
[(P)15(ara borrar un directorio hay que utilizar)]TJ
/TT4 1 Tf
16.7688 0 TD
0 Tw
(rmdir\(2\))Tj
/TT6 1 Tf
3.4443 0 TD
0.0295 Tw
[(,)-279.5(del mismo modo que para crear directorios hay que uti-)]TJ
-20.2131 -1.2 TD
0 Tw
(lizar)Tj
/TT4 1 Tf
2.0264 0 TD
(mkdir\(2\))Tj
/TT6 1 Tf
3.749 0 TD
[(y)-250(n)0(o)-250(podemos utilizar)]TJ
/TT4 1 Tf
8.9429 0 TD
[(cr)37(eat\(2\))]TJ
/TT6 1 Tf
3.1837 0 TD
(.)Tj
-17.902 -18 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
68 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
70 0 obj
<<
/Length 2517
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-20-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(#include <stdio.h>)Tj
0 -1.5 TD
(#include <stdlib.h>)Tj
T*
(#include <unistd.h>)Tj
T*
(#include <err.h>)Tj
0 -3 TD
(int)Tj
0 -1.5 TD
(main\(int argc, char* argv[]\))Tj
T*
({)Tj
2.4 -1.5 TD
(int i, sts;)Tj
0 -3 TD
(sts = 0;)Tj
0 -1.5 TD
(if \(argc == 1\) {)Tj
2.4 -1.5 TD
(fprintf\(stderr, "usage: %s dir...\\n", argv[0]\);)Tj
T*
(exit\(1\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(for \(i = 1; i < argc; i++\) {)Tj
2.4 -1.5 TD
(if \(rmdir\(argv[i]\) < 0\) {)Tj
2.4 -1.5 TD
(warn\("%s: rmdir", argv[i]\);)Tj
T*
(sts = 1;)Tj
-2.4 -1.5 TD
(})Tj
-2.4 -1.5 TD
(})Tj
T*
(exit\(sts\);)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 414 Tm
[(Y)-250(ahora podemos...)]TJ
/TT11 1 Tf
8 0 0 8 133 396 Tm
(unix$ remdir /tmp/d)Tj
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 366 Tm
(Naturalmente, no podemos utilizar)Tj
/TT11 1 Tf
14.1348 0 TD
(rmdir)Tj
/TT6 1 Tf
3.2505 0 TD
(para borrar )Tj
/TT7 1 Tf
4.6636 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(cheros:)Tj
/TT11 1 Tf
8 0 0 8 133 348 Tm
(unix$ touch /tmp/a)Tj
0 -1.5 TD
(unix$ remdir /tmp/a)Tj
T*
(remdir: /tmp/a: rmdir: Not a directory)Tj
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 294 Tm
0.0162 Tw
[(¡Y tampoco para borrar directorios que no están v)25(acíos! \(sin contar ni ")]TJ
/TT11 1 Tf
28.6791 0 TD
0 Tw
(.)Tj
/TT6 1 Tf
0.6001 0 TD
0.2663 Tc
[("n)266.3(i")]TJ
/TT11 1 Tf
2.1268 0 TD
0 Tc
(..)Tj
/TT6 1 Tf
1.2002 0 TD
0.0163 Tw
("\). Si)Tj
/TT11 1 Tf
2.3578 0 TD
0 Tw
(rmdir)Tj
/TT6 1 Tf
3.2668 0 TD
0.0163 Tw
[(pudiese bor)20(-)]TJ
-38.2308 -1.2 TD
0 Tw
[(rar directorios no v)25(acíos nos di)25(v)15(ertiríamos mucho ejecutando)]TJ
/TT11 1 Tf
8 0 0 8 133 264 Tm
(unix$ rm /)Tj
/TT2 1 Tf
10 0 0 10 72 222 Tm
0.25 Tw
(8. Enlaces)Tj
/TT6 1 Tf
0 -1.56 TD
0.0225 Tw
(Dado un )Tj
/TT7 1 Tf
3.711 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0224 Tw
[(chero que e)15(xiste, podemos darle un nue)25(v)20(o)20( )-20(nombre dentro de la misma partición o del mismo sis-)]TJ
-4.2672 -1.2 TD
0.1626 Tw
(tema de )Tj
/TT7 1 Tf
3.7124 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1626 Tw
(cheros. Esto se hace con la llamada)Tj
/TT4 1 Tf
15.521 0 TD
0 Tw
(link\(2\))Tj
/TT6 1 Tf
2.6655 0 TD
0.1626 Tw
[(.)-412.6(Este programa es similar al comando)]TJ
/TT4 1 Tf
16.689 0 TD
0 Tw
(ln\(1\))Tj
/TT6 1 Tf
1.9438 0 TD
[(,)-412.6(que)]TJ
-41.0879 -1.2 TD
[(establece un nue)25(v)20(o)20( )-20(nombre para un )]TJ
/TT7 1 Tf
14.3383 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero:)Tj
-14.8945 -15.84 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
71 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
73 0 obj
<<
/Length 3979
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-21-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(#include <stdio.h>)Tj
0 -1.5 TD
(#include <stdlib.h>)Tj
T*
(#include <unistd.h>)Tj
T*
(#include <err.h>)Tj
0 -3 TD
(int)Tj
0 -1.5 TD
(main\(int argc, char* argv[]\))Tj
T*
({)Tj
2.4 -3 TD
(if \(argc != 3\) {)Tj
2.4 -1.5 TD
(fprintf\(stderr, "usage: %s old new\\n", argv[0]\);)Tj
T*
(exit\(1\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(if \(link\(argv[1], argv[2]\) < 0\) {)Tj
2.4 -1.5 TD
(err\(1, "link %s", argv[1]\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(exit\(0\);)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 474 Tm
[(V)111(amos a v)15(erlo despacio y paso a paso utilizando un par de )]TJ
/TT7 1 Tf
23.5337 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
[(cheros.)-500(Primero creamos un )]TJ
/TT7 1 Tf
11.6631 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
/TT11 1 Tf
2.4707 0 TD
(afile)Tj
/TT6 1 Tf
3.0005 0 TD
(:)Tj
/TT11 1 Tf
8 0 0 8 133 456 Tm
(unix$ echo hola >afile)Tj
0 -1.5 TD
(unix$ ls -i afile)Tj
T*
(7782892 afile)Tj
T*
(unix$ cat afile)Tj
T*
(hola)Tj
/TT6 1 Tf
10 0 0 10 72 390 Tm
0.0528 Tw
(Hemos utilizado)Tj
/TT11 1 Tf
6.9376 0 TD
0 Tw
(ls)Tj
/TT6 1 Tf
1.503 0 TD
0.0528 Tw
(con la opción)Tj
/TT11 1 Tf
5.7956 0 TD
0 Tw
(-i)Tj
/TT6 1 Tf
1.503 0 TD
0.0528 Tw
(para que nos de el número que usa UNIX para identi)Tj
/TT7 1 Tf
21.5763 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0528 Tw
(car el )Tj
/TT7 1 Tf
2.548 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
-40.9759 -1.2 TD
(dentro su partición o sistema de )Tj
/TT7 1 Tf
12.9414 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(cheros \(UNIX lo llama)Tj
/TT4 1 Tf
9.4414 0 TD
(i-nodo)Tj
/TT6 1 Tf
2.6108 0 TD
(\).)Tj
-25.5498 -2.4 TD
0.0042 Tw
(Ahora podemos ejecutar nuestro programa)Tj
/TT11 1 Tf
17.3203 0 TD
0 Tw
(lnk)Tj
/TT6 1 Tf
2.0545 0 TD
[(o)-254.2(e)0(l)-254.2(comando)]TJ
/TT11 1 Tf
5.6498 0 TD
(ln)Tj
/TT6 1 Tf
1.4544 0 TD
0.0043 Tw
(\(funcionan igual en este caso\) para dar un)Tj
-26.479 -1.2 TD
0.02 Tw
[(nue)25(v)20(o)20( nombre )20(para)]TJ
/TT11 1 Tf
7.9242 0 TD
0 Tw
(afile)Tj
/TT6 1 Tf
3.0005 0 TD
(:)Tj
/TT11 1 Tf
8 0 0 8 133 324 Tm
(unix$ lnk afile another)Tj
0 -1.5 TD
(unix$ ln afile another)Tj
T*
(ln: another: File exists)Tj
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 270 Tm
0.052 Tw
[(La se)15(gunda v)15(ez, el )]TJ
/TT7 1 Tf
7.8689 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
/TT11 1 Tf
2.5227 0 TD
(another)Tj
/TT6 1 Tf
4.5027 0 TD
0.0519 Tw
[(ya e)15(xiste por lo que no se puede utilizar ese nombre como un nue)25(v)20(o)]TJ
-15.4505 -1.2 TD
0.0036 Tw
(nombre. En cualquier caso,)Tj
/TT11 1 Tf
11.177 0 TD
0 Tw
(lnk)Tj
/TT6 1 Tf
2.0539 0 TD
0.0036 Tw
(ha llamado a)Tj
/TT11 1 Tf
5.3697 0 TD
0 Tw
(link)Tj
/TT6 1 Tf
2.654 0 TD
0.0036 Tw
(haciendo que)Tj
/TT11 1 Tf
5.5604 0 TD
0 Tw
(another)Tj
/TT6 1 Tf
4.4543 0 TD
0.0037 Tw
(sea otro nombre para)Tj
/TT11 1 Tf
8.6779 0 TD
0 Tw
(afile)Tj
/TT6 1 Tf
3.0005 0 TD
(.)Tj
-42.9477 -1.2 TD
(¡Ambos )Tj
/TT7 1 Tf
3.4722 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(cheros son el mismo!)Tj
-4.0283 -2.4 TD
0.0768 Tw
(Aunque en este caso ambos nombres están dentro del mismo directorio, es posible crearlos en directorios)Tj
0 -1.2 TD
0.0366 Tw
[(distintos. Pero sigamos e)15(xplorando los enlaces y el uso que hace UNIX de los nombres. Primero, podemos)]TJ
T*
0 Tw
(comprobar que el )Tj
/TT7 1 Tf
7.2471 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero es en realidad el mismo:)Tj
/TT11 1 Tf
8 0 0 8 133 180 Tm
(unix$ ls -i another)Tj
0 -1.5 TD
(7782892 another)Tj
/TT6 1 Tf
10 0 0 10 72 150 Tm
0.0172 Tw
(El número de i-nodo sólo signi)Tj
/TT7 1 Tf
12.4459 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0172 Tw
(ca algo dentro de la misma partición en el mismo disco, pero ese es el caso)Tj
-13.002 -1.2 TD
0 Tw
(por lo que si el número coincide entonces el )Tj
/TT7 1 Tf
17.8555 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero es el mismo.)Tj
-18.4116 -2.4 TD
[(V)111(eámoslo mirando y cambiando uno de los )]TJ
/TT7 1 Tf
17.5243 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(cheros:)Tj
-18.0804 -9 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
74 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
77 0 obj
<<
/Length 4442
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-22-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(unix$ cat another)Tj
0 -1.5 TD
(hola)Tj
T*
(unix$ echo adios >afile)Tj
T*
(unix$ cat another)Tj
T*
(adios)Tj
/TT6 1 Tf
10 0 0 10 72 642 Tm
0.0485 Tw
[(T)35(ras cambiar)]TJ
/TT11 1 Tf
5.5591 0 TD
0 Tw
(afile)Tj
/TT6 1 Tf
3.0005 0 TD
0.0485 Tw
[(,)-298.5(resulta que)]TJ
/TT11 1 Tf
5.2549 0 TD
0 Tw
(another)Tj
/TT6 1 Tf
4.4992 0 TD
0.0485 Tw
(ha cambiado del mismo modo. ¡Naturalmente!, son el mismo)Tj
/TT7 1 Tf
-18.3136 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero.)Tj
-0.5562 -2.4 TD
(Si borramos)Tj
/TT11 1 Tf
5.1108 0 TD
(afile)Tj
/TT6 1 Tf
3.0005 0 TD
[(,)-250(toda)20(vía sigue e)15(xistiendo el )]TJ
/TT7 1 Tf
11.3512 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
/TT11 1 Tf
8 0 0 8 133 588 Tm
(unix$ rm afile)Tj
0 -1.5 TD
(unix$ cat another)Tj
T*
(adios)Tj
/TT6 1 Tf
10 0 0 10 72 546 Tm
(puesto que aún tiene otro nombre. Si borramos el único nombre que le queda al )Tj
/TT7 1 Tf
31.9912 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
/TT11 1 Tf
8 0 0 8 133 528 Tm
(unix$ rm another)Tj
/TT6 1 Tf
10 0 0 10 72 510 Tm
(UNIX borra realmente el )Tj
/TT7 1 Tf
10.273 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero.)Tj
-10.8291 -2.4 TD
0.0067 Tw
[(P)15(ara saber cuántos nombres tiene un )]TJ
/TT7 1 Tf
14.8538 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0067 Tw
(chero, UNIX guarda en la estructura de datos que lo implementa \(lla-)Tj
-15.41 -1.2 TD
0 Tw
(mada)Tj
/TT4 1 Tf
2.5499 0 TD
(i-nodo)Tj
/TT6 1 Tf
2.6108 0 TD
0.1344 Tw
[(\))-384.4(u)0(n)-384.4(contador que cuenta cuántos nombres tiene. Se lo suele llamar contador de referencia.)]TJ
-5.1608 -1.2 TD
0 Tw
[(Podemos v)15(erlo utilizando)]TJ
/TT11 1 Tf
10.4557 0 TD
(ls)Tj
/TT6 1 Tf
1.2002 0 TD
[(.)-500(Fíjate en el número de la se)15(gunda columna cada v)15(ez que llamamos a)]TJ
/TT11 1 Tf
28.3484 0 TD
(ls)Tj
/TT6 1 Tf
1.2002 0 TD
(:)Tj
/TT11 1 Tf
8 0 0 8 133 444 Tm
(unix$ touch afile)Tj
0 -1.5 TD
(unix$ ln afile another)Tj
T*
(unix$ ls -l afile another)Tj
T*
0.6 Tw
[(-rw-r--r-- 2)-600(nemo staff 0)-600(Aug )600(20 )600(19:20 )600(afile)]TJ
T*
[(-rw-r--r-- 2)-600(nemo staff 0)-600(Aug )600(20 )600(19:20 )600(another)]TJ
T*
0 Tw
(unix$ rm another)Tj
T*
(unix$ ls -l afile)Tj
T*
0.6 Tw
[(-rw-r--r-- 1)-600(nemo staff 0)-600(Aug )600(20 )600(19:20 )600(afile)]TJ
/TT6 1 Tf
10 0 0 10 72 330 Tm
0 Tw
(¿Recuerdas que ")Tj
/TT11 1 Tf
6.9604 0 TD
(.)Tj
/TT6 1 Tf
0.6001 0 TD
[(")-250(e)0(s)-250(otro nombre para el directorio actual? Observ)25(a)-250(l)0(a)-250(salida de este comando:)]TJ
/TT11 1 Tf
8 0 0 8 133 312 Tm
(unix$ ls -ld .)Tj
0 -1.5 TD
0.6 Tw
[(drwxr-xr-x 2)-600(nemo staff 1258)-600(Aug )600(20 )600(19:21 )600(.)]TJ
/TT6 1 Tf
10 0 0 10 72 282 Tm
0 Tw
(El )Tj
/TT7 1 Tf
1.2178 0 TD
(ß)Tj
/TT6 1 Tf
0.5562 0 TD
(ag)Tj
/TT11 1 Tf
1.2729 0 TD
(-d)Tj
/TT6 1 Tf
1.5293 0 TD
(de)Tj
/TT11 1 Tf
1.2729 0 TD
(ls)Tj
/TT6 1 Tf
1.5293 0 TD
0.0791 Tw
(hace que si listamos un nombre de directorio,)Tj
/TT11 1 Tf
19.0443 0 TD
0 Tw
(ls)Tj
/TT6 1 Tf
1.5292 0 TD
0.079 Tw
(liste el )Tj
/TT7 1 Tf
3.0462 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.079 Tw
(chero del directorio y no los)Tj
/TT7 1 Tf
-31.5543 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
[(cheros que contiene. ¿Puedes e)15(xplicar por qué ")]TJ
/TT11 1 Tf
19.108 0 TD
(.)Tj
/TT6 1 Tf
0.6001 0 TD
[(")-250(tiene 2 enlaces?)]TJ
-20.2643 -2.4 TD
-0.0003 Tc
0.0003 Tw
(Podemos jugar más...)Tj
/TT11 1 Tf
8 0 0 8 133 228 Tm
0 Tc
0 Tw
(unix$ mkdir /tmp/d)Tj
0 -1.5 TD
(unix$ mkdir /tmp/d/1 /tmp/d/2 /tmp/d3)Tj
T*
(unix$ ls -ld /tmp/d)Tj
T*
0.6 Tw
[(drwxr-xr-x 4)-600(nemo wheel 136)-600(Aug )600(20 )600(19:26 )600(/tmp/d)]TJ
/TT6 1 Tf
10 0 0 10 72 162 Tm
0 Tw
[(¿Aún no v)15(es por qué ")]TJ
/TT11 1 Tf
8.9191 0 TD
(/tmp/d)Tj
/TT6 1 Tf
3.6006 0 TD
[(")-250(tiene 4 enlaces? Aquí tienes una pista...)]TJ
/TT11 1 Tf
8 0 0 8 133 144 Tm
(unix$ ls -ld /tmp/d/1/..)Tj
0 -1.5 TD
0.6 Tw
[(drwxr-xr-x 4)-600(nemo wheel 136)-600(Aug )600(20 )600(19:26 )600(/tmp/d/1/..)]TJ
/TT2 1 Tf
10 0 0 10 72 90 Tm
0.25 Tw
[(9. Lectura)-250(de )250(dir)18(ectorios)]TJ
/TT6 1 Tf
0 -1.56 TD
0.0769 Tw
(Los directorios en UNIX son )Tj
/TT7 1 Tf
12.2434 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0769 Tw
(cheros que contienen una tabla de )Tj
/TT7 1 Tf
14.2334 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0769 Tw
(cheros pertenecientes al directorio. En)Tj
-27.5891 -1.2 TD
0 Tw
(cada entrada de la tabla hay dos cosas:)Tj
0 -3.84 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
78 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
80 0 obj
<<
/Length 4702
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-23-)Tj
-18.267 -3.6 TD
[(•)-2150(U)0(n)-250(nombre de )]TJ
/TT7 1 Tf
8.4708 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
-9.027 -1.56 TD
[(•)-2150(U)0(n)-250(número \(de)]TJ
/TT4 1 Tf
8.8038 0 TD
(i-nodo)Tj
/TT6 1 Tf
2.6108 0 TD
[(\))-250(que identi)]TJ
/TT7 1 Tf
4.5542 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(ca al )Tj
/TT7 1 Tf
2.1094 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero.)Tj
-21.6905 -1.2 TD
0.0298 Tw
(Cuando se crea un )Tj
/TT7 1 Tf
7.7276 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0298 Tw
(chero con)Tj
/TT11 1 Tf
4.2242 0 TD
0 Tw
(creat)Tj
/TT6 1 Tf
3.0005 0 TD
(,)Tj
/TT11 1 Tf
0.5298 0 TD
(open)Tj
/TT6 1 Tf
2.4004 0 TD
0.2798 Tc
(,o)Tj
/TT11 1 Tf
1.3095 0 TD
0 Tc
(mkdir)Tj
/TT6 1 Tf
3.2802 0 TD
0.0297 Tw
(se añade automáticamente la entrada de directorio)Tj
-23.0283 -1.2 TD
0.1113 Tw
(para el )Tj
/TT7 1 Tf
3.165 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1113 Tw
(chero o directorio que se ha creado. Recordarás que)Tj
/TT11 1 Tf
21.9363 0 TD
0 Tw
(link)Tj
/TT6 1 Tf
2.7617 0 TD
(\(o)Tj
/TT11 1 Tf
1.1943 0 TD
(ln)Tj
/TT6 1 Tf
1.2002 0 TD
0.1113 Tw
[(\))-361.3(puede usarse para establecer)]TJ
-30.8136 -1.2 TD
0.0766 Tw
[(nue)25(v)20(o)0(s)-326.6(enlaces para )]TJ
/TT7 1 Tf
8.4309 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0765 Tw
[(cheros que e)15(xisten \(nue)25(v)25(a)0(s)-326.6(entradas de directorio con el número de un )]TJ
/TT7 1 Tf
29.1762 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0765 Tw
[(chero e)15(xis-)]TJ
-38.7194 -1.2 TD
0 Tw
(tente\) y que)Tj
/TT11 1 Tf
4.9702 0 TD
(unlink)Tj
/TT6 1 Tf
3.8506 0 TD
(o)Tj
/TT11 1 Tf
0.75 0 TD
(rmdir)Tj
/TT6 1 Tf
3.2505 0 TD
(pueden utilizarse para eliminar nombres.)Tj
-12.8213 -2.4 TD
0.1594 Tw
(Hace tiempo UNIX permitía utilizar)Tj
/TT11 1 Tf
15.5416 0 TD
0 Tw
(read)Tj
/TT6 1 Tf
2.8098 0 TD
(y)Tj
/TT11 1 Tf
0.9094 0 TD
(write)Tj
/TT6 1 Tf
3.4099 0 TD
0.1594 Tw
(para leer y escribir directorios. No obstante, esto)Tj
-22.6707 -1.2 TD
0.0523 Tw
[(causó tantos problemas cada v)15(ez un usuario escribía incorrectamente la tabla que desde hace tiempo no se)]TJ
T*
0 Tw
(puede utilizar)Tj
/TT11 1 Tf
5.7197 0 TD
(read)Tj
/TT6 1 Tf
2.6504 0 TD
(o)Tj
/TT11 1 Tf
0.75 0 TD
(write)Tj
/TT6 1 Tf
3.2505 0 TD
(para leer una tabla de directorio.)Tj
-12.3706 -2.4 TD
-0.0005 Tc
0.0239 Tw
(En lugar de)Tj
/TT4 1 Tf
4.9246 0 TD
0 Tc
0 Tw
[(r)37(ead\(2\))]TJ
/TT6 1 Tf
2.962 0 TD
0.0235 Tw
[(,)-273.4(para directorios tenemos la llamada al sistema)]TJ
/TT4 1 Tf
19.3754 0 TD
0 Tw
[(g)10(etdir)37(entries\(2\))]TJ
/TT6 1 Tf
6.2294 0 TD
0.0235 Tw
[(.)-273.5(N)0(o)-273.5(obstante, es mucho)]TJ
-33.4914 -1.2 TD
0.0062 Tw
(más fácil utilizar las funciones)Tj
/TT4 1 Tf
12.4988 0 TD
0 Tw
(opendir\(3\))Tj
/TT6 1 Tf
4.2769 0 TD
(,)Tj
/TT4 1 Tf
0.5062 0 TD
[(r)37(eaddir\(3\))]TJ
/TT6 1 Tf
4.3852 0 TD
(y)Tj
/TT4 1 Tf
0.7562 0 TD
(closedir\(3\))Tj
/TT6 1 Tf
4.6439 0 TD
0.0062 Tw
(que tenemos en la librería de C. No sólo)Tj
-27.0671 -1.2 TD
0.0045 Tw
[(es más fácil. Es más portable. Piensa que el formato e)15(xacto de una entrada de directorio depende del tipo de)]TJ
T*
0.0408 Tw
(sistema de )Tj
/TT7 1 Tf
4.525 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0408 Tw
(cheros que utilices \(del programa que implementa los )Tj
/TT7 1 Tf
21.9861 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0408 Tw
(cheros en esa partición o donde quiera)Tj
-27.6233 -1.2 TD
0 Tw
(que estén los )Tj
/TT7 1 Tf
5.4155 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
[(cheros, y que forma parte del k)10(ernel\).)]TJ
-5.9717 -2.4 TD
(Aquí tienes un ejemplo de cómo listar un directorio en C.)Tj
/TT11 1 Tf
8 0 0 8 133 482.4 Tm
(#include <stdio.h>)Tj
0 -1.5 TD
(#include <stdlib.h>)Tj
T*
(#include <sys/dir.h>)Tj
T*
(#include <dirent.h>)Tj
T*
(#include <err.h>)Tj
0 -3 TD
(int)Tj
0 -1.5 TD
(main\(int argc, char* argv[]\))Tj
T*
({)Tj
2.4 -1.5 TD
(DIR *d;)Tj
T*
(struct dirent *de;)Tj
0 -3 TD
[(d)-600(=)-600(opendir\("."\);)]TJ
0 -1.5 TD
(if\(d == NULL\) {)Tj
2.4 -1.5 TD
(err\(1, "opendir"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(while\(\(de = readdir\(d\)\) != NULL\) {)Tj
2.4 -1.5 TD
(printf\("%s\\n", de->d_name\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(if \(closedir\(d\) < 0\) {)Tj
2.4 -1.5 TD
(err\(1, "closedir"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(exit\(0\);)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 176.4 Tm
(Este programa lista el contenido del directorio actual. Por ejemplo,)Tj
/TT11 1 Tf
8 0 0 8 133 158.4 Tm
(unix$ lsdot)Tj
T*
(.)Tj
T*
(..)Tj
T*
(lsdot.c)Tj
T*
(lsdot)Tj
T*
(ch03e.w)Tj
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 68.4 Tm
[(Como v)15(erás, aparecen tanto ")]TJ
/TT11 1 Tf
11.7496 0 TD
(.)Tj
/TT6 1 Tf
0.6001 0 TD
[(")-250(como ")]TJ
/TT11 1 Tf
3.5381 0 TD
(..)Tj
/TT6 1 Tf
1.2002 0 TD
(".)Tj
-17.088 -4.44 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
81 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
83 0 obj
<<
/Length 4017
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-24-)Tj
-20.767 -3.6 TD
0.0692 Tw
(Cada llamada a)Tj
/TT11 1 Tf
6.6213 0 TD
0 Tw
(readdir)Tj
/TT6 1 Tf
4.52 0 TD
0.0693 Tw
[(de)25(vuelv)15(e)-319.3(una estructura de tipo)]TJ
/TT11 1 Tf
13.0516 0 TD
(struct dirent)Tj
/TT6 1 Tf
7.8706 0 TD
[(.)-319.3(Dicha estructura no debes)]TJ
-32.0634 -1.2 TD
0.0024 Tw
[(liberarla, se)15(gún indica el manual, y si llamas de nue)25(v)20(o)20( )-20(a)]TJ
/TT11 1 Tf
22.5978 0 TD
0 Tw
(readdir)Tj
/TT6 1 Tf
4.4531 0 TD
0.0024 Tw
(la estructura antigua se sobreescribe con)Tj
-27.0509 -1.2 TD
-0.025 Tc
0.025 Tw
[(l)-25(a)-25( n)-25(u)-25(eva )]TJ
3.5594 0 TD
0 Tc
0 Tw
(muy posiblemente.)Tj
-3.5594 -2.4 TD
0.0595 Tw
(Esta estructura cambia mucho de un tipo de UNIX a otro, aunque en la mayoría las entradas de directorio)Tj
0 -1.2 TD
0 Tw
(son similares. Por ejemplo, esta es la que utiliza Linux:)Tj
/TT11 1 Tf
8 0 0 8 160.8 630 Tm
(struct dirent {)Tj
2.4 -1.5 TD
[(ino_t )-5400(d_ino;)-4200(/* inode number */)]TJ
T*
[(off_t )-5400(d_off;)-4200(/* not an offset; see NOTES */)]TJ
T*
[(unsigned short d_reclen;)-2400(/* length of this record */)]TJ
T*
[(unsigned char)-1200(d_type; )-3000(/*)-600(type of file; not supported)]TJ
18.6 -1.5 TD
(by all filesystem types */)Tj
-18.6 -1.5 TD
[(char )-6000(d_name[256];)-600(/* filename */)]TJ
-2.4 -1.5 TD
(};)Tj
/TT6 1 Tf
10 0 0 10 72 516 Tm
0.1133 Tw
(Normalmente, siempre tienes el campo)Tj
/TT11 1 Tf
16.4498 0 TD
0 Tw
(d_name)Tj
/TT6 1 Tf
3.6006 0 TD
0.1133 Tw
[(.)-363.3(E)0(n)-363.3(Linux y sistemas BSD tienes)]TJ
/TT11 1 Tf
14.4591 0 TD
0 Tw
(d_type)Tj
/TT6 1 Tf
3.9638 0 TD
0.1132 Tw
(también. El)Tj
-38.4733 -1.2 TD
0.0323 Tw
[(resto de campos suelen v)25(ariar de nombre y tal v)15(ez no estén en tu UNIX. Si utilizas algo más que)]TJ
/TT11 1 Tf
39.3459 0 TD
0 Tw
(d_name)Tj
/TT6 1 Tf
3.6006 0 TD
(,)Tj
-42.9465 -1.2 TD
[(se)15(guramente tu código deje de ser portable a otros tipos de UNIX.)]TJ
0 -2.4 TD
0.0666 Tw
(Cuando tienes)Tj
/TT11 1 Tf
6.0766 0 TD
0 Tw
(d_type)Tj
/TT6 1 Tf
3.6006 0 TD
0.0666 Tw
[(,)-316.6(este campo v)25(ale)]TJ
/TT11 1 Tf
7.377 0 TD
0 Tw
(DT_DIR)Tj
/TT6 1 Tf
3.9171 0 TD
0.0665 Tw
(para directorios,)Tj
/TT11 1 Tf
6.8801 0 TD
0 Tw
(DT_REG)Tj
/TT6 1 Tf
3.9171 0 TD
(para )Tj
/TT7 1 Tf
2.0372 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0665 Tw
(cheros \()Tj
/TT7 1 Tf
3.2594 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0665 Tw
[(cheros re)15(gu-)]TJ
-38.1773 -1.2 TD
0 Tw
[(lares o normales\) y otros v)25(alores para otros tipos de )]TJ
/TT7 1 Tf
20.8583 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
[(chero que v)15(eremos más adelante.)]TJ
-21.4145 -2.4 TD
0.2385 Tw
(Naturalmente, nunca se escribe un directorio, este se actualiza creando, borrando y renombrando los)Tj
/TT7 1 Tf
0 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0327 Tw
[(cheros que contiene. Y)100(a)-282.8(conoces todo lo necesario, salv)20(o)-282.7(por cómo renombrar )]TJ
/TT7 1 Tf
31.762 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0327 Tw
(cheros. La llamada al sis-)Tj
-32.8743 -1.2 TD
0 Tw
(tema en cuestión es)Tj
/TT4 1 Tf
8.0527 0 TD
[(r)37(ename\(2\))]TJ
/TT6 1 Tf
4.128 0 TD
(.)Tj
-12.1808 -2.4 TD
(Este programa renombra un )Tj
/TT7 1 Tf
11.3848 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero, similar al uso más sencillo del comando)Tj
/TT4 1 Tf
18.9673 0 TD
(mv\(1\))Tj
/TT6 1 Tf
2.332 0 TD
(.)Tj
/TT11 1 Tf
8 0 0 8 133 366 Tm
(#include <stdio.h>)Tj
0 -1.5 TD
(#include <stdlib.h>)Tj
T*
(#include <err.h>)Tj
0 -3 TD
(int)Tj
0 -1.5 TD
(main\(int argc, char* argv[]\))Tj
T*
({)Tj
2.4 -3 TD
(if \(argc != 3\) {)Tj
2.4 -1.5 TD
(fprintf\(stderr, "usage: %s old new\\n", argv[0]\);)Tj
T*
(exit\(1\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(if \(rename\(argv[1], argv[2]\) < 0\) {)Tj
2.4 -1.5 TD
(err\(1, "rename %s", argv[1]\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(exit\(0\);)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 144 Tm
[(Podemos usarlo para mo)15(v)15(e)0(r)-250(u)0(n)]TJ
/TT7 1 Tf
12.6062 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero a notro nombre:)Tj
-13.1624 -12 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
84 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
86 0 obj
<<
/Length 4509
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-25-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(unix$ echo hola >a)Tj
0 -1.5 TD
(unix$ cat a)Tj
T*
(hola)Tj
T*
(unix$ mvf a b)Tj
T*
(unix$ ls -l a b)Tj
T*
(ls: a: No such file or directory)Tj
T*
0.6 Tw
[(-rw------- 1)-600(nemo staff 5)-600(Aug )600(20 )600(22:13 )600(b)]TJ
T*
0 Tw
(unix$ cat b)Tj
T*
(hola)Tj
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 570 Tm
0.0197 Tw
(Has de tener en cuenta que si el )Tj
/TT7 1 Tf
13.0409 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0197 Tw
[(chero de destino e)15(xiste, se borra \(su nombre\) durante el)]TJ
/TT4 1 Tf
22.5907 0 TD
0 Tw
[(r)37(ename)]TJ
/TT6 1 Tf
2.962 0 TD
[(.)-269.7(Además,)]TJ
-39.1498 -1.2 TD
0.0154 Tw
(es un error hacer un)Tj
/TT4 1 Tf
8.2673 0 TD
0 Tw
[(r)37(ename)]TJ
/TT6 1 Tf
3.2273 0 TD
0.0153 Tw
[(hacia un directorio no v)25(acío. Y otra cosa, si recuerdas el comando)]TJ
/TT4 1 Tf
26.7592 0 TD
0 Tw
(mv\(1\))Tj
/TT6 1 Tf
2.332 0 TD
[(,)-265.3(v)15(erás)]TJ
-40.5859 -1.2 TD
(que)Tj
/TT11 1 Tf
8 0 0 8 133 528 Tm
(unix$ mv a /tmp)Tj
/TT6 1 Tf
10 0 0 10 72 510 Tm
0.015 Tw
[(mue)25(v)15(e)15( el)]TJ
/TT7 1 Tf
3.8472 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
/TT11 1 Tf
2.4707 0 TD
(a)Tj
/TT6 1 Tf
0.8501 0 TD
(a)Tj
/TT11 1 Tf
0.6938 0 TD
(/tmp/a)Tj
/TT6 1 Tf
3.6006 0 TD
[(.)-250(N)0(o)-250(obstante,)]TJ
/TT11 1 Tf
8 0 0 8 133 492 Tm
(unix$ mvf a /tmp)Tj
0 -1.5 TD
(mvf: rename a: Permission denied)Tj
/TT6 1 Tf
10 0 0 10 72 462 Tm
0.039 Tw
(nuestro programa no es tan listo e intenta hacer que)Tj
/TT11 1 Tf
21.2162 0 TD
0 Tw
(a)Tj
/TT6 1 Tf
0.8891 0 TD
-0.0003 Tc
0.0393 Tw
[(tenga)-289.3(como nombre)]TJ
/TT11 1 Tf
8.3039 0 TD
0 Tc
0 Tw
(/tmp)Tj
/TT6 1 Tf
2.6894 0 TD
0.039 Tw
(\(que es un directorio que)Tj
-33.0986 -1.2 TD
0 Tw
[(ya e)15(xiste\).)]TJ
/TT2 1 Tf
0 -3.6 TD
0.25 Tw
[(10. Glob)10(bing)]TJ
/TT6 1 Tf
0 -1.56 TD
0.002 Tw
(Dado que gran parte de las "palabras" que escribimos en una línea de comandos corresponden a nombres de)Tj
/TT7 1 Tf
0 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1101 Tw
[(chero, el shell da f)10(acilidades para e)15(xpresar de un modo compacto nombres de )]TJ
/TT7 1 Tf
32.6172 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1102 Tw
(chero que tienen cierto)Tj
-33.7295 -1.2 TD
0.0884 Tw
[(aspecto. Dicho de otro modo, el shell permite utilizar e)15(xpresiones que)]TJ
/TT4 1 Tf
29.1434 0 TD
0 Tw
[(g)10(ener)15(an)]TJ
/TT6 1 Tf
3.5903 0 TD
0.0883 Tw
(nombres de )Tj
/TT7 1 Tf
5.0643 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0883 Tw
(chero o que)Tj
/TT4 1 Tf
-38.3541 -1.2 TD
0 Tw
(encajan)Tj
/TT6 1 Tf
3.4155 0 TD
(con nombres de )Tj
/TT7 1 Tf
6.5815 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero. A esta herramienta se la conoce como)Tj
/TT4 1 Tf
18.1304 0 TD
(globbing)Tj
/TT6 1 Tf
3.5557 0 TD
(.)Tj
-32.2393 -2.4 TD
0.0362 Tw
[(Y)100(a)100( )-100(sabes que en general una b)20(uena forma de saber cómo funcionan las cosas es e)15(xperimentar con ellas, así)]TJ
0 -1.2 TD
0 Tw
[(que v)25(amos a crear un directorio con ciertos )]TJ
/TT7 1 Tf
17.4677 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
[(cheros dentro para e)15(xperimentar)40(,)-250(tal y como harías tu.)]TJ
/TT11 1 Tf
8 0 0 8 133 308.4 Tm
(unix$ mkdir -p /tmp/d/d2/d3)Tj
0 -1.5 TD
(unix$ touch /tmp/d/a /tmp/d/ab /tmp/d/abc)Tj
T*
(unix$ touch /tmp/d/d2/j /tmp/d/d2/k)Tj
T*
[(unix$ touch /tmp/d/d2/d3/x)-1200(/tmp/d/d2/d3/y)]TJ
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 242.4 Tm
(El )Tj
/TT7 1 Tf
1.1884 0 TD
(ß)Tj
/TT6 1 Tf
0.5562 0 TD
(ag)Tj
/TT11 1 Tf
1.2435 0 TD
(-p)Tj
/TT6 1 Tf
1.4999 0 TD
(de)Tj
/TT11 1 Tf
1.2435 0 TD
(mkdir)Tj
/TT6 1 Tf
3.3002 0 TD
0.0496 Tw
[(hace que se cree el directorio indicado como ar)18(gumento y los directorios padre si es)]TJ
-9.0317 -1.2 TD
0 Tw
[(que no e)15(xisten.)]TJ
0 -2.4 TD
0.0379 Tw
(Podemos utilizar el comando)Tj
/TT4 1 Tf
12.0378 0 TD
0 Tw
(du\(1\))Tj
/TT6 1 Tf
2.4539 0 TD
(\()Tj
/TT4 1 Tf
0.333 0 TD
0.0379 Tw
[(disk usa)10(g)10(e)]TJ
/TT6 1 Tf
4.2117 0 TD
[(\))-287.9(para que liste el árbol de )]TJ
/TT7 1 Tf
10.9002 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.038 Tw
[(cheros que hemos creado.)-538(Este)]TJ
-30.4928 -1.2 TD
0.0391 Tw
(comando en realidad lista cuándo disco consumen )Tj
/TT7 1 Tf
20.573 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0391 Tw
(cheros y directorios, pero es una forma práctica de lis-)Tj
-21.1292 -1.2 TD
0 Tw
(tar árboles de )Tj
/TT7 1 Tf
5.6362 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(cheros \(¡Más práctica que utilizando)Tj
/TT11 1 Tf
14.855 0 TD
(ls)Tj
/TT6 1 Tf
1.2002 0 TD
(!\).)Tj
-22.2476 -15.84 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
87 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
89 0 obj
<<
/Length 4831
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-26-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(unix$ du -a /tmp/d)Tj
0 -1.5 TD
[(0)-2400(/tmp/d/1)]TJ
T*
[(0)-2400(/tmp/d/2)]TJ
T*
[(0)-2400(/tmp/d/a)]TJ
T*
[(0)-2400(/tmp/d/ab)]TJ
T*
[(0)-2400(/tmp/d/abc)]TJ
T*
[(0)-2400(/tmp/d/d2/d3/x)]TJ
T*
[(0)-2400(/tmp/d/d2/d3/y)]TJ
T*
[(0)-2400(/tmp/d/d2/d3)]TJ
T*
[(0)-2400(/tmp/d/d2/j)]TJ
T*
[(0)-2400(/tmp/d/d2/k)]TJ
T*
[(0)-2400(/tmp/d/d2)]TJ
T*
[(0)-2400(/tmp/d)]TJ
/TT6 1 Tf
10 0 0 10 72 546 Tm
(El )Tj
/TT7 1 Tf
1.1387 0 TD
(ß)Tj
/TT6 1 Tf
0.5562 0 TD
(ag)Tj
/TT11 1 Tf
1.1938 0 TD
(-a)Tj
/TT6 1 Tf
1.4502 0 TD
(de)Tj
/TT11 1 Tf
1.1938 0 TD
(du)Tj
/TT6 1 Tf
1.4502 0 TD
(hace que liste no sólo los directorios, sino también los )Tj
/TT7 1 Tf
21.8574 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(cheros.)Tj
-29.3965 -2.4 TD
0.0747 Tw
[(Pero continuemos. Cuando el shell v)15(e)-324.7(que un nombre en la línea de comandos contiene ciertos caracteres)]TJ
0 -1.2 TD
0.0329 Tw
(especiales, intenta encontrar paths de )Tj
/TT7 1 Tf
15.269 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0328 Tw
[(chero que encajan con dicho nombre y)65(,)-282.9(si)-282.8(los encuentra, cambia ese)]TJ
-15.8251 -1.2 TD
0.0991 Tw
(nombre los pos paths, separados por espacio. En realidad, deberíamos llamar)Tj
/TT4 1 Tf
32.0809 0 TD
0 Tw
[(e)20(xpr)37(esión)]TJ
/TT6 1 Tf
4.1799 0 TD
0.0992 Tw
[(a)-349.2(l)0(o)-349.2(que estamos)]TJ
-36.2608 -1.2 TD
0 Tw
(llamando "nombre".)Tj
0 -2.4 TD
(Por ejemplo, en este comando)Tj
/TT11 1 Tf
8 0 0 8 133 444 Tm
(unix$ echo /tmp/d/*)Tj
0 -1.5 TD
(/tmp/d/1 /tmp/d/2 /tmp/d/a /tmp/d/ab /tmp/d/abc /tmp/d/d2)Tj
/TT6 1 Tf
10 0 0 10 72 414 Tm
0.0595 Tw
(el shell ha tomado ")Tj
/TT11 1 Tf
8.1999 0 TD
0 Tw
(/tmp/d/*)Tj
/TT6 1 Tf
4.8008 0 TD
0.0595 Tw
[(")-309.5(y)65(,)-309.5(como puedes v)15(er por la salida de)]TJ
/TT11 1 Tf
15.4701 0 TD
0 Tw
(echo)Tj
/TT6 1 Tf
2.4004 0 TD
0.0594 Tw
[(,)-309.5(l)0(o)-309.4(h)0(a)-309.4(cambiado por los nom-)]TJ
-30.8712 -1.2 TD
0 Tw
(bres de )Tj
/TT7 1 Tf
3.1099 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero en ")Tj
/TT11 1 Tf
4.0728 0 TD
(/tmp/d)Tj
/TT6 1 Tf
3.6006 0 TD
(".)Tj
-11.3394 -2.4 TD
(Pero mira este otro comando:)Tj
/TT11 1 Tf
8 0 0 8 133 360 Tm
(unix$ echo /tmp/d/a*)Tj
0 -1.5 TD
(/tmp/d/a /tmp/d/ab /tmp/d/abc)Tj
/TT6 1 Tf
10 0 0 10 72 330 Tm
(Aquí el shell ha cambiado ")Tj
/TT11 1 Tf
11.0996 0 TD
(/tmp/d/a*)Tj
/TT6 1 Tf
5.4009 0 TD
[(")-250(por los nombres de )]TJ
/TT7 1 Tf
8.5459 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero en)Tj
/TT11 1 Tf
3.6646 0 TD
(/tmp/d)Tj
/TT6 1 Tf
3.8506 0 TD
(que comienzan por ")Tj
/TT11 1 Tf
8.2661 0 TD
(a)Tj
/TT6 1 Tf
0.6001 0 TD
(".)Tj
-41.9839 -2.4 TD
[(V)111(eamos otro más...)]TJ
/TT11 1 Tf
8 0 0 8 133 288 Tm
(unix$ echo /*/ls)Tj
0 -1.5 TD
(/bin/ls)Tj
/TT6 1 Tf
10 0 0 10 72 258 Tm
[(El shell ha b)20(uscado en ")]TJ
/TT11 1 Tf
9.5801 0 TD
(/)Tj
/TT6 1 Tf
0.6001 0 TD
[(")-250(cualquier )]TJ
/TT7 1 Tf
4.6284 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
-0.0001 Tc
0.0001 Tw
[(chero que sea un directorio y contenga)-250.1(u)-0.1(n)]TJ
/TT7 1 Tf
16.933 0 TD
0 Tc
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero llamado ")Tj
/TT11 1 Tf
6.3501 0 TD
(ls)Tj
/TT6 1 Tf
1.2002 0 TD
(".)Tj
-40.4042 -2.4 TD
[(Las e)15(xpresiones de globbing son fáciles de entender:)]TJ
2.5 -1.56 TD
0.139 Tw
[(•)-2150(E)0(l)-389(shell las recorre componente a componente mirando cada una de las sube)15(xpresiones que)]TJ
2.5 -1.2 TD
0 Tw
(corresponden a nombres de directorio en el path.)Tj
-2.5 -1.56 TD
[(•)-2150(Naturalmente, ")]TJ
/TT11 1 Tf
8.8502 0 TD
(/)Tj
/TT6 1 Tf
0.6001 0 TD
[(")-250(separa unos componentes de otros.)]TJ
-9.4503 -1.56 TD
0.1732 Tw
[(•)-2150(E)0(n)-423.2(cada componente intenta encontrar todos los )]TJ
/TT7 1 Tf
23.1227 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1732 Tw
[(cheros cuyo nombre encaja en la sube)15(x-)]TJ
-21.1788 -1.2 TD
0 Tw
(presión para dicho componente.)Tj
-2.5 -1.56 TD
[(•)-2150(E)0(n)-250(cada componente podemos tener caracteres normales o alguna de estas e)15(xpresiones:)]TJ
2.5 -1.56 TD
2.15 Tc
(•")Tj
/TT11 1 Tf
2.9083 0 TD
0 Tc
(*)Tj
/TT6 1 Tf
0.6001 0 TD
[(")-250(encaja con cualquier string, incluso con el string v)25(acío.)]TJ
-3.5084 -1.56 TD
2.15 Tc
(•")Tj
/TT11 1 Tf
2.9083 0 TD
0 Tc
([...])Tj
/TT6 1 Tf
3.0005 0 TD
0.2225 Tw
[(")-472.5(encaja con cualquier carácter contenido en los corchetes. Aquí es posible)]TJ
-3.4088 -1.2 TD
0 Tw
(indicar rangos de caracteres como en ")Tj
/TT11 1 Tf
15.4561 0 TD
([a-z])Tj
/TT6 1 Tf
3.0005 0 TD
[(")-250(\(las letras de la ")]TJ
/TT11 1 Tf
7.3413 0 TD
(a)Tj
/TT6 1 Tf
0.6001 0 TD
0.25 Tc
[("al)250(a")]TJ
/TT11 1 Tf
2.7319 0 TD
0 Tc
(z)Tj
/TT6 1 Tf
0.6001 0 TD
("\).)Tj
-32.23 -1.56 TD
2.15 Tc
(•")Tj
/TT11 1 Tf
2.9083 0 TD
0 Tc
(?)Tj
/TT6 1 Tf
0.6001 0 TD
[(")-250(encaja con un sólo carácter)55(.)]TJ
-8.5084 -2.4 TD
(Por ejemplo,)Tj
0 -4.08 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
90 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
92 0 obj
<<
/Length 4517
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-27-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(unix$ cd /tmp/d)Tj
0 -1.5 TD
(unix$ ls)Tj
T*
2.4 Tc
[(12aa)2400(b)]TJ
12.6005 0 TD
0 Tc
1.8 Tw
(abc d2)Tj
-12.6005 -1.5 TD
0 Tw
(unix$ echo [12]*)Tj
T*
0.6 Tc
(12)Tj
T*
0 Tc
(unix$ echo [ab]*)Tj
T*
0.6 Tc
[(aa)600(ba)600(b)600(c)]TJ
T*
0 Tc
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 606 Tm
0.031 Tw
[(La primera e)15(xpresión quiere decir: "un)]TJ
/TT11 1 Tf
15.9059 0 TD
0 Tw
(1)Tj
/TT6 1 Tf
0.8811 0 TD
0.281 Tc
[(ou)281(n)]TJ
/TT11 1 Tf
2.062 0 TD
0 Tc
(2)Tj
/TT6 1 Tf
0.8811 0 TD
0.031 Tw
[(y)-281(lue)15(go cualquier cosa" La se)15(gunda quiere decir: "una)]TJ
/TT11 1 Tf
22.0844 0 TD
0 Tw
(a)Tj
/TT6 1 Tf
0.8811 0 TD
(o)Tj
-42.6956 -1.2 TD
(una)Tj
/TT11 1 Tf
1.6938 0 TD
(b)Tj
/TT6 1 Tf
0.8501 0 TD
[(y)-250(lue)15(go cualquier cosa".)]TJ
-2.5439 -2.4 TD
(Otro ejemplo:)Tj
/TT11 1 Tf
8 0 0 8 133 552 Tm
(unix$ ls /tmp/*/d*/?)Tj
0 -1.5 TD
1.8 Tw
(/tmp/d/d2/j /tmp/d/d2/k)Tj
/TT6 1 Tf
10 0 0 10 72 522 Tm
0.0068 Tw
(Esto es, dentro de ")Tj
/TT11 1 Tf
7.7948 0 TD
0 Tw
(/tmp)Tj
/TT6 1 Tf
2.4004 0 TD
-0.0001 Tc
0.0069 Tw
[(", cualquier nombre de directorio que tenga)-256.9(dentro un directorio que comience por)]TJ
-10.1952 -1.2 TD
0 Tc
0 Tw
(")Tj
/TT11 1 Tf
0.4082 0 TD
(d)Tj
/TT6 1 Tf
0.6001 0 TD
-0.0004 Tc
0.0004 Tw
[(")-250.4(y)-250.4(tenga)-250.4(dentro un )]TJ
/TT7 1 Tf
7.8734 0 TD
0 Tc
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero cuyo nombre sea un sólo carácter y nada más.)Tj
-9.4379 -2.4 TD
(Quizá el uso más común sea en comandos como)Tj
/TT11 1 Tf
8 0 0 8 133 468 Tm
(unix$ ls *.[ch])Tj
/TT6 1 Tf
10 0 0 10 72 450 Tm
0.0273 Tw
(para listar los fuentes en C \()Tj
/TT7 1 Tf
11.3826 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0272 Tw
[(cheros cuyo nombre es cualquier cosa, lue)15(go un ")]TJ
/TT11 1 Tf
20.0216 0 TD
0 Tw
(.)Tj
/TT6 1 Tf
0.6001 0 TD
0.0272 Tw
[(")-277.2(y)-277.2(lue)15(go o bien una ")]TJ
/TT11 1 Tf
8.8518 0 TD
0 Tw
(c)Tj
/TT6 1 Tf
0.6001 0 TD
0.2772 Tc
("o)Tj
-42.0123 -1.2 TD
0 Tc
(una ")Tj
/TT11 1 Tf
2.1021 0 TD
(h)Tj
/TT6 1 Tf
0.6001 0 TD
(", y como)Tj
/TT11 1 Tf
8 0 0 8 133 420 Tm
(unix$ rm *.o)Tj
/TT6 1 Tf
10 0 0 10 72 402 Tm
(para borrar todos los )Tj
/TT7 1 Tf
8.4976 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(cheros objeto \(cualquier nombre terminado en ")Tj
/TT11 1 Tf
19.1235 0 TD
(.o)Tj
/TT6 1 Tf
1.2002 0 TD
("\).)Tj
-29.3774 -2.4 TD
0.027 Tw
(Recuerda que ninguno de estos comandos sabe nada respecto a globbing, ni entienden qué quiere decir ")Tj
/TT11 1 Tf
42.1874 0 TD
0 Tw
(*)Tj
/TT6 1 Tf
0.6001 0 TD
(")Tj
-42.7875 -1.2 TD
0.0842 Tw
[(ni lo v)15(en siquiera.)-584.2(Es el shell cuando analiza la línea de comandos el que detecta que hay una e)15(xpresión)]TJ
T*
0.0297 Tw
[(que contiene caracteres de globbing, y cambia dicha e)15(xpresión por los nombres de los )]TJ
/TT7 1 Tf
34.9726 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0297 Tw
(cheros que encajan)Tj
-35.5287 -1.2 TD
0.0647 Tw
[(en la e)15(xpresión. )-250(Los)-314.7(comandos simplemente reciben los ar)18(gumentos con los paths y se limitan a hacer su)]TJ
T*
0 Tw
(trabajo.)Tj
0 -2.4 TD
-0.0001 Tc
0.0001 Tw
[(En ocasiones resultará útil hacer que el shell no haga)-250.1(globbing, como en esta sesión:)]TJ
/TT11 1 Tf
8 0 0 8 133 288 Tm
0 Tc
0 Tw
(unix$ touch ’*’)Tj
/TT6 1 Tf
10 0 0 10 72 270 Tm
0.042 Tw
(Hemos creado un )Tj
/TT7 1 Tf
7.3736 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.042 Tw
(chero llamado ")Tj
/TT11 1 Tf
6.4341 0 TD
0 Tw
(*)Tj
/TT6 1 Tf
0.6001 0 TD
0.042 Tw
[(". Esta v)15(ez a sabiendas, pero podría haber sido por error)55(.)-292(P)15(ara hacerlo)]TJ
-14.9639 -1.2 TD
0.0033 Tw
(simplemente utilizamos las comillas simples para hacer que el shell tome)Tj
/TT4 1 Tf
29.5558 0 TD
0 Tw
[(liter)15(almente)]TJ
/TT6 1 Tf
5.0703 0 TD
0.0033 Tw
[(y)-253.3(sin cambiar nada lo)]TJ
-34.6262 -1.2 TD
0 Tw
(que incluyen las comillas \(y como una sóla palabra\).)Tj
0 -2.4 TD
[(Y)-250(ahora tenemos el dilema.)]TJ
/TT11 1 Tf
8 0 0 8 133 204 Tm
(unix$ ls)Tj
0 -1.5 TD
2.4 Tc
[(*12aa)2400(b)]TJ
15.6006 0 TD
0 Tc
1.8 Tw
(abc d2)Tj
-15.6006 -1.5 TD
0 Tw
(unix$ echo *)Tj
T*
0.6 Tc
[(*12aa)600(b)]TJ
6.6006 0 TD
0 Tc
(abc d2)Tj
/TT6 1 Tf
10 0 0 10 72 150 Tm
(Si utilizamos)Tj
/TT11 1 Tf
8 0 0 8 133 132 Tm
(unix$ rm *)Tj
/TT6 1 Tf
10 0 0 10 72 114 Tm
(para eliminar ")Tj
/TT11 1 Tf
5.9609 0 TD
(*)Tj
/TT6 1 Tf
0.6001 0 TD
(", ¡borraremos todos los )Tj
/TT7 1 Tf
9.8789 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(cheros! y no es lo que queremos. Pero podemos hacer esto:)Tj
-16.9961 -9 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
93 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
95 0 obj
<<
/Length 4170
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-28-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(unix$ rm ’*’)Tj
0 -1.5 TD
(unix$ ls)Tj
T*
2.4 Tc
[(12aa)2400(b)]TJ
12.6005 0 TD
0 Tc
1.8 Tw
(abc d2)Tj
/TT2 1 Tf
10 0 0 10 72 642 Tm
0.25 Tw
(11. Metadatos)Tj
/TT6 1 Tf
0 -1.56 TD
0 Tw
(Los )Tj
/TT7 1 Tf
1.766 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.016 Tw
[(cheros, como ya sabes en este punto, no sólo tienen datos.)-516(T)35(ienen además atrib)20(utos, o datos sobre los)]TJ
-2.3222 -1.2 TD
0.0851 Tw
(datos, o)Tj
/TT2 1 Tf
3.531 0 TD
0 Tw
(metadatos)Tj
/TT6 1 Tf
4.3882 0 TD
0.0851 Tw
[(.)-335.1(Por ejemplo, el)]TJ
/TT4 1 Tf
7.1724 0 TD
0 Tw
(uid)Tj
/TT6 1 Tf
1.6129 0 TD
0.0851 Tw
(del dueño del )Tj
/TT7 1 Tf
5.8925 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0851 Tw
(chero, el)Tj
/TT4 1 Tf
3.8625 0 TD
0 Tw
(gid)Tj
/TT6 1 Tf
1.6128 0 TD
0.085 Tw
[(del grupo al que pertenece, los per)20(-)]TJ
-28.6286 -1.2 TD
0 Tw
(misos, el contador de referencias, etc.)Tj
0 -2.4 TD
0.0734 Tw
(En UNIX, todos estos metadatos se guardan en la estructura de datos que representa al )Tj
/TT7 1 Tf
35.9228 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0734 Tw
(chero, que es un)Tj
-36.4789 -1.2 TD
0.1547 Tw
(record que UNIX llama)Tj
/TT4 1 Tf
10.3371 0 TD
0 Tw
(i-nodo)Tj
/TT6 1 Tf
2.6108 0 TD
0.1547 Tw
[(.)-404.7(L)0(a)-404.7(llamada al sistema)]TJ
/TT4 1 Tf
10.2144 0 TD
0 Tw
(stat\(2\))Tj
/TT6 1 Tf
3.0155 0 TD
0.1547 Tw
[(sirv)15(e)-404.7(para recuperar los metadatos de un)]TJ
/TT7 1 Tf
-26.1779 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0388 Tw
[(chero. El siguiente programa mejora nuestro programa para listar directorios y muestra distintos atrib)20(utos)]TJ
-0.5562 -1.2 TD
0.035 Tw
(de cada )Tj
/TT7 1 Tf
3.3454 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.035 Tw
[(chero contenido en los directorios cuyo nombre se indica como ar)18(gumento \(el directorio actual si)]TJ
-3.9015 -1.2 TD
0 Tw
(no se indica ninguno\).)Tj
/TT11 1 Tf
8 0 0 8 133 512.4 Tm
(#include <stdio.h>)Tj
0 -1.5 TD
(#include <stdlib.h>)Tj
T*
(#include <sys/dir.h>)Tj
T*
(#include <sys/stat.h>)Tj
T*
(#include <dirent.h>)Tj
T*
(#include <string.h>)Tj
T*
(#include <time.h>)Tj
T*
(#include <err.h>)Tj
T*
(typedef unsigned long long uvlong_t;)Tj
T*
(static int)Tj
T*
(list\(char *fname\))Tj
T*
({)Tj
2.4 -1.5 TD
(struct stat st;)Tj
0 -3 TD
(if \(stat\(fname, &st\) < 0\))Tj
2.4 -1.5 TD
(return -1;)Tj
-2.4 -1.5 TD
(printf\("%s:\\n\\t", fname\);)Tj
T*
(if \(\(st.st_mode & S_IFMT\) == S_IFDIR\))Tj
2.4 -1.5 TD
(printf\("dir"\);)Tj
-2.4 -1.5 TD
(else if \(\(st.st_mode & S_IFMT\) == S_IFREG\))Tj
2.4 -1.5 TD
(printf\("file"\);)Tj
-2.4 -1.5 TD
(else)Tj
2.4 -1.5 TD
(printf\("type %xu", st.st_mode&S_IFMT\);)Tj
-2.4 -1.5 TD
(printf\(" perms %o", st.st_mode & 0777\);)Tj
T*
(printf\(" sz %llu", \(uvlong_t\) st.st_size\);)Tj
T*
(printf\(" uid %d gid %d", st.st_uid, st.st_gid\);)Tj
T*
(printf\("\\n\\tlinks %d", \(int\)st.st_nlink\);)Tj
T*
(printf\(" dev %d ino %llu\\n\\t", \(int\)st.st_dev, \(uvlong_t\) st.st_ino\);)Tj
T*
(printf\("mtime %llus = %s", \(uvlong_t\)st.st_mtime, ctime\(&st.st_mtime\)\);)Tj
T*
(return 0;)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 134.4 Tm
0.0545 Tw
(El propósito de)Tj
/TT11 1 Tf
6.5239 0 TD
0 Tw
(list)Tj
/TT6 1 Tf
2.7049 0 TD
0.0545 Tw
[(es listar los atrib)20(utos de )]TJ
/TT7 1 Tf
9.9454 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0545 Tw
(chero cuyo path se indica en)Tj
/TT11 1 Tf
11.9335 0 TD
0 Tw
(fname)Tj
/TT6 1 Tf
3.0005 0 TD
0.0546 Tw
[(.)-304.6(L)0(a)-304.6(llamada a)]TJ
/TT11 1 Tf
6.132 0 TD
0 Tw
(stat)Tj
/TT6 1 Tf
-40.7963 -1.2 TD
0.0366 Tw
(rellena una estructura)Tj
/TT11 1 Tf
8.9662 0 TD
0 Tw
(st)Tj
/TT6 1 Tf
1.4868 0 TD
0.0365 Tw
[(con dichos atrib)20(utos. Igual que sucedía con la lectura de directorios, el contenido)]TJ
-10.453 -1.2 TD
0.0591 Tw
[(de esta estructura v)25(aría de unos sistemas UNIX a otros. Así que hay que tener cuidado para que el código)]TJ
T*
0.0489 Tw
(sea portable. Los campos que utilizamos en nuestro programa suelen estar disponibles en todos los UNIX.)Tj
T*
0 Tw
(En el caso de Linux, la estructura está de)Tj
/TT7 1 Tf
16.3545 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(nida así:)Tj
-16.9106 -6.24 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
96 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
98 0 obj
<<
/Length 7302
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-29-)Tj
/TT11 1 Tf
8 0 0 8 160.8 708 Tm
(struct stat {)Tj
2.4 -1.5 TD
[(dev_t )-2400(st_dev; )-2400(/*)-600(ID of device containing file */)]TJ
T*
2.4 Tw
[(ino_t st_ino; /*)-600(inode )2400(number )2400(*/)]TJ
T*
1.8 Tw
[(mode_t st_mode; /*)-600(protection )1800(*/)]TJ
T*
0 Tw
[(nlink_t )-1200(st_nlink; )-1200(/*)-600(number of hard links */)]TJ
T*
[(uid_t )-2400(st_uid; )-2400(/*)-600(user ID of owner */)]TJ
T*
[(gid_t )-2400(st_gid; )-2400(/*)-600(group ID of owner */)]TJ
T*
[(dev_t )-2400(st_rdev;)-2400(/* device ID \(if special file\) */)]TJ
T*
[(off_t )-2400(st_size;)-2400(/* total size, in bytes */)]TJ
T*
(blksize_t st_blksize; /* blocksize for filesystem I/O */)Tj
T*
[(blkcnt_t )-600(st_blocks; )-600(/*)-600(number of 512B blocks allocated */)]TJ
T*
[(time_t )-1800(st_atime;)-1800(/* time of last access */)]TJ
T*
[(time_t )-1800(st_mtime;)-1800(/* time of last modification */)]TJ
T*
[(time_t )-1800(st_ctime;)-1800(/* time of last status change */)]TJ
-2.4 -1.5 TD
(};)Tj
/TT6 1 Tf
10 0 0 10 72 510 Tm
0.1113 Tw
(El campo)Tj
/TT11 1 Tf
4.2768 0 TD
0 Tw
(st_mode)Tj
/TT6 1 Tf
4.562 0 TD
0.1114 Tw
(contiene tanto los permisos como otros bits que indican el tipo de )Tj
/TT7 1 Tf
27.7763 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5561 0 TD
0.1114 Tw
(chero. La con-)Tj
-37.1712 -1.2 TD
0 Tw
(stante)Tj
/TT11 1 Tf
2.7995 0 TD
(S_IFMT)Tj
/TT6 1 Tf
4.0676 0 TD
0.217 Tw
(indica qué bits contienen el tipo de )Tj
/TT7 1 Tf
15.7094 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.217 Tw
[(chero.)-717(Además, tenemos constantes)]TJ
/TT11 1 Tf
15.6136 0 TD
0 Tw
(S_IFDIR)Tj
/TT6 1 Tf
4.2007 0 TD
(,)Tj
/TT11 1 Tf
-42.947 -1.2 TD
(S_IFREG)Tj
/TT6 1 Tf
4.2007 0 TD
0.1855 Tw
[(,)-435.5(etc. para comprobar qué tipo de )]TJ
/TT7 1 Tf
14.7096 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1855 Tw
[(chero tenemos. Observ)25(a)-435.5(que utilizamos ")]TJ
/TT11 1 Tf
17.306 0 TD
0 Tw
(&)Tj
/TT6 1 Tf
0.6001 0 TD
0.1856 Tw
[(")-435.6(dado que el)]TJ
-37.3726 -1.2 TD
0 Tw
(campo)Tj
/TT11 1 Tf
2.9155 0 TD
(st_mode)Tj
/TT6 1 Tf
4.4507 0 TD
(tiene más bits y no es posible utilizar sólo ")Tj
/TT11 1 Tf
17.3779 0 TD
(==)Tj
/TT6 1 Tf
1.2002 0 TD
(".)Tj
-25.9443 -2.4 TD
0.2808 Tw
(Otros campos como)Tj
/TT11 1 Tf
9.0909 0 TD
0 Tw
(st_size)Tj
/TT6 1 Tf
4.2007 0 TD
(,)Tj
/TT11 1 Tf
0.7808 0 TD
(st_uid)Tj
/TT6 1 Tf
4.1314 0 TD
(y)Tj
/TT11 1 Tf
1.0308 0 TD
(st_gid)Tj
/TT6 1 Tf
4.1314 0 TD
0.2808 Tw
[(debieran ser ob)15(vios a estas alturas. El campo)]TJ
/TT11 1 Tf
-23.366 -1.2 TD
0 Tw
(st_nlink)Tj
/TT6 1 Tf
5.0508 0 TD
(indica cuántas referencias \(nombres\) tiene el )Tj
/TT7 1 Tf
18.1021 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero.)Tj
-23.709 -2.4 TD
0.0281 Tw
[(P)15(ara v)15(er si dos )]TJ
/TT7 1 Tf
6.1926 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0282 Tw
(cheros son el mismo habría que comprobar si tanto)Tj
/TT11 1 Tf
20.8876 0 TD
0 Tw
(st_dev)Tj
/TT6 1 Tf
3.8788 0 TD
(como)Tj
/TT11 1 Tf
2.4999 0 TD
(st_ino)Tj
/TT6 1 Tf
3.8788 0 TD
0.0282 Tw
(coinciden. El)Tj
-37.8938 -1.2 TD
0.037 Tw
[(primero indica en qué dispositi)25(v)20(o)20( )-20(se)-287(encuentra el )]TJ
/TT7 1 Tf
20.0782 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.037 Tw
[(chero y el se)15(gundo indica qué número de )]TJ
/TT7 1 Tf
16.9421 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.037 Tw
(chero dentro)Tj
-38.1326 -1.2 TD
0 Tw
[(de dicho dispositi)25(v)20(o)20( )-20(\(qué número de)]TJ
/TT4 1 Tf
14.7856 0 TD
(i-nodo)Tj
/TT6 1 Tf
2.6108 0 TD
[(\))-250(tenemos.)]TJ
-17.3964 -2.4 TD
0.1558 Tw
(Los campos)Tj
/TT11 1 Tf
5.3663 0 TD
0 Tw
(st_mtime)Tj
/TT6 1 Tf
4.8008 0 TD
(,)Tj
/TT11 1 Tf
0.6558 0 TD
(st_atime)Tj
/TT6 1 Tf
5.2066 0 TD
(y)Tj
/TT11 1 Tf
0.9058 0 TD
(st_ctime)Tj
/TT6 1 Tf
5.2066 0 TD
0.1559 Tw
(contienen las fechas de la última modi)Tj
/TT7 1 Tf
16.2635 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1559 Tw
(cación del)Tj
/TT7 1 Tf
-38.9615 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0995 Tw
[(chero, del último acceso a los datos del mismo y de la última v)15(ez que se cambiaron los atrib)20(utos \(o de)]TJ
-0.5562 -1.2 TD
0.0141 Tw
(cuándo se creó el )Tj
/TT7 1 Tf
7.2195 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0141 Tw
(chero si no se han cambiado\). Estas fechas están codi)Tj
/TT7 1 Tf
21.4526 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0141 Tw
[(cadas como un número de se)15(gun-)]TJ
-29.7844 -1.2 TD
0.1039 Tw
(dos desde una fecha data, pero podemos utilizar)Tj
/TT4 1 Tf
20.2408 0 TD
0 Tw
(ctime\(3\))Tj
/TT6 1 Tf
3.6853 0 TD
0.1038 Tw
[(para con)40(v)15(ertir dicho número a un string con la)]TJ
-23.9261 -1.2 TD
0.1304 Tw
[(fecha en un formato que un humano pueda leer)55(.)-380.4(E)0(n)-380.4(bre)25(v)15(e)15( )-15(v)15(eremos la gestión del tiempo en UNIX más)]TJ
T*
0 Tw
(despacio.)Tj
0 -2.4 TD
0.0172 Tw
[(Lamentablemente, ho)10(y)-267.2(e)0(n)-267.2(día, UNIX utiliza tipos como)]TJ
/TT11 1 Tf
22.6213 0 TD
0 Tw
(ino_t)Tj
/TT6 1 Tf
3.0005 0 TD
(,)Tj
/TT11 1 Tf
0.5172 0 TD
(dev_t)Tj
/TT6 1 Tf
3.0005 0 TD
(,)Tj
/TT11 1 Tf
0.5172 0 TD
(size_t)Tj
/TT6 1 Tf
3.8678 0 TD
-0.0002 Tc
0.0174 Tw
[(y)-267.4(otros muchos en lugar)]TJ
-33.5244 -1.2 TD
0 Tc
0 Tw
(de)Tj
/TT11 1 Tf
1.2626 0 TD
(int)Tj
/TT6 1 Tf
1.8003 0 TD
(,)Tj
/TT11 1 Tf
0.5688 0 TD
(long)Tj
/TT6 1 Tf
2.4004 0 TD
0.0689 Tw
[(,)-318.8(etc. Eso quiere decir que tendremos problemas para utilizar los formatos de)]TJ
/TT11 1 Tf
31.8014 0 TD
0 Tw
(printf)Tj
/TT6 1 Tf
3.9195 0 TD
(con)Tj
-41.753 -1.2 TD
0.0832 Tw
[(cada uno de ellos. Una solución portable para imprimir dichos v)25(alores es la que puedes v)15(er en el código:)]TJ
T*
0.1122 Tw
[(con)40(v)15(ertimos el entero en cuestión a otro entero de mayor o igual tamaño, en nuestro caso a)]TJ
/TT11 1 Tf
38.3954 0 TD
0 Tw
(unsigned)Tj
-38.3954 -1.2 TD
(long long)Tj
/TT6 1 Tf
5.4009 0 TD
[(,)-250(y)-250(utilizamos el formato para dicho entero \(en nuestro caso ")]TJ
/TT11 1 Tf
24.3999 0 TD
(%llu)Tj
/TT6 1 Tf
2.4004 0 TD
("\).)Tj
-32.2012 -2.4 TD
0.1065 Tw
(Habría sido mejor utilizar otro tamaño de entero y usar simplemente ")Tj
/TT11 1 Tf
29.1544 0 TD
0 Tw
(int)Tj
/TT6 1 Tf
1.8003 0 TD
0.3565 Tc
("y")Tj
/TT11 1 Tf
2.0294 0 TD
0 Tc
(%d)Tj
/TT6 1 Tf
1.2002 0 TD
0.1065 Tw
[(")-356.5(dado que ho)10(y)-356.5(día la)]TJ
-34.1843 -1.2 TD
0 Tw
(memoria es barata. Pero esto es tan sólo una opinión.)Tj
0 -2.4 TD
0.1012 Tw
[(P)15(ara que puedas v)15(er el programa en su conjunto y repasar cómo se leían directorios, comprobaban ar)18(gu-)]TJ
0 -1.2 TD
0.1434 Tw
(mentos y otros detalles, mostramos a continuación el resto del )Tj
/TT7 1 Tf
26.5116 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5561 0 TD
0.1434 Tw
(chero fuente que contiene nuestro pro-)Tj
-27.0678 -1.2 TD
0.0409 Tw
[(grama. Observ)25(a)-290.9(cómo las funciones se toman molestias en de)25(v)20(olv)15(er una indicación de error si tienen prob-)]TJ
T*
0.0069 Tw
[(lemas y cómo se comprueban los errores e imprimen mensajes de error)55(.)-256.9(E)0(n)-256.9(aquellos casos en que es posible)]TJ
T*
0.037 Tw
[(continuar el trabajo tras informar de un error)40(,)-287(e)0(l)-287.1(código hace justo eso. Además, se cierran los )]TJ
/TT7 1 Tf
38.2984 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0371 Tw
(cheros que)Tj
-38.8545 -1.2 TD
-0.0001 Tc
0.0001 Tw
[(se abren, tengamos errores o no. Pero antes de v)14.9(erlo, esta es una ejecución del programa:)]TJ
0 -9 TD
0 Tc
0 Tw
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
99 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
101 0 obj
<<
/Length 1859
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-30-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(unix$ ll)Tj
0 -1.5 TD
(./ll:)Tj
2.4 -1.5 TD
(file perms 755 sz 9092 uid 501 gid 20)Tj
T*
(links 1 dev 16777220 ino 7791046)Tj
T*
(mtime 1471771999s = Sun Aug 21 11:33:19 2016)Tj
-2.4 -1.5 TD
(./guide:)Tj
2.4 -1.5 TD
(file perms 644 sz 1396 uid 501 gid 20)Tj
T*
(links 1 dev 16777220 ino 7766071)Tj
T*
(mtime 1471700478s = Sat Aug 20 15:41:18 2016)Tj
-2.4 -1.5 TD
(./ll.c:)Tj
2.4 -1.5 TD
(file perms 644 sz 1731 uid 501 gid 20)Tj
T*
(links 1 dev 16777220 ino 7788145)Tj
T*
(mtime 1471771995s = Sun Aug 21 11:33:15 2016)Tj
-2.4 -1.5 TD
(./writef.c:)Tj
2.4 -1.5 TD
(file perms 644 sz 512 uid 501 gid 20)Tj
T*
(links 1 dev 16777220 ino 7782848)Tj
T*
(mtime 1471700968s = Sat Aug 20 15:49:28 2016)Tj
/TT6 1 Tf
10 0 0 10 72 498 Tm
[(Y)-250(este es el código que f)10(alta:)]TJ
/TT11 1 Tf
8 0 0 8 133 468 Tm
(static int)Tj
T*
(ldir\(char *dir\))Tj
T*
({)Tj
2.4 -1.5 TD
(DIR *d;)Tj
T*
(struct dirent *de;)Tj
T*
(char path[1024];)Tj
T*
(int n, rc;)Tj
0 -3 TD
[(d)-600(=)-600(opendir\(dir\);)]TJ
0 -1.5 TD
(if\(d == NULL\) {)Tj
2.4 -1.5 TD
(warn\("opendir: %s", dir\);)Tj
T*
(return -1;)Tj
-2.4 -1.5 TD
(})Tj
T*
(rc = 0;)Tj
T*
(while\(\(de = readdir\(d\)\) != NULL\) {)Tj
2.4 -1.5 TD
[(n)-600(=)-600(snprintf\(path, sizeof path, "%s/%s", dir, de->d_name\);)]TJ
T*
(if \(n >= sizeof path-1\) { // -1 for ’\\0’)Tj
2.4 -1.5 TD
(warn\("path %s/%s too long", dir, de->d_name\);)Tj
T*
(rc = -1;)Tj
-2.4 -1.5 TD
[(})-600(else if \(list\(path\) < 0\) {)]TJ
2.4 -1.5 TD
(warn\("list: %s", path\);)Tj
T*
(rc = -1;)Tj
-2.4 -1.5 TD
(})Tj
-2.4 -1.5 TD
(})Tj
T*
(if \(closedir\(d\) < 0\) {)Tj
2.4 -1.5 TD
(warn\("closedir: %s", dir\);)Tj
T*
(return -1;)Tj
-2.4 -1.5 TD
(})Tj
T*
(return rc;)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 24 Tm
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
102 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT6 6 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
104 0 obj
<<
/Length 4587
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-31-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(int)Tj
0 -1.5 TD
(main\(int argc, char* argv[]\))Tj
T*
({)Tj
2.4 -1.5 TD
(int sts, i;)Tj
0 -3 TD
(sts = 0;)Tj
0 -1.5 TD
(if \(argc == 1\) {)Tj
2.4 -1.5 TD
(if \(ldir\("."\) < 0\) {)Tj
2.4 -1.5 TD
(sts = 1;)Tj
-2.4 -1.5 TD
(})Tj
-2.4 -1.5 TD
[(})-600(else {)]TJ
2.4 -1.5 TD
(for \(i = 1; i < argc; i++\) {)Tj
2.4 -1.5 TD
(if \(ldir\(argv[i]\) < 0\) {)Tj
2.4 -1.5 TD
(sts = 1;)Tj
-2.4 -1.5 TD
(})Tj
-2.4 -1.5 TD
(})Tj
-2.4 -1.5 TD
(})Tj
T*
(exit\(sts\);)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 462 Tm
0.0535 Tw
(Por cierto, en ocasiones tendrás un descriptor de )Tj
/TT7 1 Tf
20.0051 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
-0.0001 Tc
0.0535 Tw
(chero del que desees obtener los metadatos, en lugar de)Tj
-20.5613 -1.2 TD
0 Tc
0.1631 Tw
(tener el path para dicho )Tj
/TT7 1 Tf
10.4498 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1631 Tw
(chero. En ese caso puedes utilizar)Tj
/TT4 1 Tf
14.7228 0 TD
0 Tw
(fstat\(2\))Tj
/TT6 1 Tf
3.3019 0 TD
-0.0005 Tc
0.1637 Tw
(en lugar de)Tj
/TT4 1 Tf
5.177 0 TD
0 Tc
0 Tw
(stat\(2\))Tj
/TT6 1 Tf
2.6108 0 TD
0.1632 Tw
[(,)-413.2(que recibe un)]TJ
-36.8185 -1.2 TD
0.0225 Tw
(descriptor de )Tj
/TT7 1 Tf
5.4874 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
-0.0001 Tc
0.0226 Tw
[(chero en lugar de un path. En muchas otras llamadas se sigue el mismo con)39.9(v)14.9(enio y dispones)]TJ
-6.0435 -1.2 TD
0 Tc
0.1695 Tw
(de funciones que comienzan por ")Tj
/TT11 1 Tf
14.4452 0 TD
0 Tw
(f)Tj
/TT6 1 Tf
0.6001 0 TD
-0.0001 Tc
0.1696 Tw
[(")-419.6(para utilizar un descriptor en lugar de un path para identi)]TJ
/TT7 1 Tf
25.2316 0 TD
0 Tc
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1696 Tw
(car el)Tj
/TT7 1 Tf
-40.833 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
[(chero con que quieres trabajar)55(.)-250(¡El manual es tu amigo!)]TJ
/TT2 1 Tf
-0.5562 -3.6 TD
0.25 Tw
[(12. El)-250(tiempo)]TJ
/TT6 1 Tf
0 -1.56 TD
0.0862 Tw
[(UNIX mantiene su propia idea de la fecha y hora. Por un lado, el hardw)10(are habitualmente dispone de un)]TJ
0 -1.2 TD
0 Tw
(reloj que está continuamente alimentado por baterías y que se ocupa de mantener la noción del tiempo.)Tj
0 -2.4 TD
0.0158 Tw
(Naturalmente, este reloj es un contador que se incrementa cada unidad de tiempo. Normalmente dispone de)Tj
0 -1.2 TD
0 Tw
[(una serie de ticks por se)15(gundo y es programable respecto a la frecuencia a la que opera.)]TJ
0 -2.4 TD
0.1643 Tw
[(El sistema además suele programar el temporizador hardw)10(are para que cada)]TJ
/TT11 1 Tf
32.4225 0 TD
0 Tw
(HZ)Tj
/TT6 1 Tf
1.6145 0 TD
0.1643 Tw
(\(una constante entera\))Tj
-34.037 -1.2 TD
0.0653 Tw
[(v)15(eces por se)15(gundo genere una interrupción de reloj. Esto se usa, como ya mencionamos, entre otras cosas)]TJ
T*
0.0077 Tw
[(para e)15(xpulsar del procesador aquellos procesos que lle)25(v)25(a)0(n)-257.7(s)0(u)]TJ
/TT7 1 Tf
24.3214 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0077 Tw
(ciente tiempo ejecutando \(que han agotado su)Tj
-24.8776 -1.2 TD
0 Tw
(cuanto\). Es tan simple como retornar de la interrupción en un proceso distinto.)Tj
0 -2.4 TD
0.0637 Tw
(Desde el shell, ya sabes que el comando)Tj
/TT4 1 Tf
16.8099 0 TD
0 Tw
(date\(1\))Tj
/TT6 1 Tf
3.2014 0 TD
0.0638 Tw
(informa respecto a la fecha y hora. Desde C, el principal)Tj
-20.0113 -1.2 TD
0 Tw
[(interf)10(az para obtener el tiempo es)]TJ
/TT4 1 Tf
13.5945 0 TD
[(g)10(ettimeofday\(2\))]TJ
/TT6 1 Tf
6.5711 0 TD
(\(y puede utilizarse)Tj
/TT4 1 Tf
7.6357 0 TD
(settimeofday\(2\))Tj
/TT6 1 Tf
6.4702 0 TD
(para ajustarlo\).)Tj
-34.2715 -2.4 TD
0.0228 Tw
(Esta función rellena una estructura de tipo)Tj
/TT4 1 Tf
17.2919 0 TD
0 Tw
[(time)15(val)]TJ
/TT6 1 Tf
3.2012 0 TD
0.0228 Tw
[(con los se)15(gundos y microse)15(gundos desde una fecha con-)]TJ
-20.4931 -1.2 TD
0 Tw
[(v)15(enida, llamada)]TJ
/TT4 1 Tf
6.5656 0 TD
[(epoc)15(h)]TJ
/TT6 1 Tf
2.3727 0 TD
[(.)-250(Normalmente desde el 1 de enero de 1970 en el caso de UNIX.)]TJ
/TT11 1 Tf
8 0 0 8 132 164.4 Tm
(struct timeval {)Tj
4.8 -1.5 TD
[(time_t )-3600(tv_sec;)-1800(/* seconds since Jan. 1, 1970 */)]TJ
T*
0.6 Tw
[(suseconds_t tv_usec; /*)-600(and )600(microseconds )600(*/)]TJ
-4.8 -1.5 TD
0 Tw
(};)Tj
/TT6 1 Tf
10 0 0 10 72 110.4 Tm
0.0843 Tw
(Además, rellena otra estructura llamada)Tj
/TT4 1 Tf
16.5807 0 TD
0 Tw
(timezone)Tj
/TT6 1 Tf
3.889 0 TD
0.0843 Tw
(que indica la zona horaria en que nos encontramos y si)Tj
-20.4697 -1.2 TD
0 Tw
[(estamos en horario de v)15(erano \()]TJ
/TT4 1 Tf
12.2858 0 TD
(daylight saving time)Tj
/TT6 1 Tf
8.1099 0 TD
(\).)Tj
-20.3956 -7.44 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
105 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
108 0 obj
<<
/Length 1947
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-32-)Tj
/TT11 1 Tf
8 0 0 8 132 708 Tm
(struct timezone {)Tj
4.8 -1.5 TD
[(int )-2400(tz_minuteswest;)-600(/* of Greenwich */)]TJ
T*
[(int )-2400(tz_dsttime; )-2400(/*)-600(type of dst correction to apply */)]TJ
-4.8 -1.5 TD
(};)Tj
/TT6 1 Tf
10 0 0 10 72 654 Tm
(Pero)Tj
/TT4 1 Tf
2.165 0 TD
0.082 Tw
(no deberías)Tj
/TT6 1 Tf
5.1078 0 TD
(dejar que)Tj
/TT11 1 Tf
4.1063 0 TD
0 Tw
(gettimeofday)Tj
/TT6 1 Tf
7.5331 0 TD
0.0819 Tw
(rellene información sobre la zona horaria. Es mejor utilizar)Tj
-18.9122 -1.2 TD
0.1211 Tw
(funciones de)Tj
/TT4 1 Tf
5.5737 0 TD
0 Tw
(ctime\(3\))Tj
/TT6 1 Tf
3.7026 0 TD
-0.0001 Tc
0.1212 Tw
[(si deseas jugar con zonas horarias. Por ello nosotros v)24.9(amos a utilizar)]TJ
/TT11 1 Tf
29.1117 0 TD
0 Tc
0 Tw
(NULL)Tj
/TT6 1 Tf
2.7716 0 TD
0.1212 Tw
(en el)Tj
-41.1597 -1.2 TD
0 Tw
[(ar)18(gumento correspondiente a la zona horaria para que)]TJ
/TT11 1 Tf
21.6939 0 TD
(gettimeofday)Tj
/TT6 1 Tf
7.4512 0 TD
(lo ignore.)Tj
-29.1451 -2.4 TD
0.013 Tw
(Este programa es similar a)Tj
/TT4 1 Tf
10.9224 0 TD
0 Tw
(date\(1\))Tj
/TT6 1 Tf
2.8877 0 TD
0.013 Tw
[(,)-263(pero con la opción ")]TJ
/TT11 1 Tf
8.6373 0 TD
0 Tw
(-n)Tj
/TT6 1 Tf
1.2002 0 TD
0.013 Tw
[(")-263(imprime el número de se)15(gundos y microse)15(gun-)]TJ
-23.6476 -1.2 TD
-0.0001 Tc
0.0001 Tw
(dos y los datos de la zona horaria en lugar de escribir la fecha normalmente.)Tj
/TT11 1 Tf
8 0 0 8 133 576 Tm
0 Tc
0 Tw
(#include <stdio.h>)Tj
0 -1.5 TD
(#include <stdlib.h>)Tj
T*
(#include <string.h>)Tj
T*
(#include <err.h>)Tj
T*
(#include <time.h>)Tj
T*
(#include <sys/time.h>)Tj
0 -3 TD
(typedef unsigned long long uvlong_t;)Tj
0 -1.5 TD
(static char *argv0;)Tj
0 -3 TD
(static void)Tj
0 -1.5 TD
(usage\(void\))Tj
T*
({)Tj
2.4 -1.5 TD
(fprintf\(stderr, "usage: %s [-n]\\n", argv0\);)Tj
T*
(exit\(1\);)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 24 Tm
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
109 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT4 5 0 R
/TT6 6 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
111 0 obj
<<
/Length 2675
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-33-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(int)Tj
0 -1.5 TD
(main\(int argc, char* argv[]\))Tj
T*
({)Tj
2.4 -1.5 TD
(struct timeval tv;)Tj
T*
(int nflag;)Tj
0 -3 TD
(nflag = 0;)Tj
0 -1.5 TD
(argv0 = argv[0];)Tj
T*
(if \(argc == 2\) {)Tj
2.4 -1.5 TD
(if \(strcmp\(argv[1], "-n"\) == 0\) {)Tj
2.4 -1.5 TD
(nflag = 1;)Tj
-2.4 -1.5 TD
[(})-600(else {)]TJ
2.4 -1.5 TD
(usage\(\);)Tj
-2.4 -1.5 TD
(})Tj
-2.4 -1.5 TD
(})Tj
T*
(if \(argc > 2\) {)Tj
2.4 -1.5 TD
(usage\(\);)Tj
-2.4 -1.5 TD
(})Tj
0 -3 TD
(if \(gettimeofday\(&tv, NULL\) < 0\) {)Tj
2.4 -1.5 TD
(err\(1, "gettimeofday"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(if \(nflag\) {)Tj
2.4 -1.5 TD
(printf\("%llds %lldµs\\n", \(uvlong_t\)tv.tv_sec, \(uvlong_t\)tv.tv_usec\);)Tj
-2.4 -1.5 TD
[(})-600(else {)]TJ
2.4 -1.5 TD
(printf\("%s", ctime\(&tv.tv_sec\)\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(exit\(0\);)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 342 Tm
0.062 Tw
(La función)Tj
/TT4 1 Tf
4.7334 0 TD
0 Tw
(ctime\(3\))Tj
/TT6 1 Tf
3.6435 0 TD
0.062 Tw
[(se ocupa de generar un string para la fecha dada como un número de se)15(gundos desde)]TJ
/TT4 1 Tf
-8.3769 -1.2 TD
0 Tw
[(epoc)15(h)]TJ
/TT6 1 Tf
2.3727 0 TD
[(.)-500(T)80(odas los ar)18(gumentos de funciones de)]TJ
/TT4 1 Tf
16.2038 0 TD
(ctime\(3\))Tj
/TT6 1 Tf
3.5815 0 TD
(que aceptan un)Tj
/TT11 1 Tf
6.2471 0 TD
(time_t)Tj
/TT6 1 Tf
3.8506 0 TD
(suelen ser dicho número de)Tj
-32.2557 -1.2 TD
[(se)15(gundos.)]TJ
0 -2.4 TD
0.005 Tw
[(P)15(ara partir la fecha dada por un)]TJ
/TT11 1 Tf
12.8193 0 TD
0 Tw
(time_t)Tj
/TT6 1 Tf
3.8556 0 TD
0.005 Tw
[(\(número de se)15(gundos desde)]TJ
/TT4 1 Tf
11.3356 0 TD
0 Tw
[(epoc)15(h)]TJ
/TT6 1 Tf
2.3727 0 TD
0.005 Tw
[(\))-255(y)-255(obtener el año, el mes, el día)]TJ
-30.3832 -1.2 TD
0.0898 Tw
(del mes, etc. normalmente se utilizan las funciones)Tj
/TT11 1 Tf
21.3229 0 TD
0 Tw
(localtime)Tj
/TT6 1 Tf
5.7407 0 TD
0.0898 Tw
(\(hora local\) y)Tj
/TT11 1 Tf
5.9056 0 TD
0 Tw
(gmtime)Tj
/TT6 1 Tf
3.9404 0 TD
0.0898 Tw
(\(hora en green-)Tj
-36.9096 -1.2 TD
0 Tw
(wich\). Por ejemplo, como en)Tj
/TT11 1 Tf
8 0 0 8 133 252 Tm
(struct tm *t;)Tj
5.4 -1.5 TD
(struct timeval tv;)Tj
-5.4 -1.5 TD
(if \(gettimeofday\(&tv, NULL\) < 0\) {)Tj
2.4 -1.5 TD
(err\(1, "gettimeofday"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
[(t)-600(=)-600(localtime\(&tv.tv_sec\);)]TJ
/TT6 1 Tf
10 0 0 10 72 174 Tm
[(o)-250(bien)]TJ
/TT11 1 Tf
8 0 0 8 133 156 Tm
[(t)-600(=)-600(gmtime\(&tv.tv_sec\);)]TJ
/TT6 1 Tf
10 0 0 10 72 138 Tm
[(Y)-250(lue)15(go podemos usar los siguientes campos de la estructura)]TJ
/TT11 1 Tf
24.5348 0 TD
(tm)Tj
/TT6 1 Tf
1.2002 0 TD
(:)Tj
-25.735 -11.4 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
112 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT4 5 0 R
/TT6 6 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
114 0 obj
<<
/Length 5299
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-34-)Tj
/TT11 1 Tf
8 0 0 8 160.8 708 Tm
[(int tm_sec;)-3000(/* seconds \(0 - 60\) */)]TJ
0 -1.5 TD
[(int tm_min;)-3000(/* minutes \(0 - 59\) */)]TJ
T*
[(int tm_hour;)-2400(/* hours \(0 - 23\) */)]TJ
T*
[(int tm_mday;)-2400(/* day of month \(1 - 31\) */)]TJ
T*
[(int tm_mon;)-3000(/* month of year \(0 - 11\) */)]TJ
T*
[(int tm_year;)-2400(/* year - 1900 */)]TJ
T*
[(int tm_wday;)-2400(/* day of week \(Sunday = 0\) */)]TJ
T*
[(int tm_yday;)-2400(/* day of year \(0 - 365\) */)]TJ
T*
[(int tm_isdst;)-1800(/* is summer time in effect? */)]TJ
/TT6 1 Tf
10 0 0 10 72 594 Tm
0.0512 Tw
[(Podríamos tener otros campos dependiendo del UNIX que usemos, pero se)15(guramente no estén disponibles)]TJ
0 -1.2 TD
0 Tw
(en todos los sistemas.)Tj
0 -2.4 TD
0.148 Tw
(La función)Tj
/TT11 1 Tf
4.9054 0 TD
0 Tw
(mktime)Tj
/TT6 1 Tf
3.6006 0 TD
0.148 Tw
[(,)-398(también documentada en)]TJ
/TT4 1 Tf
11.3381 0 TD
0 Tw
(ctime\(3\))Tj
/TT6 1 Tf
3.7295 0 TD
0.148 Tw
[(hace el proceso in)40(v)15(erso y genera un tiempo en)]TJ
-23.5736 -1.2 TD
0 Tw
[(se)15(gundos desde)]TJ
/TT4 1 Tf
6.484 0 TD
[(epoc)15(h)]TJ
/TT6 1 Tf
2.6227 0 TD
[(a)-250(partir de una estructura de tipo)]TJ
/TT11 1 Tf
13.189 0 TD
(tm)Tj
/TT6 1 Tf
1.2002 0 TD
(.)Tj
/TT2 1 Tf
-23.4959 -3.6 TD
0.25 Tw
[(13. Cambiando)-250(los )250(metadatos)]TJ
/TT6 1 Tf
0 -1.56 TD
0.0408 Tw
[(Los metadatos cambian muchas v)15(eces simplemente con operar sobre el )]TJ
/TT7 1 Tf
29.1055 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0409 Tw
(chero para cambiar los datos. Por)Tj
-29.6617 -1.2 TD
0.1643 Tw
(ejemplo, el tamaño del )Tj
/TT7 1 Tf
10.0151 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1643 Tw
(chero cambia si lo haces crecer utilizando)Tj
/TT11 1 Tf
18.1139 0 TD
0 Tw
(write)Tj
/TT6 1 Tf
3.0005 0 TD
0.1642 Tw
[(,)-414.2(a)0(l)-414.2(igual que las fechas de)]TJ
-31.6856 -1.2 TD
0 Tw
(acceso y modi)Tj
/TT7 1 Tf
5.7202 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(cación.)Tj
-6.2764 -2.4 TD
0.0115 Tw
[(Aunque ya podemos v)25(aciar un )]TJ
/TT7 1 Tf
12.4456 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0115 Tw
(chero utilizando)Tj
/TT11 1 Tf
6.7427 0 TD
0 Tw
(open)Tj
/TT6 1 Tf
2.6619 0 TD
0.0115 Tw
[(y)-261.5(hacerlo crecer utilizando)]TJ
/TT11 1 Tf
10.9288 0 TD
0 Tw
(seek)Tj
/TT6 1 Tf
2.6619 0 TD
(y)Tj
/TT11 1 Tf
0.7615 0 TD
(write)Tj
/TT6 1 Tf
3.0005 0 TD
[(,)-261.5(e)0(n)-261.5(oca-)]TJ
-39.759 -1.2 TD
0.0679 Tw
(siones querremos truncar un )Tj
/TT7 1 Tf
11.8238 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0679 Tw
(chero o cambiar su tamaño a un número dado de bytes. Esto puede hacerse)Tj
-12.38 -1.2 TD
0 Tw
(con)Tj
/TT4 1 Tf
1.6959 0 TD
(truncate\(2\))Tj
/TT6 1 Tf
4.4985 0 TD
0.0022 Tw
[(,)-252.1(que ajusta el tamaño al número indicado. Si el )]TJ
/TT7 1 Tf
19.2387 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0022 Tw
(chero era más grande, se tiran los bytes del)Tj
/TT7 1 Tf
-25.9893 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0195 Tw
(nal que sobran. Si el )Tj
/TT7 1 Tf
8.4847 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0195 Tw
(chero era más pequeño, se hace crecer con ceros. La llamada puede utilizarse como)Tj
-9.597 -1.2 TD
0 Tw
(en)Tj
/TT11 1 Tf
8 0 0 8 133 380.4 Tm
(if \(truncate\("myfile", 1024\) < 0\) {)Tj
2.4 -1.5 TD
(// truncate ha fallado...)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 338.4 Tm
0.0642 Tw
(que dejaría)Tj
/TT11 1 Tf
4.7925 0 TD
0 Tw
(myfile)Tj
/TT6 1 Tf
3.9149 0 TD
0.0643 Tw
[(con 1024 bytes e)15(xactamente. Como podrás suponer)40(,)-314.3(e)15(xiste)]TJ
/TT4 1 Tf
24.105 0 TD
0 Tw
(ftruncate\(2\))Tj
/TT6 1 Tf
5.0907 0 TD
0.0643 Tw
(que trunca el)Tj
/TT7 1 Tf
-37.9031 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero indicado por un descriptor de )Tj
/TT7 1 Tf
14.4395 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
-0.0002 Tc
0.0002 Tw
(chero en lugar de por un path.)Tj
-15.5518 -2.4 TD
0 Tc
0.0502 Tw
(En realidad,)Tj
/TT11 1 Tf
5.1815 0 TD
0 Tw
(truncate)Tj
/TT6 1 Tf
5.101 0 TD
0.0501 Tw
(cambia el tamaño en los metadatos y si ello require liberar bloques en disco para)Tj
-10.2824 -1.2 TD
0 Tw
(los datos que ya no se usan, así lo hace.)Tj
0 -2.4 TD
0.0722 Tw
(Los permisos pueden cambiarse con la llamada)Tj
/TT4 1 Tf
19.6377 0 TD
0 Tw
[(c)15(hmod\(2\))]TJ
/TT6 1 Tf
3.817 0 TD
0.0723 Tw
[(,)-322.2(que es la que utiliza el comando)]TJ
/TT4 1 Tf
14.1569 0 TD
0 Tw
[(c)15(hmod\(1\))]TJ
/TT6 1 Tf
4.1393 0 TD
(que)Tj
-41.751 -1.2 TD
0.151 Tw
[(hemos usado anteriormente. Aunque esta v)15(ez sí diremos que también tienes)]TJ
/TT4 1 Tf
32.1372 0 TD
0 Tw
[(fc)15(hmod\(2\))]TJ
/TT6 1 Tf
4.0949 0 TD
0.151 Tw
[(,)-401(e)0(n)-401(e)0(l)-401(futuro no)]TJ
-36.2321 -1.2 TD
0.0807 Tw
(mencionaremos más las funciones que operan con descriptores, ya estás acostumbrado a leer el manual y)Tj
T*
0 Tw
(sabes cómo encontrarlas y usarlas.)Tj
0 -2.4 TD
0.1013 Tw
(Este programa ajusta los permisos de los )Tj
/TT7 1 Tf
17.2335 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1013 Tw
[(cheros que se pasan como ar)18(gumento al v)25(alor indicado por el)]TJ
-17.7897 -1.2 TD
0 Tw
[(primer ar)18(gumento, similar a)]TJ
/TT4 1 Tf
11.3951 0 TD
[(c)15(hmod\(1\))]TJ
/TT6 1 Tf
3.817 0 TD
(.)Tj
/TT11 1 Tf
8 0 0 8 133 176.4 Tm
(#include <stdio.h>)Tj
0 -1.5 TD
(#include <stdlib.h>)Tj
T*
(#include <sys/stat.h>)Tj
T*
(#include <err.h>)Tj
/TT6 1 Tf
10 0 0 10 72 24 Tm
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
115 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
117 0 obj
<<
/Length 2099
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-35-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(int)Tj
0 -1.5 TD
(main\(int argc, char* argv[]\))Tj
T*
({)Tj
2.4 -1.5 TD
(long mode;)Tj
T*
(int i, sts;)Tj
0 -3 TD
(if \(argc < 3\) {)Tj
2.4 -1.5 TD
(fprintf\(stderr, "usage: %s mode file...\\n", argv[0]\);)Tj
T*
(exit\(1\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(mode = strtol\(argv[1], NULL, 8\);)Tj
T*
(sts = 0;)Tj
T*
(for \(i = 2; i < argc; i++\) {)Tj
2.4 -1.5 TD
(if \(chmod\(argv[i], mode\) < 0\) {)Tj
2.4 -1.5 TD
(warn\("chmod: %s", argv[i]\);)Tj
T*
(sts = 1;)Tj
-2.4 -1.5 TD
(})Tj
-2.4 -1.5 TD
(})Tj
T*
(exit\(sts\);)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 450 Tm
[(Podemos utilizarlo como puedes v)15(er:)]TJ
/TT11 1 Tf
8 0 0 8 133 432 Tm
(unix$ chm 664 chm.c)Tj
T*
(unix$ ls -l chm.c)Tj
T*
0.6 Tw
[(-rw-rw-r-- 1)-600(nemo staff 452)-600(Aug )600(21 )600(11:59 )600(chm.c)]TJ
T*
0 Tw
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 366 Tm
0.0203 Tw
(El propietario y el grupo a que pertenece un )Tj
/TT7 1 Tf
17.981 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0203 Tw
(chero se puede cambiar como se describe en)Tj
/TT4 1 Tf
18.1541 0 TD
0 Tw
[(c)15(hown\(2\))]TJ
/TT6 1 Tf
3.7619 0 TD
[(,)-270.3(como)]TJ
-40.4531 -1.2 TD
(en:)Tj
/TT11 1 Tf
8 0 0 8 133 336 Tm
(if \(fchown\(fd, newuid, newgid\) < 0\) {)Tj
2.4 -1.5 TD
(// fchown ha fallado)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 294 Tm
-0.0001 Tc
0.0001 Tw
(¿Y si tienes un path en lugar de un descriptor? ¿Cómo lo harás?)Tj
0 -2.4 TD
0 Tc
0.041 Tw
(Las fechas de acceso y modi)Tj
/TT7 1 Tf
11.6166 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.041 Tw
(cación de un )Tj
/TT7 1 Tf
5.4262 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.041 Tw
(chero pueden cambiarse con)Tj
/TT4 1 Tf
11.7694 0 TD
0 Tw
(utimes\(2\))Tj
/TT6 1 Tf
3.7769 0 TD
0.0409 Tw
[(.)-290.9(Por ejemplo, este pro-)]TJ
-33.7014 -1.2 TD
0 Tw
(gram es similar a)Tj
/TT4 1 Tf
7.1089 0 TD
[(touc)15(h\(1\))]TJ
/TT6 1 Tf
3.3727 0 TD
[(,)-250(aunque nunca crea los )]TJ
/TT7 1 Tf
9.6069 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
[(cheros si no e)15(xisten.)]TJ
-20.6447 -23.4 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
118 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
120 0 obj
<<
/Length 4689
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-36-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(#include <stdio.h>)Tj
0 -1.5 TD
(#include <stdlib.h>)Tj
T*
(#include <sys/time.h>)Tj
T*
(#include <err.h>)Tj
0 -3 TD
(int)Tj
0 -1.5 TD
(main\(int argc, char* argv[]\))Tj
T*
({)Tj
2.4 -1.5 TD
(int i, sts;)Tj
T*
(struct timeval tv[2];)Tj
0 -3 TD
(if \(argc < 2\) {)Tj
2.4 -1.5 TD
(fprintf\(stderr, "usage: %s file...\\n", argv[0]\);)Tj
T*
(exit\(1\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(if \(gettimeofday\(&tv[0], NULL\) < 0\) {)Tj
2.4 -1.5 TD
(err\(1, "gettimeofday"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(tv[1] = tv[0];)Tj
T*
(sts = 0;)Tj
T*
(for \(i = 1; i < argc; i++\) {)Tj
2.4 -1.5 TD
(// could use just NULL instead of tv.)Tj
T*
(if \(utimes\(argv[i], tv\) < 0\) {)Tj
2.4 -1.5 TD
(warn\("utimes: %s", argv[i]\);)Tj
T*
(sts = 1;)Tj
-2.4 -1.5 TD
(})Tj
-2.4 -1.5 TD
(})Tj
T*
(exit\(sts\);)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 342 Tm
0.0691 Tw
(Aquí hemos utilizado)Tj
/TT4 1 Tf
9.0673 0 TD
0 Tw
[(g)10(ettimeofday\(2\))]TJ
/TT6 1 Tf
6.6403 0 TD
0.0692 Tw
(para pedir a UNIX la fecha y hora actual y cambiamos los tiempos)Tj
-15.7075 -1.2 TD
0.0558 Tw
(de los )Tj
/TT7 1 Tf
2.7224 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0558 Tw
[(cheros justo a ese momento. El mismo efecto podría haberse conse)15(guido utilizando ")]TJ
/TT11 1 Tf
34.5814 0 TD
0 Tw
(NULL)Tj
/TT6 1 Tf
2.4004 0 TD
[(")-305.8(como)]TJ
-40.2603 -1.2 TD
[(ar)18(gumento \(que hace que)]TJ
/TT11 1 Tf
10.3106 0 TD
(utimes)Tj
/TT6 1 Tf
3.8506 0 TD
(use la fecha actual\).)Tj
/TT2 1 Tf
-14.1612 -3.6 TD
0.25 Tw
[(14. Enlaces)-250(simbólicos)]TJ
/TT6 1 Tf
0 -1.56 TD
0.06 Tw
(Recientemente hemos visto que podemos enlazar )Tj
/TT7 1 Tf
20.298 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5561 0 TD
0.06 Tw
[(cheros desde v)25(arios nombres. A este tipo de enlaces se)]TJ
-20.8541 -1.2 TD
0.0024 Tw
(los denomina)Tj
/TT2 1 Tf
5.6152 0 TD
(hard links)Tj
/TT6 1 Tf
4.6181 0 TD
0 Tw
(o)Tj
/TT4 1 Tf
0.7524 0 TD
0.0024 Tw
[(enlaces dur)45(os)]TJ
/TT6 1 Tf
5.4843 0 TD
0.0023 Tw
[(.)-252.3(L)0(a)-252.3(v)15(entaja que tienen es que todos los enlaces se comportan bien.)]TJ
-16.4699 -1.2 TD
0 Tw
(Por ejemplo, borrando cualquiera de los nombres para un )Tj
/TT7 1 Tf
23.1597 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
[(chero se)15(guimos teniendo el )]TJ
/TT7 1 Tf
11.1486 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero accesible.)Tj
-35.4205 -2.4 TD
0.0823 Tw
(No obstante, no es posible hacer un enlace a un )Tj
/TT7 1 Tf
20.011 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0823 Tw
(chero que esté en otro sistema de )Tj
/TT7 1 Tf
14.0434 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0823 Tw
[(cheros \(en otra par)20(-)]TJ
-35.1667 -1.2 TD
0.0586 Tw
[(tición, otro disco y otra máquina\). Esto es ob)15(vio si piensas que el enlace simplemente crea una entrada de)]TJ
T*
0.0401 Tw
(directorio que se re)Tj
/TT7 1 Tf
7.8112 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0401 Tw
(ere a un número de)Tj
/TT4 1 Tf
8.1136 0 TD
0 Tw
(i-nodo)Tj
/TT6 1 Tf
2.901 0 TD
0.0402 Tw
(dado, y piensas que el número de)Tj
/TT4 1 Tf
13.8332 0 TD
0 Tw
(i-nodo)Tj
/TT6 1 Tf
2.901 0 TD
0.0402 Tw
(sólo tiene sentido)Tj
-36.1162 -1.2 TD
0 Tw
(dentro de la misma partición o sistema de )Tj
/TT7 1 Tf
16.8843 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(cheros.)Tj
-17.4404 -2.4 TD
0.0716 Tw
[(P)15(ara solucionar este problema, UNIX dispone de)]TJ
/TT2 1 Tf
20.3138 0 TD
(enlaces simbólicos)Tj
/TT6 1 Tf
8.1427 0 TD
(además de enlaces duros. Un enlace)Tj
-28.4566 -1.2 TD
0.0195 Tw
(simbólico es similar a un)Tj
/TT4 1 Tf
10.346 0 TD
[(acceso dir)37(ecto)]TJ
/TT6 1 Tf
6.0552 0 TD
[(en W)40(indo)25(ws. Se trata de un )]TJ
/TT7 1 Tf
11.2996 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0196 Tw
(chero cuyos datos son el path de otro)Tj
/TT7 1 Tf
-28.257 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1101 Tw
[(chero. ¡T)80(an sencillo como eso!. La consecuencia es que un enlace simbólico puede apuntar a cualquier)]TJ
/TT7 1 Tf
-0.5562 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1243 Tw
[(chero dado su path. Y)129(,)-374.4(naturalmente, la desv)15(entaja es que si borramos el )]TJ
/TT7 1 Tf
30.5744 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1244 Tw
(chero original perdemos los)Tj
-31.6867 -1.2 TD
0 Tw
(datos del )Tj
/TT7 1 Tf
3.8325 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero y el enlace queda apuntando a un )Tj
/TT7 1 Tf
15.9927 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
[(chero que no e)15(xiste.)]TJ
-20.9375 -2.4 TD
[(P)15(ara crear un enlace simbólico puedes utilizar el )]TJ
/TT7 1 Tf
19.5875 0 TD
(ß)Tj
/TT6 1 Tf
0.5562 0 TD
(ag)Tj
/TT11 1 Tf
1.1938 0 TD
(-s)Tj
/TT6 1 Tf
1.4502 0 TD
(de)Tj
/TT4 1 Tf
1.1938 0 TD
(ln\(1\))Tj
/TT6 1 Tf
1.9438 0 TD
[(.)-250(Por ejemplo:)]TJ
-25.9254 -6.24 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
121 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
123 0 obj
<<
/Length 6382
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-37-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(unix$ echo hola >fich)Tj
0 -1.5 TD
(unix$ ln -s fich link)Tj
T*
(unix$ ls -l fich link)Tj
T*
0.6 Tw
[(-rw-r--r-- 1)-600(nemo wheel 5)-600(Aug )600(21 )600(19:24 )600(fich)]TJ
T*
0 Tw
[(lrwxr-xr-x )-600(1)-600(nemo )-600(wheel )-600(4)-600(Aug 21 19:24 link -> fich)]TJ
T*
(unix$ cat link)Tj
T*
(hola)Tj
T*
(unix$ cat fich)Tj
T*
(hola)Tj
T*
(unix$ rm fich)Tj
T*
(unix$ cat link)Tj
T*
(cat: link: No such file or directory)Tj
T*
(unix$ ls -l link)Tj
T*
[(lrwxr-xr-x )-600(1)-600(nemo )-600(wheel )-600(4)-600(Aug 21 19:24 link -> fich)]TJ
/TT6 1 Tf
10 0 0 10 72 522 Tm
0.0529 Tw
(Es interesante )Tj
/TT7 1 Tf
5.9369 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0529 Tw
(jarse en la salida de)Tj
/TT11 1 Tf
8.3441 0 TD
0 Tw
(ls)Tj
/TT6 1 Tf
1.5031 0 TD
(para)Tj
/TT11 1 Tf
2.0236 0 TD
(link)Tj
/TT6 1 Tf
2.4004 0 TD
0.0528 Tw
[(.)-302.9(E)0(l)-302.9(primer carácter es ")]TJ
/TT11 1 Tf
9.7227 0 TD
0 Tw
(l)Tj
/TT6 1 Tf
0.6001 0 TD
0.0528 Tw
(", lo que indica que el tipo de)Tj
/TT7 1 Tf
-31.087 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero es)Tj
/TT4 1 Tf
3.5537 0 TD
(symbolic link)Tj
/TT6 1 Tf
5.3042 0 TD
[(.)-250(S)0(i)-250(recuerdas)]TJ
/TT4 1 Tf
5.6646 0 TD
(stat\(2\))Tj
/TT6 1 Tf
2.6108 0 TD
[(,)-250(puedes utilizar código como)]TJ
/TT11 1 Tf
8 0 0 8 133 492 Tm
(if \(\(st.st_mode & S_IFMT\) == S_IFLNK\) {)Tj
2.4 -1.5 TD
(// el fichero es un enlace simbolico)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 450 Tm
[(para v)15(er si el )]TJ
/TT7 1 Tf
5.3712 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero que tienes entre manos es un enlace simbólico o no.)Tj
-5.9274 -2.4 TD
0.1268 Tw
(En general, las llamadas al sistema y funciones que operan con )Tj
/TT7 1 Tf
26.8303 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1268 Tw
[(cheros suelen se)15(guir los enlaces como)]TJ
-27.3865 -1.2 TD
0.2464 Tw
[(cabe esperar)55(.)-496.4(Por ejemplo, si)]TJ
/TT11 1 Tf
12.9226 0 TD
0 Tw
(open)Tj
/TT6 1 Tf
2.8968 0 TD
0.2463 Tw
[(recibe como ar)18(gumento el path de un )]TJ
/TT7 1 Tf
16.7839 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.2463 Tw
(chero que es un enlace)Tj
-33.1595 -1.2 TD
0 Tw
(simbólico, UNIX se da cuenta de ello y procede como sigue:)Tj
2.5 -1.56 TD
[(•)-2150(S)0(e)-250(leen los datos del )]TJ
/TT7 1 Tf
10.9151 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
-11.4713 -1.56 TD
[(•)-2150(S)0(e)-250(interpretan como el path del que hay que hacer el)]TJ
/TT11 1 Tf
23.6856 0 TD
(open)Tj
/TT6 1 Tf
-23.6856 -1.56 TD
[(•)-2150(S)0(e)-250(efectúa el)]TJ
/TT11 1 Tf
7.858 0 TD
(open)Tj
/TT6 1 Tf
2.6504 0 TD
(de dicho )Tj
/TT7 1 Tf
3.6655 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero)Tj
-17.2301 -1.2 TD
(Esto hace que normalmente tus programas trabajen correctamente aunque encuentren enlaces simbólicos.)Tj
0 -2.4 TD
0.0131 Tw
(No obstante, hay ocasiones en que hay que prestar atención a este tipo de )Tj
/TT7 1 Tf
29.701 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0131 Tw
(cheros. Por ejemplo, si hacemos)Tj
-30.2571 -1.2 TD
0 Tw
(un)Tj
/TT11 1 Tf
1.342 0 TD
(unlink)Tj
/TT6 1 Tf
3.9426 0 TD
0.092 Tw
(de un enlace simbólico tan sólo se borra el enlace y no el )Tj
/TT7 1 Tf
24.2155 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0919 Tw
[(chero enlazado.)-591.9(Aquí UNIX no)]TJ
-30.0563 -1.2 TD
0 Tw
(sigue el enlace de forma automática. Pero es mejor así, dado que lo que cabría esperar al ejecutar)Tj
/TT11 1 Tf
8 0 0 8 133 277.2 Tm
(unix$ rm fich)Tj
/TT6 1 Tf
10 0 0 10 72 259.2 Tm
0.0425 Tw
(es que se borre)Tj
/TT11 1 Tf
6.3897 0 TD
0 Tw
(fich)Tj
/TT6 1 Tf
2.4004 0 TD
0.0426 Tw
[(,)-292.5(sea un enlace o no. En ningún caso esperamos que se borre el )]TJ
/TT7 1 Tf
25.921 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5561 0 TD
0.0426 Tw
(chero al que apunta)Tj
/TT11 1 Tf
-35.2673 -1.2 TD
0 Tw
(fich)Tj
/TT6 1 Tf
2.6504 0 TD
(si es un enlace simbólico.)Tj
-2.6504 -2.4 TD
0.0314 Tw
(Llamadas como)Tj
/TT4 1 Tf
6.6717 0 TD
0 Tw
(stat\(2\))Tj
/TT6 1 Tf
2.8922 0 TD
0.0314 Tw
(son más delicadas. Utilizar)Tj
/TT11 1 Tf
11.15 0 TD
0 Tw
(stat)Tj
/TT6 1 Tf
2.6818 0 TD
0.0314 Tw
(sobre un )Tj
/TT7 1 Tf
3.7288 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0314 Tw
(chero que es un enlace simbólico hace)Tj
-27.6807 -1.2 TD
0.0322 Tw
[(que UNIX \(como hace en general\) atra)20(viese el enlace automáticamente.)-532.3(Esto hace que en realidad obteng-)]TJ
T*
0.0732 Tw
(amos los metadatos del )Tj
/TT7 1 Tf
9.8465 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0732 Tw
(chero al que apunta el enlace. Dicho de otro modo, ¡)Tj
/TT11 1 Tf
21.668 0 TD
0 Tw
(stat)Tj
/TT6 1 Tf
2.7236 0 TD
0.0732 Tw
(nunca te dirá que un)Tj
/TT7 1 Tf
-34.7943 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero es un enlace simbólico!)Tj
-0.5562 -2.4 TD
0.0704 Tw
(Una forma de solucionar este problema es llamar a)Tj
/TT11 1 Tf
21.2089 0 TD
0 Tw
(lstat)Tj
/TT6 1 Tf
3.0005 0 TD
0.0705 Tw
[(,)-320.5(que funciona igual que)]TJ
/TT11 1 Tf
10.2382 0 TD
0 Tw
(stat)Tj
/TT6 1 Tf
2.7209 0 TD
0.0705 Tw
(pero cuando el)Tj
/TT7 1 Tf
-37.1685 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
-0.0001 Tc
0.0001 Tw
[(chero es un enlace de)24.9(vuelv)14.9(e)-250.1(los atrib)19.9(utos del enlace en lugar de los del )]TJ
/TT7 1 Tf
28.4238 0 TD
0 Tc
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero enlazado.)Tj
-29.5361 -2.4 TD
0.2335 Tw
(Sucede lo mismo con llamadas como)Tj
/TT4 1 Tf
16.5089 0 TD
0 Tw
[(c)15(hown\(2\))]TJ
/TT6 1 Tf
3.7619 0 TD
(,)Tj
/TT4 1 Tf
0.7335 0 TD
[(c)15(hmod\(2\))]TJ
/TT6 1 Tf
3.817 0 TD
0.2334 Tw
[(,)-483.5(etc. Estas llamadas atra)20(viesan los enlaces)]TJ
-24.8213 -1.2 TD
0.0101 Tw
(simbólicos y operan sobre los )Tj
/TT7 1 Tf
12.1877 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0101 Tw
(cheros enlazados, pero dispones de llamadas con igual nombre pero comen-)Tj
-12.7439 -1.2 TD
0.05 Tw
(zando por ")Tj
/TT11 1 Tf
4.7289 0 TD
0 Tw
(l)Tj
/TT6 1 Tf
0.6001 0 TD
0.05 Tw
[(")-300(\(por ej., ")]TJ
/TT11 1 Tf
4.6041 0 TD
0 Tw
(lchmod)Tj
/TT6 1 Tf
3.6006 0 TD
0.05 Tw
("\) que, cuando el )Tj
/TT7 1 Tf
7.2444 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.05 Tw
(chero es un enlace simbólico, trabajan sobre el enlace)Tj
-21.3343 -1.2 TD
0 Tw
(en sí y no sobre el )Tj
/TT7 1 Tf
7.4985 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero enlazado.)Tj
/TT2 1 Tf
-8.0547 -2.4 TD
0.0024 Tw
(¡El manual es tu amigo!)Tj
/TT6 1 Tf
10.429 0 TD
(Aunque creas que sabes usar UNIX, consulta rápidamente la página de manual de)Tj
-10.429 -4.32 TD
0 Tw
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
124 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
126 0 obj
<<
/Length 4032
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-38-)Tj
-20.767 -3.6 TD
0.0537 Tw
[(la llamada que piensas usar)55(.)-303.7(Quizá recuerdes que debieras utilizar)]TJ
/TT11 1 Tf
26.998 0 TD
0 Tw
(lstat)Tj
/TT6 1 Tf
3.3041 0 TD
0.3036 Tc
[(yn)303.6(o)]TJ
/TT11 1 Tf
2.1072 0 TD
0 Tc
(stat)Tj
/TT6 1 Tf
2.704 0 TD
(o)Tj
/TT11 1 Tf
0.8036 0 TD
(fstat)Tj
/TT6 1 Tf
3.0005 0 TD
0.0536 Tw
[(... ¡y ahor)20(-)]TJ
-38.9174 -1.2 TD
0 Tw
[(rarás mucho tiempo depurando b)20(ugs que podrías haber e)25(vitado!)]TJ
0 -2.4 TD
0.0263 Tw
[(P)15(ara crear un enlace simbólico desde C puedes utilizar)]TJ
/TT4 1 Tf
22.2964 0 TD
0 Tw
(symlink\(2\))Tj
/TT6 1 Tf
4.497 0 TD
0.0263 Tw
(que funciona igual que)Tj
/TT4 1 Tf
9.4909 0 TD
0 Tw
(link\(2\))Tj
/TT6 1 Tf
2.6655 0 TD
0.0264 Tw
[(,)-276.4(pero crea)]TJ
-38.9499 -1.2 TD
-0.0001 Tc
0.0001 Tw
(un enlace simbólico en lugar de uno duro. Por ejemplo, este programa es similar a)Tj
/TT4 1 Tf
33.0687 0 TD
0 Tc
0 Tw
(ln\(1\))Tj
/TT6 1 Tf
2.1938 0 TD
(bajo el )Tj
/TT7 1 Tf
2.9434 0 TD
(ß)Tj
/TT6 1 Tf
0.5562 0 TD
(ag)Tj
/TT11 1 Tf
1.1938 0 TD
(-s)Tj
/TT6 1 Tf
1.2002 0 TD
(:)Tj
/TT11 1 Tf
8 0 0 8 133 642 Tm
(#include <stdio.h>)Tj
0 -1.5 TD
(#include <stdlib.h>)Tj
T*
(#include <unistd.h>)Tj
T*
(#include <err.h>)Tj
0 -3 TD
(int)Tj
0 -1.5 TD
(main\(int argc, char* argv[]\))Tj
T*
({)Tj
2.4 -3 TD
(if \(argc != 3\) {)Tj
2.4 -1.5 TD
(fprintf\(stderr, "usage: %s old new\\n", argv[0]\);)Tj
T*
(exit\(1\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(if \(symlink\(argv[1], argv[2]\) < 0\) {)Tj
2.4 -1.5 TD
(err\(1, "symlink %s", argv[1]\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(exit\(0\);)Tj
-2.4 -1.5 TD
(})Tj
/TT2 1 Tf
10 0 0 10 72 396 Tm
0.25 Tw
[(15. Dispositi)10(v)10(o)0(s)]TJ
/TT6 1 Tf
0 -1.56 TD
0 Tw
[(Y)100(a)100( )-100(conocemos di)25(v)15(ersos tipos de )]TJ
/TT7 1 Tf
12.9962 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero:)Tj
-11.0524 -1.56 TD
[(•)-2150(Ficheros re)15(gulares)]TJ
T*
[(•)-2150(Directorios)]TJ
T*
[(•)-2150(Enlaces simbólicos)]TJ
-2.5 -1.2 TD
(Pero es hora de mencionar dos más:)Tj
2.5 -1.56 TD
[(•)-2150(Dispositi)25(v)20(o)0(s)-250(d)0(e)-250(tipo carácter)]TJ
T*
[(•)-2150(Dispositi)25(v)20(o)0(s)-250(d)0(e)-250(tipo bloque)]TJ
-2.5 -2.4 TD
0.0945 Tw
[(Los dispositi)25(v)20(o)0(s)-344.5(son)]TJ
/TT4 1 Tf
8.6565 0 TD
0 Tw
(i-nodos)Tj
/TT6 1 Tf
3.3445 0 TD
0.0944 Tw
[(que no contienen datos en realidad. Se utilizan para representar dispositi)25(v)20(o)0(s)]TJ
-12.001 -1.2 TD
0.0325 Tw
[(que pueden ser artef)10(actos hardw)10(are \(como una impresora o un disco\) o pueden ser in)40(v)15(enciones de softw)10(are)]TJ
T*
0 Tw
(\(como)Tj
/TT11 1 Tf
2.8047 0 TD
(/dev/null)Tj
/TT6 1 Tf
5.4009 0 TD
[(\). La mayoría de los dispositi)25(v)20(o)0(s)-250(suelen estar en)]TJ
/TT11 1 Tf
19.3949 0 TD
(/dev)Tj
/TT6 1 Tf
2.4004 0 TD
(.)Tj
-30.0009 -2.4 TD
0.0149 Tw
[(UNIX distingue entre dispositi)25(v)20(o)0(s)-264.9(d)0(e)-264.9(modo carácter y de modo bloque principalmente por que los primeros)]TJ
0 -1.2 TD
0.0916 Tw
(se espera que correspondan a streams de caracteres \(el teclado, la pantalla al escribir caracteres, el ratón,)Tj
T*
0.0573 Tw
[(etc.\) y los se)15(gundos se espera que correspondan a almacenes de bloques de bytes de los que UNIX podría)]TJ
T*
0 Tw
(mantener una cache.)Tj
0 -2.4 TD
0.0557 Tw
(De hecho, los discos duros \(y las particiones\) suelen tener un par de )Tj
/TT7 1 Tf
28.105 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5561 0 TD
0.0557 Tw
[(cheros de dispositi)25(v)20(o)20( )-20(cada uno: uno)]TJ
-28.6611 -1.2 TD
0.0432 Tw
(de tipo carácter y uno de tipo bloque. El primero se utiliza para formatear el disco y para leerlo saltándose)Tj
T*
0.0885 Tw
[(la cache. El se)15(gundo se utiliza para acceder al disco bene)]TJ
/TT7 1 Tf
23.6639 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5561 0 TD
0.0885 Tw
(ciándose de la cache de bloques que mantiene)Tj
-24.2201 -1.2 TD
0.0888 Tw
[(UNIX. Por ejemplo, presentamos los dispositi)25(v)20(o)0(s)-338.9(d)0(e)-338.9(l)0(a)-338.9(primera partición del primer disco en nuestro sis-)]TJ
T*
0 Tw
(tema:)Tj
0 -8.64 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
127 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
129 0 obj
<<
/Length 7151
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-39-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(unix$ ls -l /dev/rdisk0s1)Tj
0 -1.5 TD
[(crw-r----- )-600(1)-600(root )-600(operator)-2400(1, )-1200(1)-600(Jul 13 07:30 /dev/rdisk0s1)]TJ
T*
(unix$ ls -l /dev/disk0s1)Tj
T*
[(brw-r----- )-600(1)-600(root )-600(operator)-2400(1, )-1200(1)-600(Jul 13 07:30 /dev/disk0s1)]TJ
/TT6 1 Tf
10 0 0 10 72 642 Tm
0.1535 Tw
(Cuando abres, lees o escribes un )Tj
/TT7 1 Tf
14.1671 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1535 Tw
(chero, UNIX localiza el)Tj
/TT4 1 Tf
10.4149 0 TD
0 Tw
(i-nodo)Tj
/TT6 1 Tf
3.0144 0 TD
(del )Tj
/TT7 1 Tf
1.6253 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1536 Tw
(chero y en función del tipo de)Tj
/TT7 1 Tf
-30.334 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0147 Tw
[(chero hace una cosa u otra. En el caso de los dispositi)25(v)20(os, simplemente se llama a una función distinta \(en)]TJ
-0.5562 -1.2 TD
-0.0001 Tc
0.0001 Tw
[(el k)9.9(ernel\) para cada tipo de dispositi)24.9(v)19.9(o)19.9( )-20(y)19.9( )-20(se)-250.1(deja que ella haga)-250.1(e)-0.1(l)-250.1(trabajo.)]TJ
0 -2.4 TD
0 Tc
0.0183 Tw
[(El código de un dispositi)25(v)20(o)20( )-20(suele llamarse)]TJ
/TT2 1 Tf
17.2188 0 TD
0 Tw
(manejador)Tj
/TT6 1 Tf
4.9343 0 TD
(o)Tj
/TT2 1 Tf
0.7683 0 TD
-0.01 Tc
[(d)-10(r)-10(ive)-10(r)]TJ
/TT6 1 Tf
2.6455 0 TD
0 Tc
0.0183 Tw
[(.)-268.3(S)0(i)-268.3(s)0(e)-268.3(trata de hardw)10(are, además de atender)]TJ
-25.567 -1.2 TD
0.0876 Tw
[(las interrupciones de dicho trozo de hardw)10(are y de detectar si está instalado en el sistema o no, el mane-)]TJ
T*
0 Tw
(jador implementará las operaciones del)Tj
/TT4 1 Tf
15.9102 0 TD
(i-nodo)Tj
/TT6 1 Tf
2.8608 0 TD
[(para el tipo de dispositi)25(v)20(o)20( )-20(de)-250(que se trate.)]TJ
-18.771 -2.4 TD
(En un)Tj
/TT4 1 Tf
2.6108 0 TD
(i-nodo)Tj
/TT6 1 Tf
2.8608 0 TD
[(de un dispositi)25(v)20(o)20( )-20(tienes dos números:)]TJ
-2.9717 -1.56 TD
[(•)-2150(Número principal \()]TJ
/TT4 1 Tf
10.1642 0 TD
(major number)Tj
/TT6 1 Tf
5.6943 0 TD
(\))Tj
-15.8585 -1.56 TD
[(•)-2150(Número secundario \()]TJ
/TT4 1 Tf
10.9415 0 TD
(minor number)Tj
/TT6 1 Tf
5.6943 0 TD
(\))Tj
-19.1358 -1.2 TD
0.0453 Tw
(El primero identi)Tj
/TT7 1 Tf
6.9221 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0453 Tw
[(ca un manejador de dispositi)25(v)20(o)20( )-20(\(por ejemplo, discos duros SA)111(T)93(A\). El se)15(gundo identi)]TJ
/TT7 1 Tf
34.2737 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5561 0 TD
(ca)Tj
-42.3082 -1.2 TD
[(de qué dispositi)25(v)20(o)20( )-20(concreto se trata \(por ejemplo, el primer disco SA)111(T)93(A)93( )-93(en)-250(el)-250(primer b)20(us SA)111(T)93(A\).)]TJ
0 -2.4 TD
0.0062 Tw
(Así pues, si un)Tj
/TT4 1 Tf
6.1639 0 TD
0 Tw
(i-nodo)Tj
/TT6 1 Tf
2.8669 0 TD
0.0061 Tw
[(es un dispositi)25(v)20(o)20( )-20(de)-256.1(bloque que identi)]TJ
/TT7 1 Tf
15.101 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0061 Tw
(ca un disco y el número principal corresponde)Tj
-24.6879 -1.2 TD
0.0485 Tw
[(al dri)25(v)15(e)0(r)-298.5(d)0(e)-298.5(discos SA)111(T)93(A)0(,)-298.5(todas las llamadas)]TJ
/TT11 1 Tf
18.3344 0 TD
0 Tw
(open)Tj
/TT6 1 Tf
2.4004 0 TD
(,)Tj
/TT11 1 Tf
0.5486 0 TD
(read)Tj
/TT6 1 Tf
2.4004 0 TD
0.0486 Tw
[(,)-298.6(... que operen sobre ese)]TJ
/TT4 1 Tf
10.399 0 TD
0 Tw
(i-nodo)Tj
/TT6 1 Tf
2.9094 0 TD
0.0486 Tw
(llamarán a fun-)Tj
-36.9923 -1.2 TD
0.0245 Tw
[(ciones concretas del manejador de discos SA)111(T)93(A)0(.)-274.6(A)-274.6(dichas funciones se les dará además el)]TJ
/TT4 1 Tf
36.5408 0 TD
0 Tw
(i-nodo)Tj
/TT6 1 Tf
2.8853 0 TD
0.0245 Tw
(de que se)Tj
-39.4261 -1.2 TD
0 Tw
[(trate y podrán v)15(er el número secundario \(v)15(er de qué disco concreto hay que leer)40(,)-250(escribir)40(,)-250(etc.\).)]TJ
0 -2.4 TD
(Ahora puedes entender la salida de este comando:)Tj
/TT11 1 Tf
8 0 0 8 133 388.8 Tm
(unix$ ls -l /dev/tty)Tj
0 -1.5 TD
[(crw-rw-rw- )-600(1)-600(root )-600(wheel)-2400(2, )-1200(0)-600(Aug 20 12:30 /dev/tty)]TJ
/TT6 1 Tf
10 0 0 10 72 358.8 Tm
0.0149 Tw
(El primer carácter es una ")Tj
/TT11 1 Tf
10.7268 0 TD
0 Tw
(c)Tj
/TT6 1 Tf
0.6001 0 TD
0.0149 Tw
(", lo que indica)Tj
/TT4 1 Tf
6.3828 0 TD
[(dispositivo de car)15(acter)37(es)]TJ
/TT6 1 Tf
9.9758 0 TD
[(.)-264.9(Y)-264.9(los números)]TJ
/TT11 1 Tf
6.6426 0 TD
0 Tw
(2)Tj
/TT6 1 Tf
0.865 0 TD
(y)Tj
/TT11 1 Tf
0.7649 0 TD
(0)Tj
/TT6 1 Tf
0.865 0 TD
0.0149 Tw
(corresponden al)Tj
-36.8231 -1.2 TD
0 Tw
(número principal y secundario.)Tj
0 -2.4 TD
0.0558 Tw
[(Los dispositi)25(v)20(o)0(s)-305.8(sólo son )]TJ
/TT7 1 Tf
10.5132 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
-0.0001 Tc
0.0558 Tw
[(cheros que representan a los dispositi)24.9(v)19.9(os, no son hardw)9.9(are. Esto es, que tengas)]TJ
-11.0693 -1.2 TD
0 Tc
0 Tw
(en)Tj
/TT11 1 Tf
1.1938 0 TD
(/dev)Tj
/TT6 1 Tf
2.6504 0 TD
-0.0001 Tc
0.0001 Tw
[(mil dispositi)24.9(v)19.9(o)-0.1(s)-250.1(para discos duros no quiere decir que tengas mil discos instalados.)]TJ
-3.8442 -2.4 TD
0 Tc
0.0568 Tw
[(P)15(ara crear un )]TJ
/TT7 1 Tf
5.6798 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0568 Tw
[(chero de dispositi)25(v)20(o)20( )-20(podemos utilizar)]TJ
/TT4 1 Tf
15.4863 0 TD
0 Tw
(mknod\(1\))Tj
/TT6 1 Tf
3.832 0 TD
0.0569 Tw
[(,)-306.9(que llama a)]TJ
/TT4 1 Tf
5.5865 0 TD
0 Tw
(mknod\(2\))Tj
/TT6 1 Tf
3.832 0 TD
0.0569 Tw
[(.)-306.9(Pero, normalmente)]TJ
-34.9728 -1.2 TD
0 Tw
(hay que ser)Tj
/TT4 1 Tf
4.8037 0 TD
[(r)45(oot)]TJ
/TT6 1 Tf
1.872 0 TD
[(para poderlo hacer)55(.)-250(!Así que v)25(amos a con)40(v)15(ertirnos en)]TJ
/TT4 1 Tf
21.468 0 TD
[(r)45(oot)]TJ
/TT6 1 Tf
1.872 0 TD
[(y)-250(crear uno!:)]TJ
/TT11 1 Tf
8 0 0 8 133 256.8 Tm
(unix$ sudo su)Tj
0 -1.5 TD
(Password:)Tj
T*
(unix# mknod term c 2 0)Tj
T*
(sh-3.2# echo hola >term)Tj
T*
(hola)Tj
T*
(unix# ls -l term)Tj
T*
[(crw-r--r-- )-600(1)-600(root )-600(staff)-2400(2, )-1200(0)-600(Aug 21 19:56 term)]TJ
T*
(unix# rm term)Tj
T*
(unix# exit)Tj
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 118.8 Tm
0.0413 Tw
[(Como v)15(erás, hemos creado un )]TJ
/TT7 1 Tf
12.5216 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0413 Tw
(chero llamado)Tj
/TT11 1 Tf
6.0244 0 TD
0 Tw
(term)Tj
/TT6 1 Tf
2.4004 0 TD
0.0412 Tw
[(,)-291.2(que es un dispositi)25(v)20(o)20( )-20(de)-291.2(modo carácter \(")]TJ
/TT11 1 Tf
17.3271 0 TD
0 Tw
(c)Tj
/TT6 1 Tf
0.6001 0 TD
0.0412 Tw
("\) y tiene)Tj
-39.4297 -1.2 TD
0 Tw
(números)Tj
/TT11 1 Tf
3.74 0 TD
(2)Tj
/TT6 1 Tf
0.8963 0 TD
(y)Tj
/TT11 1 Tf
0.7962 0 TD
(0)Tj
/TT6 1 Tf
0.8963 0 TD
(como)Tj
/TT4 1 Tf
2.5179 0 TD
(major)Tj
/TT6 1 Tf
2.6854 0 TD
(y)Tj
/TT4 1 Tf
0.7962 0 TD
(minor)Tj
/TT6 1 Tf
2.3892 0 TD
0.0462 Tw
[(.)-296.2(S)0(i)-296.2(recuerdas el listado de)]TJ
/TT11 1 Tf
11.0238 0 TD
0 Tw
(/dev/tty)Tj
/TT6 1 Tf
4.8008 0 TD
0.0463 Tw
[(,)-296.2(v)15(erás que estamos creando un)]TJ
-30.542 -1.2 TD
0.0669 Tw
[(dispositi)25(v)20(o)20( )-20.1(para el mismo artef)10(acto. Una v)15(ez creado, podemos utilizar)]TJ
/TT11 1 Tf
28.8123 0 TD
0 Tw
(term)Tj
/TT6 1 Tf
2.7173 0 TD
0.0669 Tw
(igual que)Tj
/TT11 1 Tf
4.0772 0 TD
0 Tw
(/dev/tty)Tj
/TT6 1 Tf
4.8008 0 TD
[(,)-316.9(como)]TJ
-40.4075 -1.2 TD
[(puedes v)15(er por el efecto de)]TJ
/TT11 1 Tf
10.9796 0 TD
(echo)Tj
/TT6 1 Tf
2.6504 0 TD
(en nuestro ejemplo.)Tj
-13.63 -5.88 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
130 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
132 0 obj
<<
/Length 2826
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-40-)Tj
/TT2 1 Tf
-20.767 -3.6 TD
0.25 Tw
[(16. Entrada/salida)-250(y)-250(b)20(uffering)]TJ
/TT6 1 Tf
0 -1.56 TD
0.0374 Tw
[(El interf)10(az proporcionado por)]TJ
/TT11 1 Tf
12.246 0 TD
0 Tw
(open)Tj
/TT6 1 Tf
2.4004 0 TD
(,)Tj
/TT11 1 Tf
0.5374 0 TD
(close)Tj
/TT6 1 Tf
3.0005 0 TD
(,)Tj
/TT11 1 Tf
0.5374 0 TD
(read)Tj
/TT6 1 Tf
2.4004 0 TD
(,)Tj
/TT11 1 Tf
0.5374 0 TD
(write)Tj
/TT6 1 Tf
3.0005 0 TD
0.0375 Tw
[(,)-287.4(etc. es su)]TJ
/TT7 1 Tf
4.2501 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0375 Tw
[(ciente la mayoría de las v)15(eces. Lo)]TJ
-29.4662 -1.2 TD
0.0608 Tw
(que es más, en muchas ocasiones es el más adecuado. Por ejemplo,)Tj
/TT4 1 Tf
27.8047 0 TD
0 Tw
(cat\(1\))Tj
/TT6 1 Tf
2.6984 0 TD
0.0607 Tw
[(debería utilizar un b)20(u)0(f)25(fer cierto)]TJ
-30.5031 -1.2 TD
0.0431 Tw
(tamaño \(8KiB, quizá\) y usar)Tj
/TT11 1 Tf
11.8234 0 TD
0 Tw
(read)Tj
/TT6 1 Tf
2.6935 0 TD
(y)Tj
/TT11 1 Tf
0.7931 0 TD
(write)Tj
/TT6 1 Tf
3.2936 0 TD
0.0431 Tw
(para hacer su trabajo. Es lo más simple y además lo más e)Tj
/TT7 1 Tf
23.7042 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(-)Tj
-42.864 -1.2 TD
[(ciente la mayoría de las v)15(eces.)]TJ
0 -2.4 TD
0.1057 Tw
(No obstante, hay ocasiones en que deseamos leer carácter a carácter o línea a línea, o deseamos escribir)Tj
0 -1.2 TD
0.078 Tw
(poco a poco la salida del programa o escribir con cierto formato. En estos casos es mucho más adecuado)Tj
T*
0.1045 Tw
(utilizar la librería de C que las llamadas al sistema. Además, dicha librería suministra entrada/salida con)Tj
T*
0 Tw
[(b)20(u)0(f)25(fering, lo que hace que el programa sea mucho mas e)]TJ
/TT7 1 Tf
22.5292 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(ciente si leemos o escribimos poco a poco.)Tj
-23.0854 -2.4 TD
0.0088 Tw
[(V)111(eamos un programa que copia un )]TJ
/TT7 1 Tf
14.1596 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0088 Tw
[(chero en otro, pero byte a byte.)-508.8(Esta v)15(ersión utiliza las llamadas al sis-)]TJ
-14.7157 -1.2 TD
0 Tw
(tema que hemos visto.)Tj
/TT11 1 Tf
8 0 0 8 108 542.4 Tm
(#include <stdio.h>)Tj
0 -1.5 TD
(#include <stdlib.h>)Tj
T*
(#include <unistd.h>)Tj
T*
(#include <fcntl.h>)Tj
T*
(#include <err.h>)Tj
0 -3 TD
(int)Tj
0 -1.5 TD
(main\(int argc, char* argv[]\))Tj
T*
({)Tj
2.4 -1.5 TD
(int sfd, dfd, nr;)Tj
T*
(char buf[1];)Tj
0 -3 TD
(if\(argc != 3\) {)Tj
2.4 -1.5 TD
(fprintf\(stderr, "usage: %s src dst\\n", argv[0]\);)Tj
T*
(exit\(1\);)Tj
-2.4 -1.5 TD
(})Tj
0 -4.5 TD
(sfd = open\(argv[1], O_RDONLY\);)Tj
0 -1.5 TD
(if\(sfd < 0\){)Tj
2.4 -1.5 TD
(err\(1, "open: %s", argv[1]\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(dfd = creat\(argv[2], 0664\);)Tj
T*
(if\(dfd < 0\){)Tj
2.4 -1.5 TD
(close\(sfd\);)Tj
T*
(err\(1, "creat: %s", argv[2]\);)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 24 Tm
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
133 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
135 0 obj
<<
/Length 3663
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-41-)Tj
/TT11 1 Tf
8 0 0 8 127.2 708 Tm
(for\(;;\){)Tj
2.4 -1.5 TD
(nr = read\(sfd, buf, sizeof buf\);)Tj
T*
(if\(nr == 0\){)Tj
2.4 -1.5 TD
(break;)Tj
-2.4 -1.5 TD
(})Tj
T*
(if\(nr < 0\){)Tj
2.4 -1.5 TD
(close\(sfd\);)Tj
T*
(close\(dfd\);)Tj
T*
(err\(1, "read: %s:", argv[1]\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(if\(write\(dfd, buf, nr\) != nr\){)Tj
2.4 -1.5 TD
(close\(sfd\);)Tj
T*
(close\(dfd\);)Tj
T*
(err\(1, "write: %s:", argv[2]\);)Tj
-2.4 -1.5 TD
(})Tj
-2.4 -1.5 TD
(})Tj
T*
(close\(sfd\);)Tj
T*
(if \(close\(dfd\) < 0\) {)Tj
2.4 -1.5 TD
(err\(1, "close: %s:", argv[2]\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(exit\(0\);)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 426 Tm
0.0008 Tw
(Podemos crear un )Tj
/TT7 1 Tf
7.417 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0008 Tw
(chero de 10MiB utilizando el comando)Tj
/TT4 1 Tf
15.8895 0 TD
0 Tw
(dd\(1\))Tj
/TT6 1 Tf
2.166 0 TD
0.0007 Tw
[(.)-250.7(Basta pedirle que copie 10240 bloques de)]TJ
-26.0286 -1.2 TD
0 Tw
(1024 bytes desde)Tj
/TT11 1 Tf
7.1377 0 TD
(/dev/zero)Tj
/TT6 1 Tf
5.6509 0 TD
(\(una fuente ilimitada de ceros\) hasta el )Tj
/TT7 1 Tf
15.7432 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero en cuestión:)Tj
/TT11 1 Tf
8 0 0 8 133 396 Tm
(unix$ dd if=/dev/zero of=/tmp/10m bs=1024 count=10240)Tj
0 -1.5 TD
(10240+0 records in)Tj
T*
(10240+0 records out)Tj
T*
(10485760 bytes transferred in 0.028481 secs \(368166762 bytes/sec\))Tj
T*
(unix$ ls -l /tmp/10m)Tj
T*
0.6 Tw
[(-rw-r--r-- 1)-600(nemo wheel 10485760)-600(Aug )600(21 )600(22:06 )600(/tmp/10m)]TJ
/TT6 1 Tf
10 0 0 10 72 318 Tm
0.0711 Tw
(Este comando se llama así por usarse hace tiempo para copiar)Tj
/TT4 1 Tf
25.7445 0 TD
[(de)15(vice to de)15(vice)]TJ
/TT6 1 Tf
6.4965 0 TD
[(,)-321.1(e)0(n)-321.1(los tiempos en que las)]TJ
-32.241 -1.2 TD
0 Tw
(cintas magnéticas eran muy puntillosas respecto a qué tamaños de lectura y escritura admitían.)Tj
0 -2.4 TD
[(Ahora v)15(eamos cuánto tarda nuestro programa en copiar nuestro nue)25(v)20(o)20( )]TJ
/TT7 1 Tf
28.2632 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero.)Tj
/TT11 1 Tf
8 0 0 8 133 264 Tm
(unix$ time cp1 /tmp/10m /tmp/10mbis)Tj
0 -1.5 TD
1.8 Tw
(real 0m16.850s)Tj
T*
(user 0m1.563s)Tj
T*
(sys 0m15.230s)Tj
T*
0 Tw
(unix$ ls -l /tmp/10mbis)Tj
T*
0.6 Tw
[(-rw-r--r-- 1)-600(nemo wheel 10485760)-600(Aug )600(21 )600(22:06 )600(/tmp/1mbis)]TJ
/TT6 1 Tf
10 0 0 10 72 186 Tm
0.1008 Tw
[(¡Un total de 16.8 se)15(gundos! ¡Un eón! Y para sólo 10MiB de datos. Esto quiere decir que copiar un sólo)]TJ
0 -1.2 TD
0 Tw
[(MiB tardaría aproximadamente 1.68 se)15(gundos. Muchísimo tiempo para las máquinas de ho)10(y)-250(día.)]TJ
0 -2.4 TD
0.1269 Tw
(Por cierto, el comando)Tj
/TT4 1 Tf
9.8103 0 TD
0 Tw
(time\(1\))Tj
/TT6 1 Tf
3.2646 0 TD
0.1269 Tw
[(que hemos utilizado ejecuta la línea de ar)18(gumentos como un comando e)]TJ
-13.0749 -1.2 TD
0.1516 Tw
[(imprime, como has podido v)15(e)0(r)40(,)-401.6(cuánto tiempo ha empleado dicho comando en total, cuánto ejecutando)]TJ
T*
0.0428 Tw
[(código de usuario y cuánto ejecutado código del k)10(ernel en su f)10(a)20(v)20(o)0(r)55(.)55( )-55.1(Es)-292.9(una herramienta indispensable para)]TJ
T*
0 Tw
[(v)15(e)0(r)-250(s)0(i)-250(cuándo haces un cambio en un programa has mejorado realmente las cosas o las has empeorado.)]TJ
0 -2.4 TD
0.1057 Tw
[(V)111(eamos ahora el mismo programa, pero esta v)15(ez escrito on)]TJ
/TT4 1 Tf
24.8392 0 TD
0 Tw
(stdio)Tj
/TT6 1 Tf
1.9448 0 TD
0.1057 Tw
[(,)-355.7(l)0(a)-355.7(librería estándar de C con b)20(u)0(f)25(fering)]TJ
-26.784 -1.2 TD
0 Tw
[(para entrada/salida. Igual que antes, v)25(amos a copiar byte a byte.)]TJ
0 -5.4 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
136 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
139 0 obj
<<
/Length 3206
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-42-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(#include <stdio.h>)Tj
0 -1.5 TD
(#include <stdlib.h>)Tj
T*
(#include <err.h>)Tj
0 -3 TD
(int)Tj
0 -1.5 TD
(main\(int argc, char* argv[]\))Tj
T*
({)Tj
2.4 -1.5 TD
(FILE *in, *out;)Tj
T*
(char buf[1];)Tj
T*
(size_t nr;)Tj
0 -3 TD
(if\(argc != 3\) {)Tj
2.4 -1.5 TD
(fprintf\(stderr, "usage: %s src dst\\n", argv[0]\);)Tj
T*
(exit\(1\);)Tj
-2.4 -1.5 TD
(})Tj
0 -3 TD
(in = fopen\(argv[1], "r"\);)Tj
0 -1.5 TD
(if\(in == NULL\){)Tj
2.4 -1.5 TD
(err\(1, "%s", argv[1]\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(out = fopen\(argv[2], "w"\);)Tj
T*
(if\(out == NULL\){)Tj
2.4 -1.5 TD
(err\(1, "%s", argv[2]\);)Tj
-2.4 -1.5 TD
(})Tj
0 -4.5 TD
(for\(;;\){)Tj
2.4 -1.5 TD
(nr = fread\(buf, sizeof buf, 1, in\);)Tj
T*
(if\(nr == 0\){)Tj
2.4 -1.5 TD
(if\(ferror\(in\)\) {)Tj
2.4 -1.5 TD
(err\(1, "read"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(break;)Tj
-2.4 -1.5 TD
(})Tj
T*
(if\(fwrite\(buf, nr, 1, out\) != nr\){)Tj
2.4 -1.5 TD
(err\(1, "write"\);)Tj
-2.4 -1.5 TD
(})Tj
-2.4 -1.5 TD
(})Tj
T*
(fclose\(in\);)Tj
T*
(fclose\(out\);)Tj
T*
(exit\(0\);)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 186 Tm
0.0076 Tw
(En este caso, hemos utilizado)Tj
/TT4 1 Tf
12.0902 0 TD
0 Tw
(fopen\(3\))Tj
/TT6 1 Tf
3.6453 0 TD
-0.0005 Tc
0.0081 Tw
(en lugar de)Tj
/TT4 1 Tf
4.7102 0 TD
0 Tc
0 Tw
(open\(2\))Tj
/TT6 1 Tf
3.3675 0 TD
0.0076 Tw
(para obtener un ")Tj
/TT11 1 Tf
6.9002 0 TD
0 Tw
(FILE*)Tj
/TT6 1 Tf
3.0005 0 TD
0.0077 Tw
(". Esta estructura repre-)Tj
-33.7139 -1.2 TD
0.056 Tw
[(senta un b)20(u)0(f)25(fer \(quizá\) para operar en un descriptor de )]TJ
/TT7 1 Tf
22.5047 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.056 Tw
(chero que la estructura mantiene internamente. Si)Tj
-23.0609 -1.2 TD
0 Tw
(lees)Tj
/TT4 1 Tf
1.8283 0 TD
(fopen\(3\))Tj
/TT6 1 Tf
3.6613 0 TD
0.0236 Tw
[(v)15(erás que hay llamadas para construir un)]TJ
/TT11 1 Tf
16.7273 0 TD
0 Tw
(FILE*)Tj
/TT6 1 Tf
3.2741 0 TD
0.0236 Tw
[(a)-273.6(partir de un descriptor de )]TJ
/TT7 1 Tf
11.1372 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
-0.0003 Tc
0.0239 Tw
(chero, en lugar)Tj
-37.1844 -1.2 TD
0 Tc
0 Tw
(de un path.)Tj
0 -2.4 TD
0.0215 Tw
(En realidad ya conoces este tipo de datos. Anteriormente hemos utilizado)Tj
/TT11 1 Tf
29.8381 0 TD
0 Tw
(stderr)Tj
/TT6 1 Tf
3.8721 0 TD
0.0215 Tw
(para imprimir mensajes)Tj
-33.7101 -1.2 TD
0.0932 Tw
(de error con)Tj
/TT11 1 Tf
5.3603 0 TD
0 Tw
(fprintf)Tj
/TT6 1 Tf
4.2007 0 TD
0.0933 Tw
[(.)-343.3(Pues bien,)]TJ
/TT11 1 Tf
5.1407 0 TD
0 Tw
(stderr)Tj
/TT6 1 Tf
3.9439 0 TD
0.0933 Tw
(es un)Tj
/TT11 1 Tf
2.5196 0 TD
0 Tw
(FILE*)Tj
/TT6 1 Tf
3.3438 0 TD
0.0933 Tw
(para el descriptor)Tj
/TT11 1 Tf
7.4708 0 TD
0 Tw
(2)Tj
/TT6 1 Tf
0.6001 0 TD
0.0933 Tw
[(.)-343.3(¿Resulta claro ahora por)]TJ
-32.5799 -1.2 TD
0 Tw
(qué utilizamos)Tj
/TT11 1 Tf
8 0 0 8 133 84 Tm
(fprintf\(stderr, "usage: %s [-n]\\n", argv[0]\);)Tj
/TT6 1 Tf
10 0 0 10 72 66 Tm
0.0487 Tw
(para informar del uso de un programa? Igualmente tienes)Tj
/TT11 1 Tf
23.5681 0 TD
0 Tw
(stdin)Tj
/TT6 1 Tf
3.2991 0 TD
0.0486 Tw
(para la entrada estándar y)Tj
/TT11 1 Tf
10.7093 0 TD
0 Tw
(stdout)Tj
/TT6 1 Tf
3.8992 0 TD
(para)Tj
-41.4757 -4.2 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
140 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
142 0 obj
<<
/Length 6544
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-43-)Tj
-20.767 -3.6 TD
[(la salida estándar)55(.)]TJ
0 -2.4 TD
0.0484 Tw
(La función)Tj
/TT11 1 Tf
4.7062 0 TD
0 Tw
(printf\(...\))Tj
/TT6 1 Tf
6.8995 0 TD
0.0484 Tw
[(es equi)25(v)25(alente a)]TJ
/TT11 1 Tf
6.731 0 TD
0 Tw
(fprintf\(stdout,...\))Tj
/TT6 1 Tf
11.4019 0 TD
[(.)-298.5(L)0(a)-298.5(librería)]TJ
/TT4 1 Tf
5.0874 0 TD
(stdio)Tj
/TT6 1 Tf
2.2433 0 TD
0.0485 Tw
(tiene funciones)Tj
-37.0693 -1.2 TD
0.0217 Tw
(que comienzan por ")Tj
/TT11 1 Tf
8.3312 0 TD
0 Tw
(f)Tj
/TT6 1 Tf
0.6001 0 TD
0.0217 Tw
[(")-271.7(y)-271.7(tienen nombres similares a funciones que ya conoces, como)]TJ
/TT11 1 Tf
25.8061 0 TD
0 Tw
(fopen)Tj
/TT6 1 Tf
3.0005 0 TD
(,)Tj
/TT11 1 Tf
0.5216 0 TD
(fread)Tj
/TT6 1 Tf
3.0005 0 TD
[(,)-271.6(etc.)]TJ
-41.26 -1.2 TD
(Naturalmente, operan sobre)Tj
/TT11 1 Tf
11.3286 0 TD
(FILE*)Tj
/TT6 1 Tf
3.2505 0 TD
[(y)-250(n)0(o)-250(sobre descriptores de )]TJ
/TT7 1 Tf
10.6914 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero: para eso están.)Tj
-25.8267 -2.4 TD
[(Pero v)20(olv)25(amos a nuestro e)15(xperimento. V)111(amos a v)15(er cuánto tarda este programa en hacer el mismo trabajo:)]TJ
/TT11 1 Tf
8 0 0 8 133 618 Tm
(unix$ time 8.bcp2 /tmp/1m /tmp/1mbis)Tj
0 -3 TD
1.8 Tw
(real 0m0.912s)Tj
0 -1.5 TD
(user 0m0.881s)Tj
T*
(sys 0m0.022s)Tj
/TT6 1 Tf
10 0 0 10 72 552 Tm
0.0679 Tw
[(Hemos tardado menos de un se)15(gundo. Bastante más rápido que antes. Y hay que decir que la máquina en)]TJ
0 -1.2 TD
0.0108 Tw
[(que hemos hecho este e)15(xperimento posee un disco SSD que en realidad es memoria de estado sólido, por lo)]TJ
T*
0.0232 Tw
[(que la diferencia de tiempos no es tanta como sería utilizando un disco duro magnético. ¡La última v)15(ez que)]TJ
T*
0.0026 Tw
(probamos con discos magnéticos pudimos hacer el descanso de una clase mientras el primero de los progra-)Tj
T*
0 Tw
(mas terminaba su trabajo!)Tj
0 -2.4 TD
0.0424 Tw
[(¿Cómo ha podido tardar menos esta se)15(gunda v)15(ersión? La respuesta radica en que se utiliza un b)20(u)0(f)25(fer inter)20(-)]TJ
0 -1.2 TD
0.031 Tw
(medio dentro del)Tj
/TT11 1 Tf
7.1189 0 TD
0 Tw
(FILE*)Tj
/TT6 1 Tf
3.0005 0 TD
0.031 Tw
[(.)-281(L)0(a)-281(primera v)15(ez que se llama a)]TJ
/TT11 1 Tf
12.9766 0 TD
0 Tw
(fread)Tj
/TT6 1 Tf
3.0005 0 TD
(,)Tj
/TT4 1 Tf
0.5309 0 TD
(stdio)Tj
/TT6 1 Tf
2.2257 0 TD
0.0309 Tw
(lee una cantidad razonable de bytes)Tj
-28.853 -1.2 TD
0.1628 Tw
(con una llamada a)Tj
/TT11 1 Tf
8.1478 0 TD
0 Tw
(read)Tj
/TT6 1 Tf
2.4004 0 TD
0.1628 Tw
[(.)-412.8(S)0(i)-412.8(s)0(e)-412.8(estaba le)15(yendo un sólo byte no importa, el resto ya están en el b)20(u)0(f)25(fer)]TJ
-10.5482 -1.2 TD
0.0253 Tw
(esperando que los leas en el futuro. Las llamadas a procedimiento son mucho más rápidas que las llamadas)Tj
T*
0.0487 Tw
[(al sistema, dado que éstas han de entrar y salir del k)10(ernel y dado que el k)10(ernel comprueba cada v)15(ez que lo)]TJ
T*
0 Tw
[(llamas que todos tus ar)18(gumentos son correctos y que todo está en orden para hacer la llamada.)]TJ
0 -2.4 TD
0.0914 Tw
(En las escrituras sucede lo mismo, cuando escribes con)Tj
/TT11 1 Tf
23.1493 0 TD
0 Tw
(fwrite)Tj
/TT6 1 Tf
3.942 0 TD
0.0914 Tw
(\(o con)Tj
/TT11 1 Tf
2.9597 0 TD
0 Tw
(fprintf)Tj
/TT6 1 Tf
4.2007 0 TD
0.0913 Tw
(\), los bytes se quedan)Tj
-34.2516 -1.2 TD
0.08 Tw
[(normalmente en el b)20(u)0(f)25(fer)55(.)-330(Sólo cuando el b)20(u)0(f)25(fer se llena o cierras el)]TJ
/TT11 1 Tf
28.3287 0 TD
0 Tw
(FILE*)Tj
/TT6 1 Tf
3.3306 0 TD
0.0801 Tw
(se escriben los bytes con un)Tj
/TT11 1 Tf
-31.6593 -1.2 TD
0 Tw
(write)Tj
/TT6 1 Tf
3.0005 0 TD
0.0343 Tw
[(.)-284.3(Eso quiere decir que aunque escribamos byte a byte, en realidad estamos haciendo muchos menos)]TJ
/TT11 1 Tf
-3.0005 -1.2 TD
0 Tw
(write)Tj
/TT6 1 Tf
3.2505 0 TD
[(y)-250(estos escriben muchos bytes a la v)15(ez.)]TJ
-3.2505 -2.4 TD
0.1344 Tw
[(Un detalle importante cuando se utiliza b)20(u)0(f)25(fering, es llamar a)]TJ
/TT11 1 Tf
26.0397 0 TD
0 Tw
(fclose)Tj
/TT6 1 Tf
3.6006 0 TD
0.1345 Tw
[(,)-384.5(dado que, si hemos escrito, los)]TJ
-29.6403 -1.2 TD
0.0783 Tw
[(bytes pueden estar en el b)20(u)0(f)25(fer y no haberse escrito en absoluto en el )]TJ
/TT7 1 Tf
28.7636 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0783 Tw
(chero. Por esta razón)Tj
/TT11 1 Tf
8.9485 0 TD
0 Tw
(stderr)Tj
/TT6 1 Tf
3.9289 0 TD
(no)Tj
-42.1971 -1.2 TD
[(utiliza b)20(u)0(f)25(fering en absoluto, para que los mensajes de error aparezcan inmediatamente en el terminal.)]TJ
0 -2.4 TD
(La función)Tj
/TT11 1 Tf
4.6094 0 TD
(fflush)Tj
/TT6 1 Tf
3.8506 0 TD
[(vuelca el b)20(u)0(f)25(fer de un)]TJ
/TT11 1 Tf
8.9228 0 TD
(FILE*)Tj
/TT6 1 Tf
3.0005 0 TD
[(,)-250(por ejemplo,)]TJ
/TT11 1 Tf
8 0 0 8 133 270 Tm
(if \(fflush\(out\) < 0\) {)Tj
2.4 -1.5 TD
(// el flush ha fallado \(fallo en write?\))Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 228 Tm
0.1163 Tw
[(escribe lo que pueda haber en el b)20(u)0(f)25(fer de)]TJ
/TT11 1 Tf
17.9658 0 TD
0 Tw
(out)Tj
/TT6 1 Tf
2.1667 0 TD
0.1164 Tw
(en el descriptor de )Tj
/TT7 1 Tf
8.0735 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1164 Tw
(chero que hay bajo)Tj
/TT11 1 Tf
8.2957 0 TD
0 Tw
(out)Tj
/TT6 1 Tf
1.8003 0 TD
[(.)-366.4(Sabiendo)]TJ
-38.8581 -1.2 TD
0.0015 Tw
(esto... ¿Cuánto crees que tardaría el programa si haces un)Tj
/TT11 1 Tf
23.2 0 TD
0 Tw
(fflush)Tj
/TT6 1 Tf
3.852 0 TD
0.0014 Tw
[(en cada iteración del b)20(ucle)]TJ
/TT11 1 Tf
10.8976 0 TD
0 Tw
(for)Tj
/TT6 1 Tf
1.8003 0 TD
0.2514 Tc
[(?¿)251.4(Yp)251.4(o)251.4(r)]TJ
-39.7499 -1.2 TD
0 Tc
(qué crees tal cosa?)Tj
0 -2.4 TD
0.053 Tw
(Hay otras muchas funciones y utilidades en)Tj
/TT4 1 Tf
18.0054 0 TD
0 Tw
(stdio\(3\))Tj
/TT6 1 Tf
3.4139 0 TD
0.0531 Tw
(que deberías conocer para programar en C. Por ejem-)Tj
-21.4193 -1.2 TD
0.1208 Tw
[(plo, un par de funciones para leer línea a línea entre otras. Pero nosotros v)25(amos a continuar e)15(xplorando)]TJ
T*
0 Tw
(UNIX.)Tj
/TT2 1 Tf
0 -3.6 TD
[(17. )-250(Buffering)-250(en el k)10(e)0(r)15(nel)]TJ
/TT6 1 Tf
0 -1.56 TD
0.1133 Tw
[(Hemos visto hace poco que los dispositi)25(v)20(o)0(s)-363.3(d)0(e)-363.3(modo bloque utilizan una cache de bloques en el k)10(ernel.)]TJ
0 -1.2 TD
0.0178 Tw
(Esto implica que cuando escribes un )Tj
/TT7 1 Tf
14.9359 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0178 Tw
(chero lo habitual es que tus datos aún no estén en el disco. Lo que es)Tj
-15.4921 -1.2 TD
0 Tw
(más, incluso )Tj
/TT7 1 Tf
5.2495 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(cheros que has creado o borrado podrían no haberse actualizado en el disco.)Tj
-5.8057 -5.64 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
143 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
145 0 obj
<<
/Length 7367
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-44-)Tj
-20.767 -3.6 TD
0.0747 Tw
(Dependiendo del tipo de sistema de )Tj
/TT7 1 Tf
14.9443 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0747 Tw
(cheros que utilices, es posible que incluso si copias el disco en este)Tj
-15.5004 -1.2 TD
0.0914 Tw
[(momento \(utilizando su dispositi)25(v)20(o)20( )-20.1(crudo o de modo carácter\) las estructuras de datos sean incoherentes.)]TJ
T*
-0.0001 Tc
0.1436 Tw
[(Por ejemplo, puede que un directorio contenga)-393.7(una entrada de directorio con un número de)]TJ
/TT4 1 Tf
38.7465 0 TD
0 Tc
0 Tw
(i-nodo)Tj
/TT6 1 Tf
3.0044 0 TD
(que)Tj
-41.751 -1.2 TD
[(toda)20(vía aparece como libre en el disco.)]TJ
0 -2.4 TD
0.0339 Tw
[(Una v)15(ez UNIX sincroniza su cache en disco, el sistema de )]TJ
/TT7 1 Tf
23.9048 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5561 0 TD
0.0339 Tw
(cheros en el disco será coherente, hasta que se)Tj
-24.4609 -1.2 TD
-0.0004 Tc
0.095 Tw
(hagan más modi)Tj
/TT7 1 Tf
6.7384 0 TD
0 Tc
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0946 Tw
(caciones. La llamada al sistema)Tj
/TT4 1 Tf
13.3563 0 TD
0 Tw
(sync\(2\))Tj
/TT6 1 Tf
2.9429 0 TD
-0.2499 Tw
[(,)-344.6(y)-344.6( el)-344.7(comando)]TJ
/TT4 1 Tf
6.5159 0 TD
0 Tw
(sync\(1\))Tj
/TT6 1 Tf
3.2876 0 TD
0.0947 Tw
(se utilizan precisamente)Tj
-33.3972 -1.2 TD
0 Tw
(para edir a UNIX que sincronice la cache en disco. Por ejemplo,)Tj
/TT11 1 Tf
8 0 0 8 133 606 Tm
(unix$ sync ; sync)Tj
0 -1.5 TD
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 576 Tm
0.0603 Tw
[(es una b)20(uena forma de ase)15(gurarse de que las escrituras se han realizado, si pensamos hacer algo peligroso)]TJ
0 -1.2 TD
0 Tw
[(que podría hacer que el sistema f)10(allase estrepitosamente.)]TJ
0 -2.4 TD
0.0479 Tw
[(Hemos ejecutado dos v)15(eces)]TJ
/TT11 1 Tf
11.4505 0 TD
0 Tw
(sync)Tj
/TT6 1 Tf
2.6983 0 TD
0.048 Tw
(puesto que lo normal es que UNIX continúe sincronizando el disco tras)Tj
-14.1488 -1.2 TD
0.1756 Tw
(la llamada a)Tj
/TT4 1 Tf
5.6074 0 TD
0 Tw
(sync\(2\))Tj
/TT6 1 Tf
2.9429 0 TD
0.1755 Tw
[(.)-425.6(L)0(a)-425.6(s)0(e)15(gunda v)15(ez que ejecutamos este comando ha de esperar a que acabe la sin-)]TJ
-8.5502 -1.2 TD
0 Tw
[(cronización anterior antes de empezar)55(.)]TJ
0 -2.4 TD
0.0305 Tw
(Disponemos de otra llamada,)Tj
/TT4 1 Tf
12.0356 0 TD
0 Tw
(fsync\(2\))Tj
/TT6 1 Tf
3.2207 0 TD
0.0305 Tw
[(,)-280.5(a)-280.5(l)0(a)-280.5(que podemos pasar un descriptor de )]TJ
/TT7 1 Tf
17.047 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0305 Tw
(chero para sincronizar las)Tj
-32.8594 -1.2 TD
0.0103 Tw
(escrituras de ese )Tj
/TT7 1 Tf
6.8331 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0103 Tw
(chero. Lo habitual es utilizarla tras escrituras en )Tj
/TT7 1 Tf
19.4911 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0103 Tw
(cheros importantes que queremos man-)Tj
-27.4365 -1.2 TD
0.0863 Tw
[(tener coherentes en el disco aunque f)10(alle la alimentación y el sistema muera de repente antes de que sin-)]TJ
T*
0 Tw
(cronice su cache.)Tj
0 -2.4 TD
0.0289 Tw
(Normalmente no es preciso utilizar)Tj
/TT11 1 Tf
14.4453 0 TD
0 Tw
(sync)Tj
/TT6 1 Tf
2.6793 0 TD
0.0288 Tw
[(dado que UNIX lo hace cada 30 se)15(gundos \(o cada poco tiempo\).)]TJ
-17.1246 -1.2 TD
0.0138 Tw
(Además, cuando se detiene la operación del sistema usando)Tj
/TT4 1 Tf
24.2272 0 TD
0 Tw
(shutdown\(8\))Tj
/TT6 1 Tf
5.2638 0 TD
(o)Tj
/TT4 1 Tf
0.7638 0 TD
(halt\(8\))Tj
/TT6 1 Tf
2.9855 0 TD
0.0138 Tw
(UNIX sincroniza los sis-)Tj
-33.2403 -1.2 TD
0 Tw
(temas de )Tj
/TT7 1 Tf
3.7764 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(cheros.)Tj
-4.3325 -2.4 TD
0.0547 Tw
(Además, es posible que utilicemos un sistema de )Tj
/TT7 1 Tf
20.2394 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0547 Tw
(cheros que presta atención al orden de las escrituras en)Tj
-20.7955 -1.2 TD
0.1007 Tw
(el disco de tal forma que el estado del sistema de )Tj
/TT7 1 Tf
20.9065 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1007 Tw
(cheros en el disco es siempre coherente, lo que hace)Tj
-21.4627 -1.2 TD
0 Tw
(menos necesario utilizar esta llamada.)Tj
0 -2.4 TD
0.1404 Tw
[(Si todo f)10(alla y el sistema de )]TJ
/TT7 1 Tf
12.276 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1403 Tw
[(cheros se corrompe en el disco tras un apagón o un f)10(allo del sistema, el)]TJ
-12.8322 -1.2 TD
0 Tw
(comando)Tj
/TT4 1 Tf
4.1105 0 TD
[(fsc)20(k\(8\))]TJ
/TT6 1 Tf
3.1457 0 TD
0.195 Tw
(ejecutará durante el siguiente arranque del sistema y tratará de dejar los sistemas de)Tj
/TT7 1 Tf
-7.2562 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
-0.0002 Tc
0.2246 Tw
[(cheros coherentes de nue)24.8(v)19.8(o... ¡Si es que puede! Si lle)14.8(ga ese caso... ¡prepárate para perder )]TJ
/TT7 1 Tf
39.1412 0 TD
0 Tc
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(cheros!)Tj
-40.2535 -1.2 TD
(Recuerda mantener tus backups al día.)Tj
/TT2 1 Tf
0 -3.6 TD
[(18. )-250(Ficher)18(os pr)18(oy)10(ectados en memoria.)]TJ
/TT6 1 Tf
0 -1.56 TD
(Utilizar)Tj
/TT11 1 Tf
3.363 0 TD
(read)Tj
/TT6 1 Tf
2.7092 0 TD
(y)Tj
/TT11 1 Tf
0.8088 0 TD
(write)Tj
/TT6 1 Tf
3.3093 0 TD
0.0588 Tw
(no es la única forma de utilizar un )Tj
/TT7 1 Tf
14.3542 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0588 Tw
(chero. La abstracción )Tj
/TT7 1 Tf
9.005 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0588 Tw
(chero en UNIX tiene)Tj
-34.6618 -1.2 TD
0 Tw
(una relación muy estrecha con la abstracción)Tj
/TT4 1 Tf
18.186 0 TD
[(se)40(gmento de memoria)]TJ
/TT6 1 Tf
8.7359 0 TD
(.)Tj
-26.9219 -2.4 TD
0.153 Tw
[(Y)100(a)100( )-100(sabemos que un proceso tiene di)25(v)15(ersos se)15(gmentos y sabemos que el se)15(gmento de te)15(xto procede del)]TJ
/TT7 1 Tf
0 -1.2 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1248 Tw
(chero ejecutable y se)Tj
/TT4 1 Tf
9.1056 0 TD
[(pa)10(gina en demanda)]TJ
/TT6 1 Tf
8.1273 0 TD
0.1249 Tw
[(.)-374.9(Recordemos que un se)15(gmento en UNIX es una abstracción.)]TJ
-17.7891 -1.2 TD
0.0544 Tw
[(Posee una dirección de memoria virtual de comienzo, un tamaño, unos permisos \(leer)40(,)-304.4(escribir)40(,)-304.4(ejecutar\) y)]TJ
T*
0.0416 Tw
(habitualmente se pagina desde un )Tj
/TT7 1 Tf
13.8979 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0416 Tw
[(chero. P)15(ara BSS y otros se)15(gmentos sin inicializar \(que UNIX inicializa)]TJ
-14.4541 -1.2 TD
0 Tw
[(a)-250(cero\) el )]TJ
/TT7 1 Tf
3.9692 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero en cuestión suele ser)Tj
/TT11 1 Tf
10.9678 0 TD
(/dev/zero)Tj
/TT6 1 Tf
5.4009 0 TD
(.)Tj
-20.894 -2.4 TD
0.0308 Tw
[(Inicialmente, el se)15(gmento será simplemente una estructura de datos y no se le asigna memoria física \(salv)20(o)]TJ
0 -1.2 TD
0.0683 Tw
[(que sea preciso utilizar parte de la memoria en realidad como en el caso de la pila\). Una v)15(ez el programa)]TJ
T*
0.2298 Tw
[(ejecuta y utiliza direcciones de memoria del se)15(gmento, el hardw)10(are pro)15(v)20(oca un f)10(allo de página \(una)]TJ
T*
0.0431 Tw
[(e)15(xcepción\) si no e)15(xiste memoria física asignada. El manejador)40(,)-293.1(e)0(l)-293.1(k)10(ernel, asigna la memoria física y la ini-)]TJ
T*
0 Tw
(cializa, poniendo la traducción adecuada de memoria virtual a física \(de)Tj
/TT4 1 Tf
28.9863 0 TD
(página)Tj
/TT6 1 Tf
3.0278 0 TD
(a)Tj
/TT4 1 Tf
0.6938 0 TD
[(mar)37(co)]TJ
/TT6 1 Tf
2.5182 0 TD
(\).)Tj
-35.2262 -2.4 TD
0.0042 Tw
[(Sabes que dado que no es posible tener una traducción en la tabla que utiliza el hardw)10(are \()]TJ
/TT4 1 Tf
36.1864 0 TD
(tabla de páginas)Tj
/TT6 1 Tf
6.6749 0 TD
0 Tw
(\))Tj
-42.8613 -4.44 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
146 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
148 0 obj
<<
/Length 6621
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-45-)Tj
-20.767 -3.6 TD
0.148 Tw
(para cada dirección, las traducciones de memoria virtual a memoria física siempre traducen bloques de)Tj
0 -1.2 TD
0.0564 Tw
(4KiB de direcciones virtuales a bloques de 4KiB de direcciones físicas. A la memoria utilizada con direc-)Tj
T*
0.0498 Tw
(ciones virtuales es a lo que llamamos página y a la memoria utilizada con direcciones físicas \(memoria de)Tj
T*
0.0139 Tw
[(v)15(erdad\) es a lo que llamamos marco de página. T)80(anto páginas como marcos deben comenzar en direcciones)]TJ
T*
0.011 Tw
(que sean un múltiplo del tamaño de página \(normalmente 4KiB, como hemos supuesto antes en este mismo)Tj
T*
0 Tw
(párrafo\). Pero todo esto ya lo conoces de arquitectura de computadores.)Tj
0 -2.4 TD
0.0041 Tw
(Pues bien, si consideras que los )Tj
/TT7 1 Tf
12.884 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5561 0 TD
0.0041 Tw
(cheros \(aunque procedan de disco\) utilizan una cache de bloques de disco,)Tj
-13.4401 -1.2 TD
0.0244 Tw
[(y)-274.3(piensas que UNIX puede hacer que la cache para los datos del )]TJ
/TT7 1 Tf
26.1677 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0244 Tw
(chero sea en realidad memoria física que)Tj
-26.7238 -1.2 TD
0 Tw
[(puede asignarse a memoria virtual... ¡Y)100(a)-250(l)0(o)-250(tienes!)]TJ
0 -2.4 TD
0.0434 Tw
[(Es posible pedir a UNIX que un se)15(gmento de memoria virtual corresponda a un )]TJ
/TT7 1 Tf
32.6947 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0434 Tw
[(chero e)15(xistente en disco.)]TJ
-33.2508 -1.2 TD
0.0817 Tw
[(A)-331.7(partir de dicho momento, leer direcciones del se)15(gmento implica leer los datos del )]TJ
/TT7 1 Tf
34.8124 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0817 Tw
(chero \(igual que se)Tj
-35.3685 -1.2 TD
0.0357 Tw
[(lee el código del programa conforme ejecuta\). Del mismo modo, escribir direcciones del se)15(gmento implica)]TJ
T*
0 Tw
(escribir en la cache del )Tj
/TT7 1 Tf
9.4111 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero en memoria. Más adelante UNIX sincronizará el contenido del disco.)Tj
-9.9673 -2.4 TD
(La llamada al sistema que consigue este efecto es)Tj
/TT4 1 Tf
20.0195 0 TD
(mmap\(2\))Tj
/TT6 1 Tf
3.6104 0 TD
[(.)-250(T)35(iene un número signi)]TJ
/TT7 1 Tf
9.4909 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.02 Tw
[(cati)25(v)20(o)20( de)-250(parámetros:)]TJ
/TT11 1 Tf
8 0 0 8 132 486 Tm
0 Tw
(void *)Tj
0 -1.5 TD
(mmap\(void *addr, size_t len, int prot, int flags, int fd, off_t offset\);)Tj
/TT6 1 Tf
10 0 0 10 72 444 Tm
0.0465 Tw
[(P)15(ara usarla bien, debes pensar en lo que hemos discutido antes. UNIX mantendrá páginas de memoria vir)20(-)]TJ
0 -1.2 TD
0.1071 Tw
(tual y hará que correspondan a trozos del mismo tamaño en el )Tj
/TT7 1 Tf
26.2769 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5561 0 TD
0.1071 Tw
(chero. La primera dirección virtual será)Tj
/TT11 1 Tf
-26.833 -1.2 TD
0 Tw
(addr)Tj
/TT6 1 Tf
2.4004 0 TD
0.055 Tw
[(,)-305(o)-305(bien UNIX elige una si)]TJ
/TT11 1 Tf
11.1604 0 TD
0 Tw
(addr)Tj
/TT6 1 Tf
2.7054 0 TD
(es)Tj
/TT11 1 Tf
1.138 0 TD
(0)Tj
/TT6 1 Tf
0.6001 0 TD
0.055 Tw
[(.)-305(E)0(n)-305(total se pro)10(yectan)]TJ
/TT11 1 Tf
9.4286 0 TD
0 Tw
(len)Tj
/TT6 1 Tf
2.1053 0 TD
0.055 Tw
(bytes desde el )Tj
/TT7 1 Tf
6.0244 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.055 Tw
(chero a memoria.)Tj
-36.1187 -1.2 TD
0.0353 Tw
(Como comprenderás, lo mejor será que)Tj
/TT11 1 Tf
16.1791 0 TD
0 Tw
(len)Tj
/TT6 1 Tf
2.0856 0 TD
0.0353 Tw
(sea un múltiplo del tamaño de página. El )Tj
/TT7 1 Tf
16.8615 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5561 0 TD
0.0353 Tw
(chero está identi)Tj
/TT7 1 Tf
6.6233 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5561 0 TD
(-)Tj
-42.8618 -1.2 TD
0.0296 Tw
(cado por el descriptor)Tj
/TT11 1 Tf
9.0593 0 TD
0 Tw
(fd)Tj
/TT6 1 Tf
1.4798 0 TD
0.0296 Tw
[(y)-279.6(los bytes pro)10(yectados comienzan en)]TJ
/TT11 1 Tf
15.5519 0 TD
0 Tw
(offset)Tj
/TT6 1 Tf
3.8802 0 TD
0.0297 Tw
(dentro del )Tj
/TT7 1 Tf
4.3358 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0297 Tw
[(chero.)-529.7(Los parámet-)]TJ
-34.8631 -1.2 TD
0 Tw
(ros)Tj
/TT11 1 Tf
1.7569 0 TD
(prot)Tj
/TT6 1 Tf
2.9351 0 TD
(y)Tj
/TT11 1 Tf
1.0347 0 TD
(flags)Tj
/TT6 1 Tf
3.5352 0 TD
0.2847 Tw
[(sirv)15(en para indicar los permisos para la memoria pro)10(yectada e indicar a unix)]TJ
-9.2618 -1.2 TD
0 Tw
[(propiedades que queremos para el nue)25(v)20(o)20( )-20(se)15(gmento de memoria.)]TJ
0 -2.4 TD
[(Por ejemplo, algunos v)25(alores interesantes para)]TJ
/TT11 1 Tf
18.7748 0 TD
(flags)Tj
/TT6 1 Tf
3.2505 0 TD
(son)Tj
-19.5253 -1.56 TD
(•)Tj
/TT11 1 Tf
2.5001 0 TD
(MAP_PRIVATE)Tj
/TT6 1 Tf
6.6011 0 TD
0.1709 Tw
[(:)-420.8(Las escrituras hechas por el proceso no se v)15(erán ni en el )]TJ
/TT7 1 Tf
25.3921 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.1709 Tw
(chero y en la)Tj
-32.5495 -1.2 TD
-0.0001 Tc
0.0672 Tw
[(pro)9.9(yecciones a memoria que otros procesos hagan. Básicamente las páginas que se modi)]TJ
/TT7 1 Tf
36.2517 0 TD
0 Tc
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5561 0 TD
(can)Tj
-36.8079 -1.2 TD
0.0655 Tw
(se copian en cuanto el proceso intenta modi)Tj
/TT7 1 Tf
17.9248 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0655 Tw
(carlas. A esto se le llama)Tj
/TT2 1 Tf
10.5834 0 TD
(copy on write)Tj
/TT6 1 Tf
6.2234 0 TD
0.3155 Tc
0 Tw
[(ye)315.5(se)315.5(n)]TJ
-35.2877 -1.2 TD
0 Tc
0.0482 Tw
(realidad la técnica que utiliza UNIX para hacer creer que en un)Tj
/TT11 1 Tf
26.0642 0 TD
0 Tw
(fork)Tj
/TT6 1 Tf
2.6985 0 TD
0.0481 Tw
(el hijo es una copia del)Tj
-28.7627 -1.2 TD
0 Tw
(padre. Sólo se copia lo que cambia alguno de los procesos.)Tj
-2.5 -2.76 TD
(•)Tj
/TT11 1 Tf
2.5001 0 TD
(MAP_SHARED)Tj
/TT6 1 Tf
6.001 0 TD
0.0798 Tw
[(:)-329.8(Las escrituras terminan en el )]TJ
/TT7 1 Tf
12.7517 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0798 Tw
(chero y son compartidas con todos los demás.)Tj
-19.309 -1.2 TD
0 Tw
(Esto suele ser lo habitual.)Tj
-2.5 -2.76 TD
(•)Tj
/TT11 1 Tf
2.5001 0 TD
(MAP_ANON)Tj
/TT6 1 Tf
4.8008 0 TD
0.062 Tw
[(:)-312(E)0(n)-312(realidad queremos un nue)25(v)20(o)20( )-20(se)15(gmento de memoria)]TJ
/TT4 1 Tf
23.019 0 TD
0 Tw
(anónima)Tj
/TT6 1 Tf
3.812 0 TD
0.062 Tw
(\(que no procede)Tj
-31.6319 -1.2 TD
0 Tw
(de ningún )Tj
/TT7 1 Tf
4.2217 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero\).)Tj
-9.7778 -2.4 TD
[(Este programa pro)10(yecta un )]TJ
/TT7 1 Tf
10.9856 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(chero en memoria y lo modi)Tj
/TT7 1 Tf
11.3022 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(ca.)Tj
/TT11 1 Tf
8 0 0 8 133 163.2 Tm
(#include <stdlib.h>)Tj
0 -1.5 TD
(#include <fcntl.h>)Tj
T*
(#include <unistd.h>)Tj
T*
(#include <sys/mman.h>)Tj
T*
(#include <err.h>)Tj
T*
(#include <string.h>)Tj
0 -3 TD
(enum {KiB = 1024};)Tj
/TT6 1 Tf
10 0 0 10 72 24 Tm
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
149 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
151 0 obj
<<
/Length 2200
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-46-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(int)Tj
0 -1.5 TD
(main\(int argc, char* argv[]\))Tj
T*
({)Tj
2.4 -1.5 TD
(int fd;)Tj
T*
(void *addr;)Tj
T*
(char *p;)Tj
0 -3 TD
(fd = open\("/tmp/afile", O_RDWR|O_CREAT, 0644\);)Tj
0 -1.5 TD
(if \(fd < 0\) {)Tj
2.4 -1.5 TD
(err\(1, "open: /tmp/afile"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(if \(ftruncate\(fd, 12*KiB\) < 0\) {)Tj
2.4 -1.5 TD
(close\(fd\);)Tj
T*
(err\(1, "truncate: /tmp/afile"\);)Tj
-2.4 -1.5 TD
(})Tj
0 -6 TD
(addr = mmap\(0, 8*KiB, PROT_READ|PROT_WRITE, MAP_SHARED, fd, 0\);)Tj
0 -1.5 TD
(close\(fd\);)Tj
T*
(if \(addr == MAP_FAILED\) {)Tj
2.4 -1.5 TD
(err\(1, "mmap: /tmp/afile"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
[(p)-600(=)-600(addr;)]TJ
T*
(strcpy\(&p[2*KiB], "hi at 2k\\n"\);)Tj
T*
(strcpy\(&p[6*KiB], "hi at 6k\\n"\);)Tj
T*
(if \(munmap\(addr, 8*KiB\) < 0\) {)Tj
2.4 -1.5 TD
(err\(1, "munmap: /tmp/afile"\);)Tj
-2.4 -1.5 TD
(})Tj
T*
(exit\(0\);)Tj
-2.4 -1.5 TD
(})Tj
/TT6 1 Tf
10 0 0 10 72 330 Tm
0.0511 Tw
[(Observ)25(a)-301(como dejamos que UNIX determine la dirección de memoria en que ponemos el nue)25(v)20(o)20( )-20(se)15(gmento)]TJ
0 -1.2 TD
0.1597 Tw
[(\(es siempre lo mejor\). Además, los tamaños están ele)15(gidos para que sean múltiplos de 4KiB \(que pre-)]TJ
T*
0.0192 Tw
[(suponemos como tamaño de página, lo que ho)10(y)-269.2(día suele ser cierto en todos los sistemas\). Además, cuando)]TJ
T*
0 Tw
(terminamos, llamamos a)Tj
/TT4 1 Tf
10.0532 0 TD
(munmap\(2\))Tj
/TT6 1 Tf
4.8604 0 TD
[(para pedir a UNIX que termine la pro)10(yección.)]TJ
-14.9136 -2.4 TD
[(Si ejecutamos nuestro nue)25(v)20(o)20( )-20(programa podemos v)15(er qué tiene)]TJ
/TT11 1 Tf
25.0162 0 TD
(/tmp/afile)Tj
/TT6 1 Tf
6.001 0 TD
(:)Tj
/TT11 1 Tf
8 0 0 8 133 252 Tm
(unix$ map)Tj
0 -1.5 TD
(unix$ ls -l /tmp/afile)Tj
T*
(unix$ ls -l /tmp/afile)Tj
T*
0.6 Tw
[(-rw-r--r-- 1)-600(nemo wheel 12288)-600(Aug )600(27 )600(22:07 )600(/tmp/afile)]TJ
T*
0 Tw
(unix$ echo ’12*1024’ | hoc)Tj
T*
(12288)Tj
T*
(unix$ cat /tmp/afile)Tj
T*
(hi at 2k)Tj
T*
(hi at 6k)Tj
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 126 Tm
[(Y)129(,)129( )-129(para ser mas precisos...)]TJ
0 -10.2 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
152 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT4 5 0 R
/TT6 6 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
154 0 obj
<<
/Length 7294
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-47-)Tj
/TT11 1 Tf
8 0 0 8 133 708 Tm
(unix$ od -A d -c /tmp/afile)Tj
0 -1.5 TD
0.6 Tw
[(0000000 )-600(\\0)-1200(\\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0)]TJ
T*
0 Tw
(*)Tj
T*
1.8 Tw
[(0002048 h)-1800(i)-4200(a)-1800(t)-4200(2)-1800(k)-1200(\\n)-1200(\\0)-1200(\\0)-1200(\\0)-1200(\\0)-1200(\\0)-1200(\\0)-1200(\\0)]TJ
T*
0.6 Tw
[(0002064 )-600(\\0)-1200(\\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0)]TJ
T*
0 Tw
(*)Tj
T*
1.8 Tw
[(0006144 h)-1800(i)-4200(a)-1800(t)-4200(6)-1800(k)-1200(\\n)-1200(\\0)-1200(\\0)-1200(\\0)-1200(\\0)-1200(\\0)-1200(\\0)-1200(\\0)]TJ
T*
0.6 Tw
[(0006160 )-600(\\0)-1200(\\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0 \\0)]TJ
T*
0 Tw
(*)Tj
T*
(0012288)Tj
/TT6 1 Tf
10 0 0 10 72 582 Tm
0.0927 Tw
(Hemos pedido a)Tj
/TT11 1 Tf
7.0266 0 TD
0 Tw
(od)Tj
/TT6 1 Tf
1.5429 0 TD
0.0927 Tw
(con ")Tj
/TT11 1 Tf
2.1948 0 TD
(-A d)Tj
/TT6 1 Tf
2.4931 0 TD
[(")-342.6(que imprima las direcciones en base 10. Como puedes v)15(e)0(r)40(,)-342.6(en)-342.6(el)-342.6(of)25(fset)]TJ
-13.2574 -1.2 TD
0.0039 Tw
[(2048 tenemos el string que escribió nuestro programa en su memoria. Igual sucede en el of)25(fset 6144 \(6KiB\))]TJ
T*
0 Tw
(con el string escrito allí. El resto de bytes está a cero dado que nunca los hemos escrito.)Tj
0 -2.4 TD
0.1208 Tw
[(Si en el futuro pro)10(yectamos el )]TJ
/TT7 1 Tf
12.9896 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
-0.0001 Tc
0.1209 Tw
[(chero de nue)24.9(v)19.9(o)-0.1(,)-370.9(digamos en la dirección)]TJ
/TT11 1 Tf
17.1784 0 TD
0 Tc
0 Tw
(p)Tj
/TT6 1 Tf
0.6001 0 TD
0.1208 Tw
[(,)-370.8(tendremos en)]TJ
/TT11 1 Tf
6.4718 0 TD
0 Tw
(&p[2*KiB])Tj
/TT6 1 Tf
-37.7961 -1.2 TD
0.0416 Tw
(nuestro primer string tal cual esté en el )Tj
/TT7 1 Tf
16.1053 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0416 Tw
(chero. Ni que decir tiene que aunque hemos escrito y leído bytes,)Tj
-16.6614 -1.2 TD
0 Tw
(es memoria como todo lo demás y podríamos haber utilizado cualquier otro tipo de datos.)Tj
0 -2.4 TD
0.0452 Tw
[(Con todo esto ya sabes cómo crear nue)25(v)20(o)0(s)-295.2(s)0(e)15(gmentos en tu proceso. Hace tiempo se utilizaba una llamada)]TJ
/TT4 1 Tf
0 -1.2 TD
0 Tw
(sbrk\(2\))Tj
/TT6 1 Tf
3.1836 0 TD
0.0454 Tw
[(para aumentar el tamaño del se)15(gmento de datos, antes de disponer de las f)10(acilidades que nos da en)]TJ
-3.1836 -1.2 TD
0.009 Tw
(la actualidad la memoria virtual. La implementación de)Tj
/TT4 1 Tf
22.4796 0 TD
0 Tw
(malloc\(3\))Tj
/TT6 1 Tf
4.1466 0 TD
(utilizaba)Tj
/TT4 1 Tf
3.7018 0 TD
(sbrk\(2\))Tj
/TT6 1 Tf
3.1471 0 TD
0.0089 Tw
(para pedir más memoria)Tj
-33.4751 -1.2 TD
0.0422 Tw
[(virtual en el se)15(gmento de datos cuando agotaba la que tenía.)-542.3(Ho)10(y)-292.3(e)0(n)-292.3(día, si necesitas una cantidad ingente)]TJ
T*
0.0189 Tw
[(de memoria virtual es mejor que pidas tu propio se)15(gmento y lo uses como te plazca. De hecho, algunos sis-)]TJ
T*
0.1648 Tw
[(temas UNIX crean un se)15(gmento independiente llamado)]TJ
/TT4 1 Tf
23.5479 0 TD
0 Tw
(heap)Tj
/TT6 1 Tf
2.3587 0 TD
0.1649 Tw
(para dar servicio a)Tj
/TT4 1 Tf
8.2665 0 TD
0 Tw
(malloc\(3\))Tj
/TT6 1 Tf
3.8877 0 TD
0.1649 Tw
[(.)-414.9(Otros usan)]TJ
/TT4 1 Tf
-38.0609 -1.2 TD
0 Tw
(sbrk\(2\))Tj
/TT6 1 Tf
3.2321 0 TD
0.0938 Tw
[(o)-343.9(bien crean un se)15(gmento con su)]TJ
/TT7 1 Tf
13.5997 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0938 Tw
(ciente tamaño de memoria virtual. En cualquier caso, es mejor)Tj
-17.3879 -1.2 TD
0 Tw
(dejar la implementación de)Tj
/TT11 1 Tf
11.1064 0 TD
(malloc)Tj
/TT6 1 Tf
3.8506 0 TD
(en paz y pedir lo que necesites sin molestar a la librería de C.)Tj
/TT2 1 Tf
-14.957 -3.6 TD
0.25 Tw
[(19. Montajes)-250(y)-250(nombr)18(es)]TJ
/TT6 1 Tf
0 -1.56 TD
0.0533 Tw
(En UNIX tienes todos los )Tj
/TT7 1 Tf
10.7934 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0533 Tw
(cheros dispuestos en un único árbol como ya sabes. El directorio raíz es ")Tj
/TT11 1 Tf
30.0371 0 TD
0 Tw
(/)Tj
/TT6 1 Tf
0.6001 0 TD
0.3033 Tc
("y)Tj
-41.9867 -1.2 TD
0 Tc
0.0873 Tw
(en dicho directorio están contenidos todos los )Tj
/TT7 1 Tf
19.135 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0873 Tw
[(cheros a que puedes acceder)55(.)-337.3(Esto es así incluso si tienes)]TJ
-19.6912 -1.2 TD
0 Tw
[(v)25(arias particiones con )]TJ
/TT7 1 Tf
8.9438 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
[(cheros o v)25(arios discos.)]TJ
-9.4999 -2.4 TD
0.0288 Tw
[(Una v)15(ez más, estamos ante otra abstracción suministrada por el sistema, la idea de un)]TJ
/TT2 1 Tf
34.8224 0 TD
[(espacio de nombr)18(es)]TJ
/TT6 1 Tf
-34.8224 -1.2 TD
0.1018 Tw
(único que podemos adaptar para crear la ilusión de un sólo árbol, aunque tengamos múltiples árboles de)Tj
/TT7 1 Tf
T*
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.009 Tw
(cheros. Normalmente cada árbol está guardado en una partición utilizando un formato concreto de sistema)Tj
-0.5562 -1.2 TD
0 Tw
(de )Tj
/TT7 1 Tf
1.1985 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0047 Tw
[(cheros, pero recuerda que e)15(xisten árboles de )]TJ
/TT7 1 Tf
17.9539 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0046 Tw
[(cheros implementados en softw)10(are que no tienen almace-)]TJ
-20.2648 -1.2 TD
0 Tw
(namiento en disco \(como)Tj
/TT11 1 Tf
10.3306 0 TD
(/proc)Tj
/TT6 1 Tf
3.0005 0 TD
(\).)Tj
-13.3311 -2.4 TD
0.0661 Tw
(La implementación es simple: UNIX dispone de una)Tj
/TT4 1 Tf
21.8014 0 TD
0.0662 Tw
(tabla de montajes)Tj
/TT6 1 Tf
7.559 0 TD
(que hace que, al recorrer paths, el)Tj
-29.3603 -1.2 TD
0 Tw
[(k)10(ernel pueda saltar de un directorio en el árbol al directorio raíz de de otro árbol.)]TJ
T*
0.0681 Tw
[(El efecto puedes v)15(erlo en la )]TJ
/TT7 1 Tf
11.7217 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0681 Tw
[(gura 4. En ella puedes v)15(er que el administrador de este sistema ha utilizado)]TJ
-12.2779 -1.2 TD
0.0416 Tw
(dos discos \(o dos particiones, a UNIX le da lo mismo\) y ha hecho que en el directorio)Tj
/TT11 1 Tf
35.2677 0 TD
0 Tw
(/home)Tj
/TT6 1 Tf
3.292 0 TD
0.0415 Tw
(se monte el)Tj
-38.5597 -1.2 TD
0.2743 Tw
[(se)15(gundo disco \(o la se)15(gunda partición\). T)35(ras el montaje, cuando el k)10(ernel resuelv)25(a)-524.4(paths y alcance)]TJ
T*
0 Tw
(")Tj
/TT11 1 Tf
0.4082 0 TD
(/home)Tj
/TT6 1 Tf
3.0005 0 TD
0.2116 Tw
[(", saltará al directorio raíz del se)15(gundo disco, por lo que aparentemente tenemos paths como)]TJ
-3.4087 -1.2 TD
0 Tw
(")Tj
/TT11 1 Tf
0.4082 0 TD
(/home/nemo)Tj
/TT6 1 Tf
6.001 0 TD
(", lo que es una ilusión.)Tj
-6.4092 -2.4 TD
0.0774 Tw
[(A)-327.4(l)0(a)-327.4(vista de esto puedes imaginar que si)]TJ
/TT11 1 Tf
17.2758 0 TD
0 Tw
(/home)Tj
/TT6 1 Tf
3.328 0 TD
(contenía )Tj
/TT7 1 Tf
3.7147 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0775 Tw
(cheros o directorios antes del montaje, dicho)Tj
-24.8746 -1.2 TD
0.1266 Tw
(contenido resulta ahora inaccesible. Aparentemente)Tj
/TT11 1 Tf
21.5124 0 TD
0 Tw
(/home)Tj
/TT6 1 Tf
3.3771 0 TD
0.1266 Tw
(contiene los directorios)Tj
/TT11 1 Tf
9.9604 0 TD
0 Tw
(root)Tj
/TT6 1 Tf
2.4004 0 TD
(,)Tj
/TT11 1 Tf
0.6266 0 TD
(nemo)Tj
/TT6 1 Tf
2.4004 0 TD
0.1265 Tw
[(,)-376.5(etc. y)]TJ
-40.2772 -1.2 TD
0 Tw
[(eso es todo lo que pueden v)15(er los usuarios del sistema.)]TJ
0 -2.4 TD
(El comando)Tj
/TT11 1 Tf
5.0542 0 TD
(mount\(1\))Tj
/TT6 1 Tf
5.0508 0 TD
(muestra los montajes en el sistema:)Tj
-10.105 -6.24 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
155 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
157 0 obj
<<
/Length 8274
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-48-)Tj
-10.5675 -6.22 TD
(disco #1)Tj
/TT2 1 Tf
1.5415 -3.6 TD
(/)Tj
/TT11 1 Tf
-10.841 -7.2 TD
[(tmp)-3239.7(etc)-3239.7(usr)-3239.7(bin)-2939.7(home)]TJ
ET
0 G
1 J 1 j 0.4 w 10 M []0 d
1 i 
176.19 637.59 m
104.67 586.47 l
190.83 630.03 m
190.83 594.03 l
180.51 633.27 m
150.75 590.79 l
205.47 637.59 m
276.87 586.47 l
201.15 633.27 m
230.79 590.79 l
S
BT
/TT2 1 Tf
10 0 0 10 405.41 573.8 Tm
(/)Tj
/TT11 1 Tf
-6.821 -5.4 TD
[(root)-2639.6(nemo)-2939.6(elf)-3239.7(...)]TJ
ET
393.75 563.67 m
362.43 534.27 l
404.43 558.15 m
402.03 539.91 l
417.99 561.99 m
438.75 536.07 l
422.43 567.03 m
484.83 531.03 l
309.528 574.2 m
309.588 574.798 309.618 575.399 309.618 576 c
309.618 576.601 309.588 577.202 309.528 577.8 c
308.808 581.184 m
308.463 582.331 308.005 583.44 307.44 584.496 c
305.568 587.376 m
304.794 588.326 303.926 589.194 302.976 589.968 c
300.096 591.84 m
299.041 592.405 297.931 592.863 296.784 593.208 c
293.4 593.928 m
292.802 593.988 292.201 594.018 291.6 594.018 c
290.999 594.018 290.398 593.988 289.8 593.928 c
286.416 593.208 m
285.269 592.863 284.159 592.405 283.104 591.84 c
280.224 589.968 m
279.274 589.194 278.406 588.326 277.632 587.376 c
275.76 584.496 m
275.195 583.44 274.737 582.331 274.392 581.184 c
273.672 577.8 m
273.612 577.202 273.582 576.601 273.582 576 c
273.582 575.399 273.612 574.798 273.672 574.2 c
274.392 570.816 m
274.737 569.669 275.195 568.559 275.76 567.504 c
277.632 564.624 m
278.406 563.674 279.274 562.806 280.224 562.032 c
283.104 560.16 m
284.159 559.595 285.269 559.137 286.416 558.792 c
289.8 558.072 m
290.398 558.012 290.999 557.982 291.6 557.982 c
292.201 557.982 292.802 558.012 293.4 558.072 c
296.784 558.792 m
297.931 559.137 299.041 559.595 300.096 560.16 c
302.976 562.032 m
303.926 562.806 304.794 563.674 305.568 564.624 c
307.44 567.504 m
308.005 568.559 308.463 569.669 308.808 570.816 c
424.728 574.2 m
424.788 574.798 424.818 575.399 424.818 576 c
424.818 576.601 424.788 577.202 424.728 577.8 c
424.008 581.184 m
423.663 582.331 423.205 583.44 422.64 584.496 c
420.768 587.376 m
419.994 588.326 419.126 589.194 418.176 589.968 c
415.296 591.84 m
414.241 592.405 413.131 592.863 411.984 593.208 c
408.6 593.928 m
408.002 593.988 407.401 594.018 406.8 594.018 c
406.199 594.018 405.598 593.988 405 593.928 c
401.616 593.208 m
400.469 592.863 399.359 592.405 398.304 591.84 c
395.424 589.968 m
394.474 589.194 393.606 588.326 392.832 587.376 c
390.96 584.496 m
390.395 583.44 389.937 582.331 389.592 581.184 c
388.872 577.8 m
388.812 577.202 388.782 576.601 388.782 576 c
388.782 575.399 388.812 574.798 388.872 574.2 c
389.592 570.816 m
389.937 569.669 390.395 568.559 390.96 567.504 c
392.832 564.624 m
393.606 563.674 394.474 562.806 395.424 562.032 c
398.304 560.16 m
399.359 559.595 400.469 559.137 401.616 558.792 c
405 558.072 m
405.598 558.012 406.199 557.982 406.8 557.982 c
407.401 557.982 408.002 558.012 408.6 558.072 c
411.984 558.792 m
413.131 559.137 414.24 559.595 415.296 560.16 c
418.176 562.032 m
419.126 562.806 419.994 563.674 420.768 564.624 c
422.64 567.504 m
423.205 568.559 423.663 569.669 424.008 570.816 c
S
388.8 576 m
381.6 574.2 l
381.6 577.8 l
f
0.1 w 
388.8 576 m
381.6 574.2 l
381.6 577.8 l
s
0.4 w 
309.63 576.03 m
313.23 576.03 l
317.19 576.03 m
320.79 576.03 l
324.75 576.03 m
328.35 576.03 l
332.43 576.03 m
336.03 576.03 l
339.99 576.03 m
343.59 576.03 l
347.67 576.03 m
351.27 576.03 l
355.23 576.03 m
358.83 576.03 l
362.79 576.03 m
366.39 576.03 l
370.35 576.03 m
373.95 576.03 l
378.03 576.03 m
381.63 576.03 l
309.63 576.39 m
313.23 576.39 l
317.19 576.39 m
320.79 576.39 l
324.75 576.39 m
328.35 576.39 l
332.31 576.39 m
335.91 576.39 l
339.87 576.39 m
343.47 576.39 l
347.43 576.39 m
351.03 576.39 l
354.99 576.39 m
358.59 576.39 l
362.55 576.39 m
366.15 576.39 l
370.11 576.39 m
373.71 576.39 l
377.67 576.39 m
381.27 576.39 l
385.23 576.39 m
388.83 576.39 l
S
BT
/TT6 1 Tf
10 0 0 10 333.09 580.16 Tm
(montaje)Tj
5.6905 2.964 TD
(disco #2)Tj
/TT2 1 Tf
-29.2995 -12.88 TD
0.0105 Tw
(Figura 4:)Tj
/TT4 1 Tf
4.2427 0 TD
[(Un montaje hace que UNIX salte de un dir)37(ectorio en el árbol al r)15(aíz de otr)45(o)-260.4(árbol cr)37(eando)]TJ
-4.2427 -1.2 TD
0 Tw
(el efecto de un único árbol.)Tj
/TT11 1 Tf
8 0 0 8 133 457 Tm
(unix$ mount)Tj
0 -1.5 TD
(/dev/disk1 on / \(hfs, local, journaled, noatime\))Tj
T*
(devfs on /dev \(devfs, local, nobrowse\))Tj
T*
(elf@fs.lsub.org:/home/dump on /dump \(osxfusefs, nodev, nosuid\))Tj
T*
(elf@fs.lsub.org:/home/lsub on /zx \(osxfusefs, nodev, nosuid\))Tj
T*
(elf@fs.lsub.org:/home/once on /once \(osxfusefs, nodev, nosuid\))Tj
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 355 Tm
0.0252 Tw
(El resultando dependerá mucho no sólo del tipo de UNIX sino también de cómo esté administrado. En este)Tj
0 -1.2 TD
0.0761 Tw
[(caso v)15(emos que hay una sóla partición en el primer disco que está montada en el directorio raíz. Por otra)]TJ
T*
0.0861 Tw
(parte, no hay)Tj
/TT11 1 Tf
5.7007 0 TD
0 Tw
(/proc)Tj
/TT6 1 Tf
3.3366 0 TD
0.0861 Tw
(en este sistema \(OS X\) y)Tj
/TT11 1 Tf
10.6812 0 TD
0 Tw
(/dev)Tj
/TT6 1 Tf
2.7365 0 TD
0.0861 Tw
(es un sistema de )Tj
/TT7 1 Tf
7.1208 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0861 Tw
(cheros sintético \(igual que lo es)Tj
/TT11 1 Tf
-30.1318 -1.2 TD
0 Tw
(/proc)Tj
/TT6 1 Tf
3.2837 0 TD
0.0332 Tw
[(en otros UNIX\). Puede v)15(erse también que los directorios)]TJ
/TT11 1 Tf
23.2223 0 TD
0 Tw
(/dump)Tj
/TT6 1 Tf
3.0005 0 TD
(,)Tj
/TT11 1 Tf
0.5332 0 TD
(/zx)Tj
/TT6 1 Tf
2.0835 0 TD
(y)Tj
/TT11 1 Tf
0.7832 0 TD
(/once)Tj
/TT6 1 Tf
3.2837 0 TD
0.0331 Tw
(están montados y)Tj
-36.19 -1.2 TD
0 Tw
(proceden de otra máquina llamada)Tj
/TT11 1 Tf
14.0215 0 TD
(fs.lsub.org)Tj
/TT6 1 Tf
6.6011 0 TD
(.)Tj
-20.6226 -2.4 TD
0.0743 Tw
[(Existe otro comando que resulta útil no sólo para v)15(er qué tenemos montado sino también para v)15(er cuánto)]TJ
0 -1.2 TD
0.0411 Tw
(espacio libre resta en cada uno de los sistemas de )Tj
/TT7 1 Tf
20.3485 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0411 Tw
(cheros. hablamos de)Tj
/TT4 1 Tf
8.5094 0 TD
0 Tw
(df\(1\))Tj
/TT6 1 Tf
1.9438 0 TD
0.041 Tw
[(.)-291(P)15(ara que puedamos v)15(er otro)]TJ
-31.3579 -1.2 TD
0 Tw
[(ejemplo, v)25(amos a utilizar un sistema OpenBSD esta v)15(ez:)]TJ
/TT11 1 Tf
8 0 0 8 133 241 Tm
(unix$ mount)Tj
0 -1.5 TD
(/dev/sd2a on / type ffs \(local, noatime, softdep\))Tj
T*
(unix$ df -h)Tj
T*
2.4 Tw
[(Filesystem Size)-2400(Used )1200(Avail)-600(Capacity )1800(Mounted)-600(on)]TJ
T*
1.8 Tw
[(/dev/sd2a )-1200(1.8T)-2400(239G 1.5T 14% /)]TJ
T*
0 Tw
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 163 Tm
0.0317 Tw
(En este sistema hay un único sistema de )Tj
/TT7 1 Tf
16.5275 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0317 Tw
(cheros montado en el raíz, procedente de la primera partición \(la)Tj
-17.0837 -1.2 TD
0 Tw
(")Tj
/TT11 1 Tf
0.4082 0 TD
(a)Tj
/TT6 1 Tf
0.6001 0 TD
0.3112 Tc
[("e)311.2(n")]TJ
/TT11 1 Tf
2.3827 0 TD
0 Tc
(sd2a)Tj
/TT6 1 Tf
2.4004 0 TD
0.0612 Tw
("\) del tercer disco \(el ")Tj
/TT11 1 Tf
9.368 0 TD
0 Tw
(2)Tj
/TT6 1 Tf
0.6001 0 TD
0.3112 Tc
[("e)311.2(n")]TJ
/TT11 1 Tf
2.3827 0 TD
0 Tc
(sd2a)Tj
/TT6 1 Tf
2.4004 0 TD
0.0611 Tw
(", empezando a contar en cero\). Con el )Tj
/TT7 1 Tf
16.2788 0 TD
0 Tw
(ß)Tj
/TT6 1 Tf
0.5562 0 TD
(ag)Tj
/TT11 1 Tf
1.2549 0 TD
(-h)Tj
/TT6 1 Tf
1.5113 0 TD
(\()Tj
/TT4 1 Tf
0.333 0 TD
(human)Tj
-40.4767 -1.2 TD
[(r)37(eadable sizes)]TJ
/TT6 1 Tf
5.6568 0 TD
(\))Tj
/TT11 1 Tf
0.583 0 TD
(df)Tj
/TT6 1 Tf
1.4502 0 TD
[(informa que en dicha partición de 1.8T)35(iB estamos usando 239GiB.)]TJ
-7.6901 -2.4 TD
(El )Tj
/TT7 1 Tf
1.1387 0 TD
(ß)Tj
/TT6 1 Tf
0.5562 0 TD
(ag)Tj
/TT11 1 Tf
1.1938 0 TD
(-i)Tj
/TT6 1 Tf
1.4502 0 TD
(de)Tj
/TT11 1 Tf
1.1938 0 TD
(df)Tj
/TT6 1 Tf
1.4502 0 TD
(es muy útil e informa de cuántos)Tj
/TT4 1 Tf
13.3022 0 TD
(i-nodos)Tj
/TT6 1 Tf
3.25 0 TD
(estamos usando en cada sistema de )Tj
/TT7 1 Tf
14.2734 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(cheros.)Tj
/TT11 1 Tf
8 0 0 8 133 97 Tm
(unix$ df -ih)Tj
0 -1.5 TD
0.6 Tw
[(Filesystem )-1800(Size)-2400(Used )-600(Avail)-600(Capacity )600(iused)-1800(ifree %iused Mounted)-600(on)]TJ
T*
1.8 Tw
[(/dev/sd2a )-1200(1.8T)-2400(239G 1.5T 14%)-600(1727771 )1800(58895843)-3000(3% )600(/)]TJ
/TT6 1 Tf
10 0 0 10 72 24 Tm
0 Tw
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
158 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT2 4 0 R
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
160 0 obj
<<
/Length 3010
>>
stream
BT
/TT6 1 Tf
10 0 0 10 279.67 744 Tm
0 g
/GS1 gs
0 Tc
0 Tw
(-49-)Tj
-20.767 -3.6 TD
0.0313 Tw
[(Como podrás suponer)40(,)-281.4(una v)15(ez hemos usado todos los)]TJ
/TT4 1 Tf
22.1136 0 TD
0 Tw
(i-nodos)Tj
/TT6 1 Tf
3.2814 0 TD
0.0314 Tw
(de que dispone un sistema de )Tj
/TT7 1 Tf
12.1303 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0314 Tw
(cheros ya no)Tj
-38.0815 -1.2 TD
0 Tw
[(es posible crear nue)25(v)20(o)0(s)]TJ
/TT7 1 Tf
9.5072 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
(cheros dentro del mismo.)Tj
-10.0634 -2.4 TD
0.0246 Tw
[(P)15(ara montar sistemas de )]TJ
/TT7 1 Tf
10.0253 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0246 Tw
(cheros hay que ser)Tj
/TT4 1 Tf
7.762 0 TD
0 Tw
[(r)45(oot)]TJ
/TT6 1 Tf
1.8966 0 TD
0.0245 Tw
(\(a no ser que dicho usuario se ocupe de con)Tj
/TT7 1 Tf
17.6311 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0245 Tw
(gurar el sis-)Tj
-38.4273 -1.2 TD
0.0495 Tw
(tema para que un usuario normal pueda realizar ciertos montajes, como por ejemplo sucede con los discos)Tj
T*
0 Tw
[(USB ho)10(y)-250(día\). Un ejemplo es)]TJ
/TT11 1 Tf
8 0 0 8 133 630 Tm
(unix$ mount -t mfs -o rw /dev/sd0b /tmp)Tj
/TT6 1 Tf
10 0 0 10 72 612 Tm
0.066 Tw
(que monta \(en un sistema OpenBSD\) en)Tj
/TT11 1 Tf
16.8199 0 TD
0 Tw
(/tmp)Tj
/TT6 1 Tf
2.7164 0 TD
0.066 Tw
(un sistema de )Tj
/TT7 1 Tf
5.8914 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.066 Tw
(cheros en memoria virtual, respaldado por)Tj
-25.9838 -1.2 TD
0.0185 Tw
[(una partición de sw)10(ap en disco. \(Dicha partición se utiliza para mantener en ella la parte de la memoria vir)20(-)]TJ
T*
0 Tw
(tual que no nos cabe en memoria física\).)Tj
0 -2.4 TD
[(P)15(ara deshacer el efecto de)]TJ
/TT4 1 Tf
10.6173 0 TD
(mount\(8\))Tj
/TT6 1 Tf
3.916 0 TD
(disponemos de)Tj
/TT4 1 Tf
6.2217 0 TD
(umount\(8\))Tj
/TT6 1 Tf
4.166 0 TD
[(.)-250(Por ejemplo,)]TJ
/TT11 1 Tf
8 0 0 8 133 546 Tm
(unix$ umount /tmp)Tj
/TT6 1 Tf
10 0 0 10 72 528 Tm
-0.0001 Tc
0.0593 Tw
[(deshace el montaje del ejemplo anterior)54.9(.)-309.3(E)-0.1(l)-309.3(sistema se ne)14.9(gará a desmontar un sistema de )]TJ
/TT7 1 Tf
36.4111 0 TD
0 Tc
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0592 Tw
(cheros que esté)Tj
-36.9673 -1.2 TD
0.1274 Tw
(utilizándose. Por ejemplo, si un proceso tiene su directorio actual dentro de dicho sistema de )Tj
/TT7 1 Tf
39.1507 0 TD
0 Tw
(Þ)Tj
/TT6 1 Tf
0.5561 0 TD
0.1274 Tw
(cheros o)Tj
-39.7069 -1.2 TD
0 Tw
(tiene )Tj
/TT7 1 Tf
2.2301 0 TD
(Þ)Tj
/TT6 1 Tf
0.5562 0 TD
0.0367 Tw
(cheros abiertos procedentes del mismo, o está paginando su código desde un ejecutable almacenado)Tj
-2.7862 -1.2 TD
0 Tw
(en él. Si lo intentamos...)Tj
/TT11 1 Tf
8 0 0 8 133 474 Tm
(unix$ umount /)Tj
0 -1.5 TD
(/dev/sd2a: device busy)Tj
T*
(unix$)Tj
/TT6 1 Tf
10 0 0 10 72 420 Tm
0.0918 Tw
[(T)70(enemos llamadas al sistema en)]TJ
/TT4 1 Tf
13.5238 0 TD
0 Tw
(mount\(2\))Tj
/TT6 1 Tf
4.0078 0 TD
0.0918 Tw
(que utilizan los comandos que hemos visto, pero es muy poco)Tj
-17.5316 -1.2 TD
0 Tw
(probable que las necesites.)Tj
0 -38.4 TD
(\(c\) 2016 Francisco J. Ballesteros)Tj
ET
endstream
endobj
161 0 obj
<<
/ProcSet [/PDF /Text ]
/Font <<
/TT4 5 0 R
/TT6 6 0 R
/TT7 7 0 R
/TT11 10 0 R
>>
/ExtGState <<
/GS1 11 0 R
>>
>>
endobj
11 0 obj
<<
/Type /ExtGState
/SA false
/SM 0.02
/OP false
/op false
/OPM 1
/BG2 /Default
/UCR2 /Default
/HT /Default
/TR2 /Default
>>
endobj
162 0 obj
<<
/Type /FontDescriptor
/Ascent 750
/CapHeight 676
/Descent -250
/Flags 262178
/FontBBox [-168 -218 1000 935]
/FontName /Times-Bold
/ItalicAngle 0
/StemV 133
/XHeight 461
/StemH 139
>>
endobj
163 0 obj
<<
/Type /FontDescriptor
/Ascent 750
/CapHeight 653
/Descent -250
/Flags 98
/FontBBox [-169 -217 1010 883]
/FontName /Times-Italic
/ItalicAngle -15
/StemV 76
/XHeight 441
/StemH 76
>>
endobj
164 0 obj
<<
/Type /FontDescriptor
/Ascent 750
/CapHeight 662
/Descent -250
/Flags 34
/FontBBox [-168 -218 1000 898]
/FontName /Times-Roman
/ItalicAngle 0
/StemV 84
/XHeight 450
/StemH 84
>>
endobj
165 0 obj
<<
/Type /FontDescriptor
/Ascent 750
/CapHeight 662
/Descent -250
/Flags 34
/FontBBox [-168 -218 1000 898]
/FontName /Times-Roman
/ItalicAngle 0
/StemV 84
/XHeight 450
/StemH 84
>>
endobj
166 0 obj
<<
/Type /FontDescriptor
/Ascent 750
/CapHeight 653
/Descent -250
/Flags 98
/FontBBox [-169 -217 1010 883]
/FontName /Times-Italic
/ItalicAngle -15
/StemV 76
/XHeight 441
/StemH 76
>>
endobj
167 0 obj
<<
/Type /FontDescriptor
/Ascent 750
/CapHeight 676
/Descent -250
/Flags 262178
/FontBBox [-168 -218 1000 935]
/FontName /Times-Bold
/ItalicAngle 0
/StemV 133
/XHeight 461
/StemH 139
>>
endobj
168 0 obj
<<
/Type /FontDescriptor
/Ascent 753
/CapHeight 562
/Descent -246
/Flags 35
/FontBBox [-28 -250 628 805]
/FontName /Courier
/ItalicAngle 0
/StemV 51
/XHeight 426
/StemH 51
>>
endobj
4 0 obj
<<
/Type /Font
/Subtype /TrueType
/FirstChar 32
/LastChar 243
/Widths [250 333 0 0 0 0 0 0 0 0 0 0 250 0 250 278 
500 500 500 500 500 500 500 500 500 500 333 0 0 0 0 0 
0 722 667 722 722 667 611 778 0 389 0 0 667 944 0 778 
611 0 0 556 0 0 0 0 0 0 0 0 0 0 0 0 
0 500 556 444 556 444 333 500 556 278 333 556 278 833 556 500 
556 0 444 389 333 556 500 722 0 500 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 333 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 500 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 500 ]
/Encoding /WinAnsiEncoding
/BaseFont /Times-Bold
/FontDescriptor 162 0 R
>>
endobj
5 0 obj
<<
/Type /Font
/Subtype /TrueType
/FirstChar 32
/LastChar 250
/Widths [250 0 0 0 0 0 0 0 333 333 0 0 250 333 250 0 
0 500 500 500 0 0 0 0 500 0 0 0 0 0 0 0 
0 0 611 0 722 611 611 0 0 333 444 0 556 0 667 0 
0 0 0 500 0 722 0 0 611 0 0 0 0 0 0 0 
0 500 500 444 500 444 278 500 500 278 278 444 278 722 500 500 
500 500 389 389 278 500 444 667 444 444 389 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 500 0 0 0 0 0 0 0 0 0 0 0 278 0 0 
0 0 0 500 0 0 0 0 0 0 500 ]
/Encoding /WinAnsiEncoding
/BaseFont /Times-Italic
/FontDescriptor 163 0 R
>>
endobj
6 0 obj
<<
/Type /Font
/Subtype /TrueType
/FirstChar 32
/LastChar 250
/Widths [250 333 408 500 0 0 0 0 333 333 0 0 250 333 250 278 
500 500 500 500 500 500 500 500 500 500 278 0 0 0 0 444 
0 722 667 667 722 611 556 722 722 333 389 722 611 889 722 722 
556 722 667 556 611 722 722 944 722 722 0 0 278 0 0 0 
0 444 500 444 500 444 333 500 500 278 278 500 278 778 500 500 
500 500 333 389 278 500 500 722 500 500 444 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 350 0 0 0 0 0 0 0 0 0 0 
0 333 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 444 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 444 0 0 0 0 0 0 0 444 0 0 0 278 0 0 
0 500 0 500 0 0 0 0 0 0 500 ]
/Encoding /WinAnsiEncoding
/BaseFont /Times-Roman
/FontDescriptor 164 0 R
>>
endobj
7 0 obj
<<
/Type /Font
/Subtype /TrueType
/FirstChar 222
/LastChar 223
/Widths [556 556 ]
/Encoding /MacRomanEncoding
/BaseFont /Times-Roman
/FontDescriptor 165 0 R
>>
endobj
8 0 obj
<<
/Type /Font
/Subtype /TrueType
/FirstChar 222
/LastChar 222
/Widths [500 ]
/Encoding /MacRomanEncoding
/BaseFont /Times-Italic
/FontDescriptor 166 0 R
>>
endobj
9 0 obj
<<
/Type /Font
/Subtype /TrueType
/FirstChar 222
/LastChar 222
/Widths [556 ]
/Encoding /MacRomanEncoding
/BaseFont /Times-Bold
/FontDescriptor 167 0 R
>>
endobj
10 0 obj
<<
/Type /Font
/Subtype /TrueType
/FirstChar 32
/LastChar 181
/Widths [600 600 600 600 600 600 600 0 600 600 600 600 600 600 600 600 
600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 
600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 
600 0 600 600 600 600 600 600 0 600 600 600 600 600 0 600 
0 600 600 600 600 600 600 600 600 600 600 600 600 600 600 600 
600 600 600 600 600 600 600 600 600 600 600 600 600 600 0 0 
0 0 0 0 0 0 0 0 600 0 0 0 0 0 0 0 
0 0 600 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 576 ]
/Encoding /WinAnsiEncoding
/BaseFont /Courier
/FontDescriptor 168 0 R
>>
endobj
1 0 obj
<<
/Type /Page
/Parent 12 0 R
/Resources 3 0 R
/Contents 2 0 R
>>
endobj
13 0 obj
<<
/Type /Page
/Parent 12 0 R
/Resources 15 0 R
/Contents 14 0 R
>>
endobj
16 0 obj
<<
/Type /Page
/Parent 12 0 R
/Resources 18 0 R
/Contents 17 0 R
>>
endobj
19 0 obj
<<
/Type /Page
/Parent 12 0 R
/Resources 21 0 R
/Contents 20 0 R
>>
endobj
22 0 obj
<<
/Type /Page
/Parent 12 0 R
/Resources 24 0 R
/Contents 23 0 R
>>
endobj
25 0 obj
<<
/Type /Page
/Parent 12 0 R
/Resources 27 0 R
/Contents 26 0 R
>>
endobj
28 0 obj
<<
/Type /Page
/Parent 12 0 R
/Resources 30 0 R
/Contents 29 0 R
>>
endobj
31 0 obj
<<
/Type /Page
/Parent 12 0 R
/Resources 33 0 R
/Contents 32 0 R
>>
endobj
34 0 obj
<<
/Type /Page
/Parent 12 0 R
/Resources 36 0 R
/Contents 35 0 R
>>
endobj
37 0 obj
<<
/Type /Page
/Parent 12 0 R
/Resources 39 0 R
/Contents 38 0 R
>>
endobj
40 0 obj
<<
/Type /Page
/Parent 44 0 R
/Resources 42 0 R
/Contents 41 0 R
>>
endobj
45 0 obj
<<
/Type /Page
/Parent 44 0 R
/Resources 47 0 R
/Contents 46 0 R
>>
endobj
48 0 obj
<<
/Type /Page
/Parent 44 0 R
/Resources 50 0 R
/Contents 49 0 R
>>
endobj
51 0 obj
<<
/Type /Page
/Parent 44 0 R
/Resources 53 0 R
/Contents 52 0 R
>>
endobj
54 0 obj
<<
/Type /Page
/Parent 44 0 R
/Resources 56 0 R
/Contents 55 0 R
>>
endobj
57 0 obj
<<
/Type /Page
/Parent 44 0 R
/Resources 59 0 R
/Contents 58 0 R
>>
endobj
60 0 obj
<<
/Type /Page
/Parent 44 0 R
/Resources 62 0 R
/Contents 61 0 R
>>
endobj
63 0 obj
<<
/Type /Page
/Parent 44 0 R
/Resources 65 0 R
/Contents 64 0 R
>>
endobj
66 0 obj
<<
/Type /Page
/Parent 44 0 R
/Resources 68 0 R
/Contents 67 0 R
>>
endobj
69 0 obj
<<
/Type /Page
/Parent 44 0 R
/Resources 71 0 R
/Contents 70 0 R
>>
endobj
72 0 obj
<<
/Type /Page
/Parent 75 0 R
/Resources 74 0 R
/Contents 73 0 R
>>
endobj
76 0 obj
<<
/Type /Page
/Parent 75 0 R
/Resources 78 0 R
/Contents 77 0 R
>>
endobj
79 0 obj
<<
/Type /Page
/Parent 75 0 R
/Resources 81 0 R
/Contents 80 0 R
>>
endobj
82 0 obj
<<
/Type /Page
/Parent 75 0 R
/Resources 84 0 R
/Contents 83 0 R
>>
endobj
85 0 obj
<<
/Type /Page
/Parent 75 0 R
/Resources 87 0 R
/Contents 86 0 R
>>
endobj
88 0 obj
<<
/Type /Page
/Parent 75 0 R
/Resources 90 0 R
/Contents 89 0 R
>>
endobj
91 0 obj
<<
/Type /Page
/Parent 75 0 R
/Resources 93 0 R
/Contents 92 0 R
>>
endobj
94 0 obj
<<
/Type /Page
/Parent 75 0 R
/Resources 96 0 R
/Contents 95 0 R
>>
endobj
97 0 obj
<<
/Type /Page
/Parent 75 0 R
/Resources 99 0 R
/Contents 98 0 R
>>
endobj
100 0 obj
<<
/Type /Page
/Parent 75 0 R
/Resources 102 0 R
/Contents 101 0 R
>>
endobj
103 0 obj
<<
/Type /Page
/Parent 106 0 R
/Resources 105 0 R
/Contents 104 0 R
>>
endobj
107 0 obj
<<
/Type /Page
/Parent 106 0 R
/Resources 109 0 R
/Contents 108 0 R
>>
endobj
110 0 obj
<<
/Type /Page
/Parent 106 0 R
/Resources 112 0 R
/Contents 111 0 R
>>
endobj
113 0 obj
<<
/Type /Page
/Parent 106 0 R
/Resources 115 0 R
/Contents 114 0 R
>>
endobj
116 0 obj
<<
/Type /Page
/Parent 106 0 R
/Resources 118 0 R
/Contents 117 0 R
>>
endobj
119 0 obj
<<
/Type /Page
/Parent 106 0 R
/Resources 121 0 R
/Contents 120 0 R
>>
endobj
122 0 obj
<<
/Type /Page
/Parent 106 0 R
/Resources 124 0 R
/Contents 123 0 R
>>
endobj
125 0 obj
<<
/Type /Page
/Parent 106 0 R
/Resources 127 0 R
/Contents 126 0 R
>>
endobj
128 0 obj
<<
/Type /Page
/Parent 106 0 R
/Resources 130 0 R
/Contents 129 0 R
>>
endobj
131 0 obj
<<
/Type /Page
/Parent 106 0 R
/Resources 133 0 R
/Contents 132 0 R
>>
endobj
134 0 obj
<<
/Type /Page
/Parent 137 0 R
/Resources 136 0 R
/Contents 135 0 R
>>
endobj
138 0 obj
<<
/Type /Page
/Parent 137 0 R
/Resources 140 0 R
/Contents 139 0 R
>>
endobj
141 0 obj
<<
/Type /Page
/Parent 137 0 R
/Resources 143 0 R
/Contents 142 0 R
>>
endobj
144 0 obj
<<
/Type /Page
/Parent 137 0 R
/Resources 146 0 R
/Contents 145 0 R
>>
endobj
147 0 obj
<<
/Type /Page
/Parent 137 0 R
/Resources 149 0 R
/Contents 148 0 R
>>
endobj
150 0 obj
<<
/Type /Page
/Parent 137 0 R
/Resources 152 0 R
/Contents 151 0 R
>>
endobj
153 0 obj
<<
/Type /Page
/Parent 137 0 R
/Resources 155 0 R
/Contents 154 0 R
>>
endobj
156 0 obj
<<
/Type /Page
/Parent 137 0 R
/Resources 158 0 R
/Contents 157 0 R
>>
endobj
159 0 obj
<<
/Type /Page
/Parent 137 0 R
/Resources 161 0 R
/Contents 160 0 R
>>
endobj
169 0 obj
<<
/S /D
>>
endobj
170 0 obj
<<
/Nums [0 169 0 R ]
>>
endobj
12 0 obj
<<
/Type /Pages
/Kids [1 0 R 13 0 R 16 0 R 19 0 R 22 0 R 25 0 R 28 0 R 31 0 R 34 0 R 37 0 R]
/Count 10
/Parent 43 0 R
>>
endobj
44 0 obj
<<
/Type /Pages
/Kids [40 0 R 45 0 R 48 0 R 51 0 R 54 0 R 57 0 R 60 0 R 63 0 R 66 0 R 69 0 R]
/Count 10
/Parent 43 0 R
>>
endobj
75 0 obj
<<
/Type /Pages
/Kids [72 0 R 76 0 R 79 0 R 82 0 R 85 0 R 88 0 R 91 0 R 94 0 R 97 0 R 100 0 R]
/Count 10
/Parent 43 0 R
>>
endobj
106 0 obj
<<
/Type /Pages
/Kids [103 0 R 107 0 R 110 0 R 113 0 R 116 0 R 119 0 R 122 0 R 125 0 R 128 0 R 131 0 R]
/Count 10
/Parent 43 0 R
>>
endobj
137 0 obj
<<
/Type /Pages
/Kids [134 0 R 138 0 R 141 0 R 144 0 R 147 0 R 150 0 R 153 0 R 156 0 R 159 0 R]
/Count 9
/Parent 43 0 R
>>
endobj
43 0 obj
<<
/Type /Pages
/Kids [12 0 R 44 0 R 75 0 R 106 0 R 137 0 R ]
/Count 49
/MediaBox [0 0 612 792]
>>
endobj
171 0 obj
<<
/CreationDate (D:20161107101220+01'00')
/ModDate (D:20161107101220+01'00')
/Producer (Apple pstopdf)
>>
endobj
172 0 obj
<<
/Type /Catalog
/Pages 43 0 R
/PageLabels 170 0 R
>>
endobj
xref
0 173
0000000000 65535 f 
0000246561 00000 n 
0000000016 00000 n 
0000004768 00000 n 
0000243177 00000 n 
0000243888 00000 n 
0000244607 00000 n 
0000245389 00000 n 
0000245564 00000 n 
0000245736 00000 n 
0000245906 00000 n 
0000241640 00000 n 
0000250824 00000 n 
0000246642 00000 n 
0000004932 00000 n 
0000011764 00000 n 
0000246726 00000 n 
0000011929 00000 n 
0000016646 00000 n 
0000246810 00000 n 
0000016800 00000 n 
0000020825 00000 n 
0000246894 00000 n 
0000020957 00000 n 
0000025055 00000 n 
0000246978 00000 n 
0000025187 00000 n 
0000028424 00000 n 
0000247062 00000 n 
0000028556 00000 n 
0000031835 00000 n 
0000247146 00000 n 
0000031978 00000 n 
0000038158 00000 n 
0000247230 00000 n 
0000038301 00000 n 
0000043396 00000 n 
0000247314 00000 n 
0000043539 00000 n 
0000046240 00000 n 
0000247398 00000 n 
0000046372 00000 n 
0000055149 00000 n 
0000251527 00000 n 
0000250961 00000 n 
0000247482 00000 n 
0000055292 00000 n 
0000061010 00000 n 
0000247566 00000 n 
0000061153 00000 n 
0000067127 00000 n 
0000247650 00000 n 
0000067259 00000 n 
0000073875 00000 n 
0000247734 00000 n 
0000074029 00000 n 
0000080590 00000 n 
0000247818 00000 n 
0000080744 00000 n 
0000084126 00000 n 
0000247902 00000 n 
0000084258 00000 n 
0000091653 00000 n 
0000247986 00000 n 
0000091807 00000 n 
0000094853 00000 n 
0000248070 00000 n 
0000094985 00000 n 
0000099086 00000 n 
0000248154 00000 n 
0000099218 00000 n 
0000101788 00000 n 
0000248238 00000 n 
0000101931 00000 n 
0000105963 00000 n 
0000251099 00000 n 
0000248322 00000 n 
0000106095 00000 n 
0000110590 00000 n 
0000248406 00000 n 
0000110733 00000 n 
0000115488 00000 n 
0000248490 00000 n 
0000115620 00000 n 
0000119690 00000 n 
0000248574 00000 n 
0000119822 00000 n 
0000124384 00000 n 
0000248658 00000 n 
0000124527 00000 n 
0000129411 00000 n 
0000248742 00000 n 
0000129543 00000 n 
0000134113 00000 n 
0000248826 00000 n 
0000134245 00000 n 
0000138468 00000 n 
0000248910 00000 n 
0000138611 00000 n 
0000145966 00000 n 
0000248994 00000 n 
0000146098 00000 n 
0000148011 00000 n 
0000249081 00000 n 
0000148122 00000 n 
0000152763 00000 n 
0000251238 00000 n 
0000249169 00000 n 
0000152907 00000 n 
0000154908 00000 n 
0000249257 00000 n 
0000155030 00000 n 
0000157759 00000 n 
0000249345 00000 n 
0000157881 00000 n 
0000163234 00000 n 
0000249433 00000 n 
0000163378 00000 n 
0000165531 00000 n 
0000249521 00000 n 
0000165664 00000 n 
0000170407 00000 n 
0000249609 00000 n 
0000170551 00000 n 
0000176987 00000 n 
0000249697 00000 n 
0000177131 00000 n 
0000181217 00000 n 
0000249785 00000 n 
0000181361 00000 n 
0000188566 00000 n 
0000249873 00000 n 
0000188710 00000 n 
0000191590 00000 n 
0000249961 00000 n 
0000191734 00000 n 
0000195451 00000 n 
0000251387 00000 n 
0000250049 00000 n 
0000195584 00000 n 
0000198844 00000 n 
0000250137 00000 n 
0000198977 00000 n 
0000205575 00000 n 
0000250225 00000 n 
0000205719 00000 n 
0000213140 00000 n 
0000250313 00000 n 
0000213284 00000 n 
0000219959 00000 n 
0000250401 00000 n 
0000220103 00000 n 
0000222357 00000 n 
0000250489 00000 n 
0000222479 00000 n 
0000229827 00000 n 
0000250577 00000 n 
0000229971 00000 n 
0000238299 00000 n 
0000250665 00000 n 
0000238443 00000 n 
0000241507 00000 n 
0000241781 00000 n 
0000241984 00000 n 
0000242185 00000 n 
0000242383 00000 n 
0000242581 00000 n 
0000242782 00000 n 
0000242985 00000 n 
0000250753 00000 n 
0000250782 00000 n 
0000251642 00000 n 
0000251766 00000 n 
trailer
<<
/Size 173
/Root 172 0 R
/Info 171 0 R
/ID [<b1e4a70ac3b8ae79cc829fe54432c354><b1e4a70ac3b8ae79cc829fe54432c354>]
>>
startxref
251838
%%EOF
